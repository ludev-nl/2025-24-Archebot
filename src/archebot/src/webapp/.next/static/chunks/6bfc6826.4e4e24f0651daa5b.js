(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{5918:(t,e,i)=>{var r,n;(()=>{var a=Object.create,s=Object.defineProperty,o=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,h=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty,u=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),c=(t,e,i,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of l(e))p.call(t,n)||n===i||s(t,n,{get:()=>e[n],enumerable:!(r=o(e,n))||r.enumerable});return t},d=(t,e,i)=>(i=null!=t?a(h(t)):{},c(!e&&t&&t.__esModule?i:s(i,"default",{value:t,enumerable:!0}),t)),g=u((t,e)=>{e.exports=function(){this.__data__=[],this.size=0}}),f=u((t,e)=>{e.exports=function(t,e){return t===e||t!=t&&e!=e}}),_=u((t,e)=>{var i=f();e.exports=function(t,e){for(var r=t.length;r--;)if(i(t[r][0],e))return r;return -1}}),m=u((t,e)=>{var i=_(),r=Array.prototype.splice;e.exports=function(t){var e=this.__data__,n=i(e,t);return!(n<0)&&(n==e.length-1?e.pop():r.call(e,n,1),--this.size,!0)}}),y=u((t,e)=>{var i=_();e.exports=function(t){var e=this.__data__,r=i(e,t);return r<0?void 0:e[r][1]}}),b=u((t,e)=>{var i=_();e.exports=function(t){return i(this.__data__,t)>-1}}),k=u((t,e)=>{var i=_();e.exports=function(t,e){var r=this.__data__,n=i(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}}),M=u((t,e)=>{var i=g(),r=m(),n=y(),a=b(),s=k();function o(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}o.prototype.clear=i,o.prototype.delete=r,o.prototype.get=n,o.prototype.has=a,o.prototype.set=s,e.exports=o}),v=u((t,e)=>{var i=M();e.exports=function(){this.__data__=new i,this.size=0}}),x=u((t,e)=>{e.exports=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}}),C=u((t,e)=>{e.exports=function(t){return this.__data__.get(t)}}),w=u((t,e)=>{e.exports=function(t){return this.__data__.has(t)}}),P=u((t,e)=>{e.exports="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g}),E=u((t,e)=>{var i=P(),r="object"==typeof self&&self&&self.Object===Object&&self;e.exports=i||r||Function("return this")()}),S=u((t,e)=>{e.exports=E().Symbol}),B=u((t,e)=>{var i=S(),r=Object.prototype,n=r.hasOwnProperty,a=r.toString,s=i?i.toStringTag:void 0;e.exports=function(t){var e=n.call(t,s),i=t[s];try{t[s]=void 0;var r=!0}catch{}var o=a.call(t);return r&&(e?t[s]=i:delete t[s]),o}}),R=u((t,e)=>{var i=Object.prototype.toString;e.exports=function(t){return i.call(t)}}),T=u((t,e)=>{var i=S(),r=B(),n=R(),a=i?i.toStringTag:void 0;e.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?r(t):n(t)}}),D=u((t,e)=>{e.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}}),O=u((t,e)=>{var i=T(),r=D();e.exports=function(t){if(!r(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}}),I=u((t,e)=>{e.exports=E()["__core-js_shared__"]}),A=u((t,e)=>{var i=I(),r=function(){var t=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();e.exports=function(t){return!!r&&r in t}}),G=u((t,e)=>{var i=Function.prototype.toString;e.exports=function(t){if(null!=t){try{return i.call(t)}catch{}try{return t+""}catch{}}return""}}),j=u((t,e)=>{var i=O(),r=A(),n=D(),a=G(),s=/^\[object .+?Constructor\]$/,o=Object.prototype,l=Function.prototype.toString,h=o.hasOwnProperty,p=RegExp("^"+l.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(t){return!(!n(t)||r(t))&&(i(t)?p:s).test(a(t))}}),N=u((t,e)=>{e.exports=function(t,e){return t?.[e]}}),z=u((t,e)=>{var i=j(),r=N();e.exports=function(t,e){var n=r(t,e);return i(n)?n:void 0}}),F=u((t,e)=>{e.exports=z()(E(),"Map")}),U=u((t,e)=>{e.exports=z()(Object,"create")}),V=u((t,e)=>{var i=U();e.exports=function(){this.__data__=i?i(null):{},this.size=0}}),K=u((t,e)=>{e.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=+!!e,e}}),q=u((t,e)=>{var i=U(),r=Object.prototype.hasOwnProperty;e.exports=function(t){var e=this.__data__;if(i){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return r.call(e,t)?e[t]:void 0}}),H=u((t,e)=>{var i=U(),r=Object.prototype.hasOwnProperty;e.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:r.call(e,t)}}),Y=u((t,e)=>{var i=U();e.exports=function(t,e){var r=this.__data__;return this.size+=+!this.has(t),r[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}}),X=u((t,e)=>{var i=V(),r=K(),n=q(),a=H(),s=Y();function o(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}o.prototype.clear=i,o.prototype.delete=r,o.prototype.get=n,o.prototype.has=a,o.prototype.set=s,e.exports=o}),$=u((t,e)=>{var i=X(),r=M(),n=F();e.exports=function(){this.size=0,this.__data__={hash:new i,map:new(n||r),string:new i}}}),J=u((t,e)=>{e.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}}),Z=u((t,e)=>{var i=J();e.exports=function(t,e){var r=t.__data__;return i(e)?r["string"==typeof e?"string":"hash"]:r.map}}),W=u((t,e)=>{var i=Z();e.exports=function(t){var e=i(this,t).delete(t);return this.size-=+!!e,e}}),Q=u((t,e)=>{var i=Z();e.exports=function(t){return i(this,t).get(t)}}),tt=u((t,e)=>{var i=Z();e.exports=function(t){return i(this,t).has(t)}}),te=u((t,e)=>{var i=Z();e.exports=function(t,e){var r=i(this,t),n=r.size;return r.set(t,e),this.size+=+(r.size!=n),this}}),ti=u((t,e)=>{var i=$(),r=W(),n=Q(),a=tt(),s=te();function o(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}o.prototype.clear=i,o.prototype.delete=r,o.prototype.get=n,o.prototype.has=a,o.prototype.set=s,e.exports=o}),tr=u((t,e)=>{var i=M(),r=F(),n=ti();e.exports=function(t,e){var a=this.__data__;if(a instanceof i){var s=a.__data__;if(!r||s.length<199)return s.push([t,e]),this.size=++a.size,this;a=this.__data__=new n(s)}return a.set(t,e),this.size=a.size,this}}),tn=u((t,e)=>{var i=M(),r=v(),n=x(),a=C(),s=w(),o=tr();function l(t){var e=this.__data__=new i(t);this.size=e.size}l.prototype.clear=r,l.prototype.delete=n,l.prototype.get=a,l.prototype.has=s,l.prototype.set=o,e.exports=l}),ta=u((t,e)=>{var i=z();e.exports=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch{}}()}),ts=u((t,e)=>{var i=ta();e.exports=function(t,e,r){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}}),to=u((t,e)=>{var i=ts(),r=f();e.exports=function(t,e,n){(void 0===n||r(t[e],n))&&(void 0!==n||e in t)||i(t,e,n)}}),tl=u((t,e)=>{e.exports=function(t){return function(e,i,r){for(var n=-1,a=Object(e),s=r(e),o=s.length;o--;){var l=s[t?o:++n];if(!1===i(a[l],l,a))break}return e}}}),th=u((t,e)=>{e.exports=tl()()}),tp=u((t,e)=>{var i=E(),r="object"==typeof t&&t&&!t.nodeType&&t,n=r&&"object"==typeof e&&e&&!e.nodeType&&e,a=n&&n.exports===r?i.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(t,e){if(e)return t.slice();var i=t.length,r=s?s(i):new t.constructor(i);return t.copy(r),r}}),tu=u((t,e)=>{e.exports=E().Uint8Array}),tc=u((t,e)=>{var i=tu();e.exports=function(t){var e=new t.constructor(t.byteLength);return new i(e).set(new i(t)),e}}),td=u((t,e)=>{var i=tc();e.exports=function(t,e){var r=e?i(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}}),tg=u((t,e)=>{e.exports=function(t,e){var i=-1,r=t.length;for(e||(e=Array(r));++i<r;)e[i]=t[i];return e}}),tf=u((t,e)=>{var i=D(),r=Object.create;e.exports=function(){function t(){}return function(e){if(!i(e))return{};if(r)return r(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}()}),t_=u((t,e)=>{e.exports=function(t,e){return function(i){return t(e(i))}}}),tm=u((t,e)=>{e.exports=t_()(Object.getPrototypeOf,Object)}),ty=u((t,e)=>{var i=Object.prototype;e.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||i)}}),tL=u((t,e)=>{var i=tf(),r=tm(),n=ty();e.exports=function(t){return"function"!=typeof t.constructor||n(t)?{}:i(r(t))}}),tb=u((t,e)=>{e.exports=function(t){return null!=t&&"object"==typeof t}}),tk=u((t,e)=>{var i=T(),r=tb();e.exports=function(t){return r(t)&&"[object Arguments]"==i(t)}}),tM=u((t,e)=>{var i=tk(),r=tb(),n=Object.prototype,a=n.hasOwnProperty,s=n.propertyIsEnumerable;e.exports=i(function(){return arguments}())?i:function(t){return r(t)&&a.call(t,"callee")&&!s.call(t,"callee")}}),tv=u((t,e)=>{e.exports=Array.isArray}),tx=u((t,e)=>{e.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=0x1fffffffffffff}}),tC=u((t,e)=>{var i=O(),r=tx();e.exports=function(t){return null!=t&&r(t.length)&&!i(t)}}),tw=u((t,e)=>{var i=tC(),r=tb();e.exports=function(t){return r(t)&&i(t)}}),tP=u((t,e)=>{e.exports=function(){return!1}}),tE=u((t,e)=>{var i=E(),r=tP(),n="object"==typeof t&&t&&!t.nodeType&&t,a=n&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===n?i.Buffer:void 0;e.exports=(s?s.isBuffer:void 0)||r}),tS=u((t,e)=>{var i=T(),r=tm(),n=tb(),a=Object.prototype,s=Function.prototype.toString,o=a.hasOwnProperty,l=s.call(Object);e.exports=function(t){if(!n(t)||"[object Object]"!=i(t))return!1;var e=r(t);if(null===e)return!0;var a=o.call(e,"constructor")&&e.constructor;return"function"==typeof a&&a instanceof a&&s.call(a)==l}}),tB=u((t,e)=>{var i=T(),r=tx(),n=tb(),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(t){return n(t)&&r(t.length)&&!!a[i(t)]}}),tR=u((t,e)=>{e.exports=function(t){return function(e){return t(e)}}}),tT=u((t,e)=>{var i=P(),r="object"==typeof t&&t&&!t.nodeType&&t,n=r&&"object"==typeof e&&e&&!e.nodeType&&e,a=n&&n.exports===r&&i.process;e.exports=function(){try{return n&&n.require&&n.require("util").types||a&&a.binding&&a.binding("util")}catch{}}()}),tD=u((t,e)=>{var i=tB(),r=tR(),n=tT(),a=n&&n.isTypedArray;e.exports=a?r(a):i}),tO=u((t,e)=>{e.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}}),tI=u((t,e)=>{var i=ts(),r=f(),n=Object.prototype.hasOwnProperty;e.exports=function(t,e,a){var s=t[e];n.call(t,e)&&r(s,a)&&(void 0!==a||e in t)||i(t,e,a)}}),tA=u((t,e)=>{var i=tI(),r=ts();e.exports=function(t,e,n,a){var s=!n;n||(n={});for(var o=-1,l=e.length;++o<l;){var h=e[o],p=a?a(n[h],t[h],h,n,t):void 0;void 0===p&&(p=t[h]),s?r(n,h,p):i(n,h,p)}return n}}),tG=u((t,e)=>{e.exports=function(t,e){for(var i=-1,r=Array(t);++i<t;)r[i]=e(i);return r}}),tj=u((t,e)=>{var i=/^(?:0|[1-9]\d*)$/;e.exports=function(t,e){var r=typeof t;return!!(e=e??0x1fffffffffffff)&&("number"==r||"symbol"!=r&&i.test(t))&&t>-1&&t%1==0&&t<e}}),tN=u((t,e)=>{var i=tG(),r=tM(),n=tv(),a=tE(),s=tj(),o=tD(),l=Object.prototype.hasOwnProperty;e.exports=function(t,e){var h=n(t),p=!h&&r(t),u=!h&&!p&&a(t),c=!h&&!p&&!u&&o(t),d=h||p||u||c,g=d?i(t.length,String):[],f=g.length;for(var _ in t)(e||l.call(t,_))&&!(d&&("length"==_||u&&("offset"==_||"parent"==_)||c&&("buffer"==_||"byteLength"==_||"byteOffset"==_)||s(_,f)))&&g.push(_);return g}}),tz=u((t,e)=>{e.exports=function(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}}),tF=u((t,e)=>{var i=D(),r=ty(),n=tz(),a=Object.prototype.hasOwnProperty;e.exports=function(t){if(!i(t))return n(t);var e=r(t),s=[];for(var o in t)"constructor"==o&&(e||!a.call(t,o))||s.push(o);return s}}),tU=u((t,e)=>{var i=tN(),r=tF(),n=tC();e.exports=function(t){return n(t)?i(t,!0):r(t)}}),tV=u((t,e)=>{var i=tA(),r=tU();e.exports=function(t){return i(t,r(t))}}),tK=u((t,e)=>{var i=to(),r=tp(),n=td(),a=tg(),s=tL(),o=tM(),l=tv(),h=tw(),p=tE(),u=O(),c=D(),d=tS(),g=tD(),f=tO(),_=tV();e.exports=function(t,e,m,y,b,k,M){var v=f(t,m),x=f(e,m),C=M.get(x);if(C){i(t,m,C);return}var w=k?k(v,x,m+"",t,e,M):void 0,P=void 0===w;if(P){var E=l(x),S=!E&&p(x),B=!E&&!S&&g(x);w=x,E||S||B?l(v)?w=v:h(v)?w=a(v):S?(P=!1,w=r(x,!0)):B?(P=!1,w=n(x,!0)):w=[]:d(x)||o(x)?(w=v,o(v)?w=_(v):(!c(v)||u(v))&&(w=s(x))):P=!1}P&&(M.set(x,w),b(w,x,y,k,M),M.delete(x)),i(t,m,w)}}),tq=u((t,e)=>{var i=tn(),r=to(),n=th(),a=tK(),s=D(),o=tU(),l=tO();e.exports=function t(e,h,p,u,c){e!==h&&n(h,function(n,o){if(c||(c=new i),s(n))a(e,h,o,p,t,u,c);else{var d=u?u(l(e,o),n,o+"",e,h,c):void 0;void 0===d&&(d=n),r(e,o,d)}},o)}}),tH=u((t,e)=>{e.exports=function(t){return t}}),tY=u((t,e)=>{e.exports=function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}}),tX=u((t,e)=>{var i=tY(),r=Math.max;e.exports=function(t,e,n){return e=r(void 0===e?t.length-1:e,0),function(){for(var a=arguments,s=-1,o=r(a.length-e,0),l=Array(o);++s<o;)l[s]=a[e+s];s=-1;for(var h=Array(e+1);++s<e;)h[s]=a[s];return h[e]=n(l),i(t,this,h)}}}),t$=u((t,e)=>{e.exports=function(t){return function(){return t}}}),tJ=u((t,e)=>{var i=t$(),r=ta(),n=tH();e.exports=r?function(t,e){return r(t,"toString",{configurable:!0,enumerable:!1,value:i(e),writable:!0})}:n}),tZ=u((t,e)=>{var i=Date.now;e.exports=function(t){var e=0,r=0;return function(){var n=i(),a=16-(n-r);if(r=n,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}}),tW=u((t,e)=>{var i=tJ();e.exports=tZ()(i)}),tQ=u((t,e)=>{var i=tH(),r=tX(),n=tW();e.exports=function(t,e){return n(r(t,e,i),t+"")}}),t0=u((t,e)=>{var i=f(),r=tC(),n=tj(),a=D();e.exports=function(t,e,s){if(!a(s))return!1;var o=typeof e;return("number"==o?!!(r(s)&&n(e,s.length)):"string"==o&&e in s)&&i(s[e],t)}}),t1=u((t,e)=>{var i=tQ(),r=t0();e.exports=function(t){return i(function(e,i){var n=-1,a=i.length,s=a>1?i[a-1]:void 0,o=a>2?i[2]:void 0;for(s=t.length>3&&"function"==typeof s?(a--,s):void 0,o&&r(i[0],i[1],o)&&(s=a<3?void 0:s,a=1),e=Object(e);++n<a;){var l=i[n];l&&t(e,l,n,s)}return e})}}),t2=u((t,e)=>{var i=tq();e.exports=t1()(function(t,e,r){i(t,e,r)})}),t4=u((t,e)=>{var i=T(),r=tb();e.exports=function(t){return"symbol"==typeof t||r(t)&&"[object Symbol]"==i(t)}}),t3=u((t,e)=>{var i=tv(),r=t4(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(t,e){if(i(t))return!1;var s=typeof t;return!!("number"==s||"symbol"==s||"boolean"==s||null==t||r(t))||a.test(t)||!n.test(t)||null!=e&&t in Object(e)}}),t5=u((t,e)=>{var i=ti();function r(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],a=n.cache;if(a.has(r))return a.get(r);var s=t.apply(this,i);return n.cache=a.set(r,s)||a,s};return n.cache=new(r.Cache||i),n}r.Cache=i,e.exports=r}),t8=u((t,e)=>{var i=t5();e.exports=function(t){var e=i(t,function(t){return 500===r.size&&r.clear(),t}),r=e.cache;return e}}),t6=u((t,e)=>{var i=t8(),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g;e.exports=i(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(r,function(t,i,r,a){e.push(r?a.replace(n,"$1"):i||t)}),e})}),t9=u((t,e)=>{e.exports=function(t,e){for(var i=-1,r=null==t?0:t.length,n=Array(r);++i<r;)n[i]=e(t[i],i,t);return n}}),t7=u((t,e)=>{var i=S(),r=t9(),n=tv(),a=t4(),s=1/0,o=i?i.prototype:void 0,l=o?o.toString:void 0;e.exports=function t(e){if("string"==typeof e)return e;if(n(e))return r(e,t)+"";if(a(e))return l?l.call(e):"";var i=e+"";return"0"==i&&1/e==-s?"-0":i}}),et=u((t,e)=>{var i=t7();e.exports=function(t){return null==t?"":i(t)}}),ee=u((t,e)=>{var i=tv(),r=t3(),n=t6(),a=et();e.exports=function(t,e){return i(t)?t:r(t,e)?[t]:n(a(t))}}),ei=u((t,e)=>{var i=t4(),r=1/0;e.exports=function(t){if("string"==typeof t||i(t))return t;var e=t+"";return"0"==e&&1/t==-r?"-0":e}}),er=u((t,e)=>{var i=ee(),r=ei();e.exports=function(t,e){e=i(e,t);for(var n=0,a=e.length;null!=t&&n<a;)t=t[r(e[n++])];return n&&n==a?t:void 0}}),en=u((t,e)=>{var i=er();e.exports=function(t,e,r){var n=null==t?void 0:i(t,e);return void 0===n?r:n}}),ea=u((a,s)=>{!function(o,l){"object"==typeof a&&"u">typeof s?s.exports=l():void 0!==(n="function"==typeof(r=l)?r.call(e,i,e,t):r)&&(t.exports=n)}(0,function(){"use strict";function t(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function e(t,e){return t<e?-1:+(t>e)}var i=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e){n(t,0,t.children.length,e,t)}function n(t,e,i,r,n){n||(n=c(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var s=e;s<i;s++){var o=t.children[s];a(n,t.leaf?r(o):o)}return n}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function s(t,e){return t.minX-e.minX}function o(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function u(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function c(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,r,n,a,s){for(var o=[r,n];o.length;)if(!((n=o.pop())-(r=o.pop())<=a)){var l=r+Math.ceil((n-r)/a/2)*a;(function e(i,r,n,a,s){for(;a>n;){if(a-n>600){var o=a-n+1,l=r-n+1,h=Math.log(o),p=.5*Math.exp(2*h/3),u=.5*Math.sqrt(h*p*(o-p)/o)*(l-o/2<0?-1:1),c=Math.max(n,Math.floor(r-l*p/o+u)),d=Math.min(a,Math.floor(r+(o-l)*p/o+u));e(i,r,c,d,s)}var g=i[r],f=n,_=a;for(t(i,n,r),s(i[a],g)>0&&t(i,n,a);f<_;){for(t(i,f,_),f++,_--;0>s(i[f],g);)f++;for(;s(i[_],g)>0;)_--}0===s(i[n],g)?t(i,n,_):t(i,++_,a),_<=r&&(n=_+1),r<=_&&(a=_-1)}})(i,l,r||0,n||i.length-1,s||e),o.push(r,l,l,n)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(t){var e=this.data,i=[];if(!u(t,e))return i;for(var r=this.toBBox,n=[];e;){for(var a=0;a<e.children.length;a++){var s=e.children[a],o=e.leaf?r(s):s;u(t,o)&&(e.leaf?i.push(s):p(t,o)?this._all(s,i):n.push(s))}e=n.pop()}return i},i.prototype.collides=function(t){var e=this.data;if(!u(t,e))return!1;for(var i=[];e;){for(var r=0;r<e.children.length;r++){var n=e.children[r],a=e.leaf?this.toBBox(n):n;if(u(t,a)){if(e.leaf||p(t,a))return!0;i.push(n)}}e=i.pop()}return!1},i.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length){if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}}else this.data=i;return this},i.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},i.prototype.clear=function(){return this.data=c([]),this},i.prototype.remove=function(t,e){if(!t)return this;for(var i,r,n,a=this.data,s=this.toBBox(t),o=[],l=[];a||o.length;){if(a||(a=o.pop(),r=o[o.length-1],i=l.pop(),n=!0),a.leaf){var h=function(t,e,i){if(!i)return e.indexOf(t);for(var r=0;r<e.length;r++)if(i(t,e[r]))return r;return -1}(t,a.children,e);if(-1!==h)return a.children.splice(h,1),o.push(a),this._condense(o),this}n||a.leaf||!p(a,s)?r?(i++,a=r.children[i],n=!1):a=null:(o.push(a),l.push(i),i=0,r=a,a=a.children[0])}return this},i.prototype.toBBox=function(t){return t},i.prototype.compareMinX=function(t,e){return t.minX-e.minX},i.prototype.compareMinY=function(t,e){return t.minY-e.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(t){return this.data=t,this},i.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},i.prototype._build=function(t,e,i,n){var a,s=i-e+1,o=this._maxEntries;if(s<=o)return r(a=c(t.slice(e,i+1)),this.toBBox),a;n||(n=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,n-1))),(a=c([])).leaf=!1,a.height=n;var l=Math.ceil(s/o),h=l*Math.ceil(Math.sqrt(o));d(t,e,i,h,this.compareMinX);for(var p=e;p<=i;p+=h){var u=Math.min(p+h-1,i);d(t,p,u,l,this.compareMinY);for(var g=p;g<=u;g+=l){var f=Math.min(g+l-1,u);a.children.push(this._build(t,g,f,n-1))}}return r(a,this.toBBox),a},i.prototype._chooseSubtree=function(t,e,i,r){for(;r.push(e),!e.leaf&&r.length-1!==i;){for(var n=1/0,a=1/0,s=void 0,o=0;o<e.children.length;o++){var h=e.children[o],p=l(h),u=(Math.max(h.maxX,t.maxX)-Math.min(h.minX,t.minX))*(Math.max(h.maxY,t.maxY)-Math.min(h.minY,t.minY))-p;u<a?(a=u,n=p<n?p:n,s=h):u===a&&p<n&&(n=p,s=h)}e=s||e.children[0]}return e},i.prototype._insert=function(t,e,i){var r=i?t:this.toBBox(t),n=[],s=this._chooseSubtree(r,this.data,e,n);for(s.children.push(t),a(s,r);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(r,n,e)},i.prototype._split=function(t,e){var i=t[e],n=i.children.length,a=this._minEntries;this._chooseSplitAxis(i,a,n);var s=this._chooseSplitIndex(i,a,n),o=c(i.children.splice(s,i.children.length-s));o.height=i.height,o.leaf=i.leaf,r(i,this.toBBox),r(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},i.prototype._splitRoot=function(t,e){this.data=c([t,e]),this.data.height=t.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(t,e,i){for(var r,a,s,o,h,p=1/0,u=1/0,c=e;c<=i-e;c++){var d=n(t,0,c,this.toBBox),g=n(t,c,i,this.toBBox),f=(a=void 0,s=void 0,o=void 0,a=Math.max(d.minX,g.minX),s=Math.max(d.minY,g.minY),Math.max(0,(o=Math.min(d.maxX,g.maxX))-a)*Math.max(0,Math.min(d.maxY,g.maxY)-s)),_=l(d)+l(g);f<p?(p=f,r=c,u=_<u?_:u):f===p&&_<u&&(u=_,r=c)}return r||i-e},i.prototype._chooseSplitAxis=function(t,e,i){var r=t.leaf?this.compareMinX:s,n=t.leaf?this.compareMinY:o;this._allDistMargin(t,e,i,r)<this._allDistMargin(t,e,i,n)&&t.children.sort(r)},i.prototype._allDistMargin=function(t,e,i,r){t.children.sort(r);for(var s=this.toBBox,o=n(t,0,e,s),l=n(t,i-e,i,s),p=h(o)+h(l),u=e;u<i-e;u++){var c=t.children[u];a(o,t.leaf?s(c):c),p+=h(o)}for(var d=i-e-1;d>=e;d--){var g=t.children[d];a(l,t.leaf?s(g):g),p+=h(l)}return p},i.prototype._adjustParentBBoxes=function(t,e,i){for(var r=i;r>=0;r--)a(e[r],t)},i.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():r(t[e],this.toBBox)},i})}),es=u(t=>{"use strict";function e(t,e,i){void 0===i&&(i={});var r={type:"Feature"};return(0===i.id||i.id)&&(r.id=i.id),i.bbox&&(r.bbox=i.bbox),r.properties=e||{},r.geometry=t,r}function i(t,i,r){if(void 0===r&&(r={}),!t)throw Error("coordinates is required");if(!Array.isArray(t))throw Error("coordinates must be an Array");if(t.length<2)throw Error("coordinates must be at least 2 numbers long");if(!c(t[0])||!c(t[1]))throw Error("coordinates must contain numbers");return e({type:"Point",coordinates:t},i,r)}function r(t,i,r){void 0===r&&(r={});for(var n=0;n<t.length;n++){var a=t[n];if(a.length<4)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw Error("First and last Position are not equivalent.")}return e({type:"Polygon",coordinates:t},i,r)}function n(t,i,r){if(void 0===r&&(r={}),t.length<2)throw Error("coordinates must be an array of two or more positions");return e({type:"LineString",coordinates:t},i,r)}function a(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function s(t,i,r){return void 0===r&&(r={}),e({type:"MultiLineString",coordinates:t},i,r)}function o(t,i,r){return void 0===r&&(r={}),e({type:"MultiPoint",coordinates:t},i,r)}function l(t,i,r){return void 0===r&&(r={}),e({type:"MultiPolygon",coordinates:t},i,r)}function h(e,i){void 0===i&&(i="kilometers");var r=t.factors[i];if(!r)throw Error(i+" units is invalid");return e*r}function p(e,i){void 0===i&&(i="kilometers");var r=t.factors[i];if(!r)throw Error(i+" units is invalid");return e/r}function u(t){return t%(2*Math.PI)*180/Math.PI}function c(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:1.0936*t.earthRadius},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=e,t.geometry=function(t,e,a){switch(void 0===a&&(a={}),t){case"Point":return i(e).geometry;case"LineString":return n(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return o(e).geometry;case"MultiLineString":return s(e).geometry;case"MultiPolygon":return l(e).geometry;default:throw Error(t+" is invalid")}},t.point=i,t.points=function(t,e,r){return void 0===r&&(r={}),a(t.map(function(t){return i(t,e)}),r)},t.polygon=r,t.polygons=function(t,e,i){return void 0===i&&(i={}),a(t.map(function(t){return r(t,e)}),i)},t.lineString=n,t.lineStrings=function(t,e,i){return void 0===i&&(i={}),a(t.map(function(t){return n(t,e)}),i)},t.featureCollection=a,t.multiLineString=s,t.multiPoint=o,t.multiPolygon=l,t.geometryCollection=function(t,i,r){return void 0===r&&(r={}),e({type:"GeometryCollection",geometries:t},i,r)},t.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i},t.radiansToLength=h,t.lengthToRadians=p,t.lengthToDegrees=function(t,e){return u(p(t,e))},t.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},t.radiansToDegrees=u,t.degreesToRadians=function(t){return t%360*Math.PI/180},t.convertLength=function(t,e,i){if(void 0===e&&(e="kilometers"),void 0===i&&(i="kilometers"),!(t>=0))throw Error("length must be a positive number");return h(p(t,e),i)},t.convertArea=function(e,i,r){if(void 0===i&&(i="meters"),void 0===r&&(r="kilometers"),!(e>=0))throw Error("area must be a positive number");var n=t.areaFactors[i];if(!n)throw Error("invalid original units");var a=t.areaFactors[r];if(!a)throw Error("invalid final units");return e/n*a},t.isNumber=c,t.isObject=function(t){return!!t&&t.constructor===Object},t.validateBBox=function(t){if(!t)throw Error("bbox is required");if(!Array.isArray(t))throw Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!c(t))throw Error("bbox must only contain numbers")})},t.validateId=function(t){if(!t)throw Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw Error("id must be a number or a string")}}),eo=u(t=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=es();function i(t,e,r){if(null!==t)for(var n,a,s,o,l,h,p,u,c=0,d=0,g=t.type,f="FeatureCollection"===g,_="Feature"===g,m=f?t.features.length:1,y=0;y<m;y++){l=(u=!!(p=f?t.features[y].geometry:_?t.geometry:t)&&"GeometryCollection"===p.type)?p.geometries.length:1;for(var b=0;b<l;b++){var k=0,M=0;if(null!==(o=u?p.geometries[b]:p)){h=o.coordinates;var v=o.type;switch(c=r&&("Polygon"===v||"MultiPolygon"===v)?1:0,v){case null:break;case"Point":if(!1===e(h,d,y,k,M))return!1;d++,k++;break;case"LineString":case"MultiPoint":for(n=0;n<h.length;n++){if(!1===e(h[n],d,y,k,M))return!1;d++,"MultiPoint"===v&&k++}"LineString"===v&&k++;break;case"Polygon":case"MultiLineString":for(n=0;n<h.length;n++){for(a=0;a<h[n].length-c;a++){if(!1===e(h[n][a],d,y,k,M))return!1;d++}"MultiLineString"===v&&k++,"Polygon"===v&&M++}"Polygon"===v&&k++;break;case"MultiPolygon":for(n=0;n<h.length;n++){for(M=0,a=0;a<h[n].length;a++){for(s=0;s<h[n][a].length-c;s++){if(!1===e(h[n][a][s],d,y,k,M))return!1;d++}M++}k++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===i(o.geometries[n],e,r))return!1;break;default:throw Error("Unknown Geometry Type")}}}}}function r(t,e){var i;switch(t.type){case"FeatureCollection":for(i=0;i<t.features.length&&!1!==e(t.features[i].properties,i);i++);break;case"Feature":e(t.properties,0)}}function n(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function a(t,e){var i,r,n,a,s,o,l,h,p,u,c=0,d="FeatureCollection"===t.type,g="Feature"===t.type,f=d?t.features.length:1;for(i=0;i<f;i++){for(o=d?t.features[i].geometry:g?t.geometry:t,h=d?t.features[i].properties:g?t.properties:{},p=d?t.features[i].bbox:g?t.bbox:void 0,u=d?t.features[i].id:g?t.id:void 0,s=(l=!!o&&"GeometryCollection"===o.type)?o.geometries.length:1,n=0;n<s;n++){if(null===(a=l?o.geometries[n]:o)){if(!1===e(null,c,h,p,u))return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(a,c,h,p,u))return!1;break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===e(a.geometries[r],c,h,p,u))return!1;break;default:throw Error("Unknown Geometry Type")}}c++}}function s(t,i){a(t,function(t,r,n,a,s){var o,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==i(e.feature(t,n,{bbox:a,id:s}),r,0)&&void 0}switch(l){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var h=0;h<t.coordinates.length;h++){var p={type:o,coordinates:t.coordinates[h]};if(!1===i(e.feature(p,n),r,h))return!1}})}function o(t,r){s(t,function(t,n,a){var s=0;if(t.geometry){var o=t.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var l,h=0,p=0,u=0;if(!1===i(t,function(i,o,c,d,g){if(void 0===l||n>h||d>p||g>u){l=i,h=n,p=d,u=g,s=0;return}if(!1===r(e.lineString([l,i],t.properties),n,a,g,s))return!1;s++,l=i}))return!1}}})}function l(t,i){if(!t)throw Error("geojson is required");s(t,function(t,r,n){if(null!==t.geometry){var a=t.geometry.type,s=t.geometry.coordinates;switch(a){case"LineString":if(!1===i(t,r,n,0,0))return!1;break;case"Polygon":for(var o=0;o<s.length;o++)if(!1===i(e.lineString(s[o],t.properties),r,n,o))return!1}}})}t.coordAll=function(t){var e=[];return i(t,function(t){e.push(t)}),e},t.coordEach=i,t.coordReduce=function(t,e,r,n){var a=r;return i(t,function(t,i,n,s,o){a=0===i&&void 0===r?t:e(a,t,i,n,s,o)},n),a},t.featureEach=n,t.featureReduce=function(t,e,i){var r=i;return n(t,function(t,n){r=0===n&&void 0===i?t:e(r,t,n)}),r},t.findPoint=function(t,i){if(i=i||{},!e.isObject(i))throw Error("options is invalid");var r,n=i.featureIndex||0,a=i.multiFeatureIndex||0,s=i.geometryIndex||0,o=i.coordIndex||0,l=i.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),l=l||t.features[n].properties,r=t.features[n].geometry;break;case"Feature":l=l||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw Error("geojson is invalid")}if(null===r)return null;var h=r.coordinates;switch(r.type){case"Point":return e.point(h,l,i);case"MultiPoint":return a<0&&(a=h.length+a),e.point(h[a],l,i);case"LineString":return o<0&&(o=h.length+o),e.point(h[o],l,i);case"Polygon":return s<0&&(s=h.length+s),o<0&&(o=h[s].length+o),e.point(h[s][o],l,i);case"MultiLineString":return a<0&&(a=h.length+a),o<0&&(o=h[a].length+o),e.point(h[a][o],l,i);case"MultiPolygon":return a<0&&(a=h.length+a),s<0&&(s=h[a].length+s),o<0&&(o=h[a][s].length-o),e.point(h[a][s][o],l,i)}throw Error("geojson is invalid")},t.findSegment=function(t,i){if(i=i||{},!e.isObject(i))throw Error("options is invalid");var r,n=i.featureIndex||0,a=i.multiFeatureIndex||0,s=i.geometryIndex||0,o=i.segmentIndex||0,l=i.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),l=l||t.features[n].properties,r=t.features[n].geometry;break;case"Feature":l=l||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw Error("geojson is invalid")}if(null===r)return null;var h=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=h.length+o-1),e.lineString([h[o],h[o+1]],l,i);case"Polygon":return s<0&&(s=h.length+s),o<0&&(o=h[s].length+o-1),e.lineString([h[s][o],h[s][o+1]],l,i);case"MultiLineString":return a<0&&(a=h.length+a),o<0&&(o=h[a].length+o-1),e.lineString([h[a][o],h[a][o+1]],l,i);case"MultiPolygon":return a<0&&(a=h.length+a),s<0&&(s=h[a].length+s),o<0&&(o=h[a][s].length-o-1),e.lineString([h[a][s][o],h[a][s][o+1]],l,i)}throw Error("geojson is invalid")},t.flattenEach=s,t.flattenReduce=function(t,e,i){var r=i;return s(t,function(t,n,a){r=0===n&&0===a&&void 0===i?t:e(r,t,n,a)}),r},t.geomEach=a,t.geomReduce=function(t,e,i){var r=i;return a(t,function(t,n,a,s,o){r=0===n&&void 0===i?t:e(r,t,n,a,s,o)}),r},t.lineEach=l,t.lineReduce=function(t,e,i){var r=i;return l(t,function(t,n,a,s){r=0===n&&void 0===i?t:e(r,t,n,a,s)}),r},t.propEach=r,t.propReduce=function(t,e,i){var n=i;return r(t,function(t,r){n=0===r&&void 0===i?t:e(n,t,r)}),n},t.segmentEach=o,t.segmentReduce=function(t,e,i){var r=i,n=!1;return o(t,function(t,a,s,o,l){r=!1===n&&void 0===i?t:e(r,t,a,s,o,l),n=!0}),r}}),el=u(t=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=eo();function i(t){var i=[1/0,1/0,-1/0,-1/0];return e.coordEach(t,function(t){i[0]>t[0]&&(i[0]=t[0]),i[1]>t[1]&&(i[1]=t[1]),i[2]<t[0]&&(i[2]=t[0]),i[3]<t[1]&&(i[3]=t[1])}),i}i.default=i,t.default=i}),eh=u((t,e)=>{var i=ea(),r=es(),n=eo(),a=el().default,s=n.featureEach,o=(n.coordEach,r.polygon,r.featureCollection);function l(t){var e=new i(t);return e.insert=function(t){if("Feature"!==t.type)throw Error("invalid feature");return t.bbox=t.bbox?t.bbox:a(t),i.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach(function(t){if("Feature"!==t.type)throw Error("invalid features");t.bbox=t.bbox?t.bbox:a(t),e.push(t)}):s(t,function(t){if("Feature"!==t.type)throw Error("invalid features");t.bbox=t.bbox?t.bbox:a(t),e.push(t)}),i.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw Error("invalid feature");return t.bbox=t.bbox?t.bbox:a(t),i.prototype.remove.call(this,t,e)},e.clear=function(){return i.prototype.clear.call(this)},e.search=function(t){return o(i.prototype.search.call(this,this.toBBox(t)))},e.collides=function(t){return i.prototype.collides.call(this,this.toBBox(t))},e.all=function(){return o(i.prototype.all.call(this))},e.toJSON=function(){return i.prototype.toJSON.call(this)},e.fromJSON=function(t){return i.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=a(t);else if("FeatureCollection"===t.type)e=a(t);else throw Error("invalid geojson");return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}e.exports=l,e.exports.default=l});Array.prototype.findIndex=Array.prototype.findIndex||function(t){if(this===null)throw TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw TypeError("callback must be a function");for(var e=Object(this),i=e.length>>>0,r=arguments[1],n=0;n<i;n++)if(t.call(r,e[n],n,e))return n;return -1},Array.prototype.find=Array.prototype.find||function(t){if(this===null)throw TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw TypeError("callback must be a function");for(var e=Object(this),i=e.length>>>0,r=arguments[1],n=0;n<i;n++){var a=e[n];if(t.call(r,a,n,e))return a}},"function"!=typeof Object.assign&&(Object.assign=function(t){"use strict";if(null==t)throw TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var i=arguments[e];if(null!=i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}),function(t){t.forEach(function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(this==null)throw TypeError('"this" is null or not defined');var i,r=Object(this),n=r.length>>>0;if(0===n)return!1;for(var a=0|e,s=Math.max(a>=0?a:n-Math.abs(a),0);s<n;){if((i=r[s])===t||"number"==typeof i&&"number"==typeof t&&isNaN(i)&&isNaN(t))return!0;s++}return!1}});var ep=d(t2()),eu={tooltips:{placeMarker:"Clique para colocar marcador",firstVertex:"Clique para colocar primeiro v\xe9rtice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do c\xedrculo",finishCircle:"Clique para terminar o c\xedrculo",placeCircleMarker:"Clique para colocar marcador de c\xedrculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover \xdaltimo V\xe9rtice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Pol\xedgonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar C\xedrculo",drawRectButton:"Desenhar Ret\xe2ngulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de C\xedrculo",snappingButton:"Ajustar marcador arrastado a outras camadas e v\xe9rtices",pinningButton:"Unir v\xe9rtices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Tra\xe7ado Autom\xe1tico de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"\xc1rea",radius:"Raio",perimeter:"Per\xedmetro",height:"Altura",width:"Largura",coordinates:"Posi\xe7\xe3o",coordinatesMarker:"Marcador de Posi\xe7\xe3o"}},ec={en:{tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},de:{tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex l\xf6schen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer l\xf6schen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verkn\xfcpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"L\xe4nge",segmentLength:"Segment L\xe4nge",area:"Fl\xe4che",radius:"Radius",perimeter:"Umfang",height:"H\xf6he",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},it:{tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},id:{tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},ro:{tooltips:{placeMarker:"Adaugă un punct",firstVertex:"Apasă aici pentru a adăuga primul Vertex",continueLine:"Apasă aici pentru a continua desenul",finishLine:"Apasă pe orice obiect pentru a finisa desenul",finishPoly:"Apasă pe primul obiect pentru a finisa",finishRect:"Apasă pentru a finisa",startCircle:"Apasă pentru a desena un cerc",finishCircle:"Apasă pentru a finisa un cerc",placeCircleMarker:"Adaugă un punct"},actions:{finish:"Termină",cancel:"Anulează",removeLastVertex:"Șterge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaugă o bulină",drawPolyButton:"Desenează un poligon",drawLineButton:"Desenează o linie",drawCircleButton:"Desenează un cerc",drawRectButton:"Desenează un dreptunghi",editButton:"Editează straturile",dragButton:"Mută straturile",cutButton:"Taie straturile",deleteButton:"Șterge straturile",drawCircleMarkerButton:"Desenează marcatorul cercului",snappingButton:"Fixați marcatorul glisat pe alte straturi și v\xe2rfuri",pinningButton:"Fixați v\xe2rfurile partajate \xeempreună",rotateButton:"Rotiți stratul"}},ru:{tooltips:{placeMarker:"Нажмите, чтобы нанести маркер",firstVertex:"Нажмите, чтобы нанести первый объект",continueLine:"Нажмите, чтобы продолжить рисование",finishLine:"Нажмите любой существующий маркер для завершения",finishPoly:"Выберите первую точку, чтобы закончить",finishRect:"Нажмите, чтобы закончить",startCircle:"Нажмите, чтобы добавить центр круга",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Нажмите, чтобы нанести круговой маркер"},actions:{finish:"Завершить",cancel:"Отменить",removeLastVertex:"Отменить последнее действие"},buttonTitles:{drawMarkerButton:"Добавить маркер",drawPolyButton:"Рисовать полигон",drawLineButton:"Рисовать кривую",drawCircleButton:"Рисовать круг",drawRectButton:"Рисовать прямоугольник",editButton:"Редактировать слой",dragButton:"Перенести слой",cutButton:"Вырезать слой",deleteButton:"Удалить слой",drawCircleMarkerButton:"Добавить круговой маркер",snappingButton:"Привязать перетаскиваемый маркер к другим слоям и вершинам",pinningButton:"Связать общие точки вместе",rotateButton:"Поворот слоя"}},es:{tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer v\xe9rtice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del c\xedrculo",finishCircle:"Presiona para finalizar el c\xedrculo",placeCircleMarker:"Presiona para colocar un marcador de c\xedrculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar \xfaltimo v\xe9rtice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Pol\xedgono",drawLineButton:"Dibujar L\xednea",drawCircleButton:"Dibujar C\xedrculo",drawRectButton:"Dibujar Rect\xe1ngulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de C\xedrculo",snappingButton:"El marcador de Snap arrastrado a otras capas y v\xe9rtices",pinningButton:"Fijar juntos los v\xe9rtices compartidos",rotateButton:"Rotar capa"}},nl:{tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te be\xebindigen",finishPoly:"Klik op het eerst punt om te be\xebindigen",finishRect:"Klik om te be\xebindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te be\xebindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},fr:{tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer \xe0 dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"\xc9diter des calques",dragButton:"D\xe9placer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"\xc9pingler ensemble les sommets partag\xe9s",rotateButton:"Tourner des calques"}},pt:eu,pt_br:{tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro v\xe9rtice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do c\xedrculo",finishCircle:"Clique para finalizar o c\xedrculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover \xfaltimo v\xe9rtice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Pol\xedgonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar C\xedrculo",drawRectButton:"Desenhar Ret\xe2ngulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de C\xedrculo",snappingButton:"Ajustar marcador arrastado a outras camadas e v\xe9rtices",pinningButton:"Unir v\xe9rtices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Tra\xe7ado Autom\xe1tico de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"\xc1rea",radius:"Raio",perimeter:"Per\xedmetro",height:"Altura",width:"Largura",coordinates:"Posi\xe7\xe3o",coordinatesMarker:"Marcador de Posi\xe7\xe3o"}},pt_pt:eu,zh:{tooltips:{placeMarker:"单击放置标记",firstVertex:"单击放置首个顶点",continueLine:"单击继续绘制",finishLine:"单击任何存在的标记以完成",finishPoly:"单击第一个标记以完成",finishRect:"单击完成",startCircle:"单击放置圆心",finishCircle:"单击完成圆形",placeCircleMarker:"点击放置圆形标记"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最后的顶点"},buttonTitles:{drawMarkerButton:"绘制标记",drawPolyButton:"绘制多边形",drawLineButton:"绘制线段",drawCircleButton:"绘制圆形",drawRectButton:"绘制长方形",editButton:"编辑图层",dragButton:"拖拽图层",cutButton:"剪切图层",deleteButton:"删除图层",drawCircleMarkerButton:"画圆圈标记",snappingButton:"将拖动的标记捕捉到其他图层和顶点",pinningButton:"将共享顶点固定在一起",rotateButton:"旋转图层"}},zh_tw:{tooltips:{placeMarker:"單擊放置標記",firstVertex:"單擊放置第一個頂點",continueLine:"單擊繼續繪製",finishLine:"單擊任何存在的標記以完成",finishPoly:"單擊第一個標記以完成",finishRect:"單擊完成",startCircle:"單擊放置圓心",finishCircle:"單擊完成圓形",placeCircleMarker:"點擊放置圓形標記"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最後一個頂點"},buttonTitles:{drawMarkerButton:"放置標記",drawPolyButton:"繪製多邊形",drawLineButton:"繪製線段",drawCircleButton:"繪製圓形",drawRectButton:"繪製方形",editButton:"編輯圖形",dragButton:"移動圖形",cutButton:"裁切圖形",deleteButton:"刪除圖形",drawCircleMarkerButton:"畫圓圈標記",snappingButton:"將拖動的標記對齊到其他圖層和頂點",pinningButton:"將共享頂點固定在一起",rotateButton:"旋轉圖形"}},pl:{tooltips:{placeMarker:"Kliknij, aby umieścić znacznik",firstVertex:"Kliknij, aby umieścić pierwszy wierzchołek",continueLine:"Kliknij, aby kontynuować rysowanie",finishLine:"Kliknij dowolny istniejący znacznik, aby zakończyć",finishPoly:"Kliknij pierwszy znacznik, aby zakończyć",finishRect:"Kliknij, aby zakończyć",startCircle:"Kliknij, aby umieścić środek okręgu",finishCircle:"Kliknij, aby zakończyć okrąg",placeCircleMarker:"Kliknij, aby umieścić znacznik okręgu",placeText:"Kliknij, aby umieścić tekst"},actions:{finish:"Zakończ",cancel:"Anuluj",removeLastVertex:"Usuń ostatni wierzchołek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokąt",drawLineButton:"Rysuj linię",drawCircleButton:"Rysuj okrąg",drawRectButton:"Rysuj prostokąt",editButton:"Edytuj warstwy",dragButton:"Przeciągnij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usuń warstwy",drawCircleMarkerButton:"Rysuj znacznik okrągły",snappingButton:"Przyciągnij przenoszony znacznik do innych warstw i wierzchołk\xf3w",pinningButton:"Przypnij wsp\xf3lne wierzchołki razem",rotateButton:"Obr\xf3ć warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne śledzenie linii"},measurements:{totalLength:"Długość",segmentLength:"Długość odcinka",area:"Obszar",radius:"Promień",perimeter:"Obw\xf3d",height:"Wysokość",width:"Szerokość",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},sv:{tooltips:{placeMarker:"Klicka f\xf6r att placera mark\xf6r",firstVertex:"Klicka f\xf6r att placera f\xf6rsta h\xf6rnet",continueLine:"Klicka f\xf6r att forts\xe4tta rita",finishLine:"Klicka p\xe5 en existerande punkt f\xf6r att slutf\xf6ra",finishPoly:"Klicka p\xe5 den f\xf6rsta punkten f\xf6r att slutf\xf6ra",finishRect:"Klicka f\xf6r att slutf\xf6ra",startCircle:"Klicka f\xf6r att placera cirkelns centrum",finishCircle:"Klicka f\xf6r att slutf\xf6ra cirkeln",placeCircleMarker:"Klicka f\xf6r att placera cirkelmark\xf6r"},actions:{finish:"Slutf\xf6r",cancel:"Avbryt",removeLastVertex:"Ta bort sista h\xf6rnet"},buttonTitles:{drawMarkerButton:"Rita Mark\xf6r",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmark\xf6r",snappingButton:"Sn\xe4pp dra mark\xf6ren till andra lager och h\xf6rn",pinningButton:"F\xe4st delade h\xf6rn tillsammans",rotateButton:"Rotera lagret"}},el:{tooltips:{placeMarker:"Κάντε κλικ για να τοποθετήσετε Δείκτη",firstVertex:"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο",continueLine:"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε",finishLine:"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί",finishPoly:"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε",finishRect:"Κάντε κλικ για να τελειώσετε",startCircle:"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου",finishCircle:"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο",placeCircleMarker:"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},actions:{finish:"Τέλος",cancel:"Ακύρωση",removeLastVertex:"Κατάργηση τελευταίου σημείου"},buttonTitles:{drawMarkerButton:"Σχεδίαση Δείκτη",drawPolyButton:"Σχεδίαση Πολυγώνου",drawLineButton:"Σχεδίαση Γραμμής",drawCircleButton:"Σχεδίαση Κύκλου",drawRectButton:"Σχεδίαση Ορθογωνίου",editButton:"Επεξεργασία Επιπέδων",dragButton:"Μεταφορά Επιπέδων",cutButton:"Αποκοπή Επιπέδων",deleteButton:"Κατάργηση Επιπέδων",drawCircleMarkerButton:"Σχεδίαση Κυκλικού Δείκτη",snappingButton:"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές",pinningButton:"Περικοπή κοινών κορυφών μαζί",rotateButton:"Περιστρέψτε το στρώμα"}},hu:{tooltips:{placeMarker:"Kattintson a jel\xf6lő elhelyez\xe9s\xe9hez",firstVertex:"Kattintson az első pont elhelyez\xe9s\xe9hez",continueLine:"Kattintson a k\xf6vetkező pont elhelyez\xe9s\xe9hez",finishLine:"A befejez\xe9shez kattintson egy megl\xe9vő pontra",finishPoly:"A befejez\xe9shez kattintson az első pontra",finishRect:"Kattintson a befejez\xe9shez",startCircle:"Kattintson a k\xf6r k\xf6z\xe9ppontj\xe1nak elhelyez\xe9s\xe9hez",finishCircle:"Kattintson a k\xf6r befejez\xe9s\xe9hez",placeCircleMarker:"Kattintson a k\xf6rjel\xf6lő elhelyez\xe9s\xe9hez"},actions:{finish:"Befejez\xe9s",cancel:"M\xe9gse",removeLastVertex:"Utols\xf3 pont elt\xe1vol\xedt\xe1sa"},buttonTitles:{drawMarkerButton:"Jel\xf6lő rajzol\xe1sa",drawPolyButton:"Poligon rajzol\xe1sa",drawLineButton:"Vonal rajzol\xe1sa",drawCircleButton:"K\xf6r rajzol\xe1sa",drawRectButton:"N\xe9gyzet rajzol\xe1sa",editButton:"Elemek szerkeszt\xe9se",dragButton:"Elemek mozgat\xe1sa",cutButton:"Elemek v\xe1g\xe1sa",deleteButton:"Elemek t\xf6rl\xe9se",drawCircleMarkerButton:"K\xf6r jel\xf6lő rajzol\xe1sa",snappingButton:"Kapcsolja a jel\xf6ltőt m\xe1sik elemhez vagy ponthoz",pinningButton:"K\xf6z\xf6s pontok \xf6sszek\xf6t\xe9se",rotateButton:"F\xf3lia elforgat\xe1sa"}},da:{tooltips:{placeMarker:"Tryk for at placere en mark\xf8r",firstVertex:"Tryk for at placere det f\xf8rste punkt",continueLine:"Tryk for at forts\xe6tte linjen",finishLine:"Tryk p\xe5 et eksisterende punkt for at afslutte",finishPoly:"Tryk p\xe5 det f\xf8rste punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmark\xf8r"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer mark\xf8r",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Tr\xe6k",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmark\xf8r",snappingButton:"Fastg\xf8r trukket mark\xf8r til andre elementer",pinningButton:"Sammenl\xe6g delte elementer",rotateButton:"Roter laget"}},no:{tooltips:{placeMarker:"Klikk for \xe5 plassere punkt",firstVertex:"Klikk for \xe5 plassere f\xf8rste punkt",continueLine:"Klikk for \xe5 tegne videre",finishLine:"Klikk p\xe5 et eksisterende punkt for \xe5 fullf\xf8re",finishPoly:"Klikk f\xf8rste punkt for \xe5 fullf\xf8re",finishRect:"Klikk for \xe5 fullf\xf8re",startCircle:"Klikk for \xe5 sette sirkel midtpunkt",finishCircle:"Klikk for \xe5 fullf\xf8re sirkel",placeCircleMarker:"Klikk for \xe5 plassere sirkel",placeText:"Klikk for \xe5 plassere tekst"},actions:{finish:"Fullf\xf8r",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rot\xe9r objekter",drawTextButton:"Tegn tekst",scaleButton:"Skal\xe9r objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Omr\xe5de",radius:"Radius",perimeter:"Omriss",height:"H\xf8yde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmark\xf8r"}},fa:{tooltips:{placeMarker:"کلیک برای جانمایی نشان",firstVertex:"کلیک برای رسم اولین رأس",continueLine:"کلیک برای ادامه رسم",finishLine:"کلیک روی هر نشان موجود برای پایان",finishPoly:"کلیک روی اولین نشان برای پایان",finishRect:"کلیک برای پایان",startCircle:"کلیک برای رسم مرکز دایره",finishCircle:"کلیک برای پایان رسم دایره",placeCircleMarker:"کلیک برای رسم نشان دایره",placeText:"کلیک برای نوشتن متن"},actions:{finish:"پایان",cancel:"لفو",removeLastVertex:"حذف آخرین رأس"},buttonTitles:{drawMarkerButton:"درج نشان",drawPolyButton:"رسم چندضلعی",drawLineButton:"رسم خط",drawCircleButton:"رسم دایره",drawRectButton:"رسم چهارضلعی",editButton:"ویرایش لایه‌ها",dragButton:"جابجایی لایه‌ها",cutButton:"برش لایه‌ها",deleteButton:"حذف لایه‌ها",drawCircleMarkerButton:"رسم نشان دایره",snappingButton:"نشانگر را به لایه‌ها و رئوس دیگر بکشید",pinningButton:"رئوس مشترک را با هم پین کنید",rotateButton:"چرخش لایه",drawTextButton:"رسم متن",scaleButton:"مقیاس‌گذاری",autoTracingButton:"ردیاب خودکار"},measurements:{totalLength:"طول",segmentLength:"طول بخش",area:"ناحیه",radius:"شعاع",perimeter:"محیط",height:"ارتفاع",width:"عرض",coordinates:"موقعیت",coordinatesMarker:"موقعیت نشان"}},ua:{tooltips:{placeMarker:"Натисніть, щоб нанести маркер",firstVertex:"Натисніть, щоб нанести першу вершину",continueLine:"Натисніть, щоб продовжити малювати",finishLine:"Натисніть будь-який існуючий маркер для завершення",finishPoly:"Виберіть перший маркер, щоб завершити",finishRect:"Натисніть, щоб завершити",startCircle:"Натисніть, щоб додати центр кола",finishCircle:"Натисніть, щоб завершити коло",placeCircleMarker:"Натисніть, щоб нанести круговий маркер"},actions:{finish:"Завершити",cancel:"Відмінити",removeLastVertex:"Видалити попередню вершину"},buttonTitles:{drawMarkerButton:"Малювати маркер",drawPolyButton:"Малювати полігон",drawLineButton:"Малювати криву",drawCircleButton:"Малювати коло",drawRectButton:"Малювати прямокутник",editButton:"Редагувати шари",dragButton:"Перенести шари",cutButton:"Вирізати шари",deleteButton:"Видалити шари",drawCircleMarkerButton:"Малювати круговий маркер",snappingButton:"Прив’язати перетягнутий маркер до інших шарів та вершин",pinningButton:"Зв'язати спільні вершини разом",rotateButton:"Повернути шар"}},tr:{tooltips:{placeMarker:"İşaret\xe7i yerleştirmek i\xe7in tıklayın",firstVertex:"İlk tepe noktasını yerleştirmek i\xe7in tıklayın",continueLine:"\xc7izime devam etmek i\xe7in tıklayın",finishLine:"Bitirmek i\xe7in mevcut herhangi bir işaret\xe7iyi tıklayın",finishPoly:"Bitirmek i\xe7in ilk işaret\xe7iyi tıklayın",finishRect:"Bitirmek i\xe7in tıklayın",startCircle:"Daire merkezine yerleştirmek i\xe7in tıklayın",finishCircle:"Daireyi bitirmek i\xe7in tıklayın",placeCircleMarker:"Daire işaret\xe7isi yerleştirmek i\xe7in tıklayın"},actions:{finish:"Bitir",cancel:"İptal",removeLastVertex:"Son k\xf6şeyi kaldır"},buttonTitles:{drawMarkerButton:"\xc7izim İşaret\xe7isi",drawPolyButton:"\xc7okgenler \xe7iz",drawLineButton:"\xc7oklu \xe7izgi \xe7iz",drawCircleButton:"\xc7ember \xe7iz",drawRectButton:"Dikd\xf6rtgen \xe7iz",editButton:"Katmanları d\xfczenle",dragButton:"Katmanları s\xfcr\xfckle",cutButton:"Katmanları kes",deleteButton:"Katmanları kaldır",drawCircleMarkerButton:"Daire işaret\xe7isi \xe7iz",snappingButton:"S\xfcr\xfcklenen işaret\xe7iyi diğer katmanlara ve k\xf6şelere yapıştır",pinningButton:"Paylaşılan k\xf6şeleri birbirine sabitle",rotateButton:"Katmanı d\xf6nd\xfcr"}},cz:{tooltips:{placeMarker:"Kliknut\xedm vytvoř\xedte značku",firstVertex:"Kliknut\xedm vytvoř\xedte prvn\xed objekt",continueLine:"Kliknut\xedm pokračujte v kreslen\xed",finishLine:"Kliknut\xed na libovolnou existuj\xedc\xed značku pro dokončen\xed",finishPoly:"Vyberte prvn\xed bod pro dokončen\xed",finishRect:"Klikněte pro dokončen\xed",startCircle:"Kliknut\xedm přidejte střed kruhu",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Kliknut\xedm nastavte poloměr"},actions:{finish:"Dokončit",cancel:"Zrušit",removeLastVertex:"Zrušit posledn\xed akci"},buttonTitles:{drawMarkerButton:"Přidat značku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit křivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obd\xe9ln\xedk",editButton:"Upravit vrstvu",dragButton:"Přeneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Přidat kruhovou značku",snappingButton:"Nav\xe1zat tažnou značku k dalš\xedm vrstv\xe1m a vrcholům",pinningButton:"Spojit společn\xe9 body dohromady",rotateButton:"Otočte vrstvu"}},ja:{tooltips:{placeMarker:"クリックしてマーカーを配置",firstVertex:"クリックして最初の頂点を配置",continueLine:"クリックして描画を続ける",finishLine:"任意のマーカーをクリックして終了",finishPoly:"最初のマーカーをクリックして終了",finishRect:"クリックして終了",startCircle:"クリックして円の中心を配置",finishCircle:"クリックして円の描画を終了",placeCircleMarker:"クリックして円マーカーを配置",placeText:"クリックしてテキストを配置"},actions:{finish:"終了",cancel:"キャンセル",removeLastVertex:"最後の頂点を削除"},buttonTitles:{drawMarkerButton:"マーカーを描画",drawPolyButton:"ポリゴンを描画",drawLineButton:"折れ線を描画",drawCircleButton:"円を描画",drawRectButton:"矩形を描画",editButton:"レイヤーを編集",dragButton:"レイヤーをドラッグ",cutButton:"レイヤーを切り取り",deleteButton:"レイヤーを削除",drawCircleMarkerButton:"円マーカーを描画",snappingButton:"ドラッグしたマーカーを他のレイヤーや頂点にスナップする",pinningButton:"共有する頂点を同時に動かす",rotateButton:"レイヤーを回転",drawTextButton:"テキストを描画"}},fi:{tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimm\xe4isen osuuden",continueLine:"Klikkaa jatkaaksesi piirt\xe4mist\xe4",finishLine:"Klikkaa olemassa olevaa merkki\xe4 lopettaaksesi",finishPoly:"Klikkaa ensimm\xe4ist\xe4 merkki\xe4 lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyr\xe4n keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyr\xe4n",placeCircleMarker:"Klikkaa asettaaksesi ympyr\xe4merkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirr\xe4 merkkej\xe4",drawPolyButton:"Piirr\xe4 monikulmioita",drawLineButton:"Piirr\xe4 viivoja",drawCircleButton:"Piirr\xe4 ympyr\xe4",drawRectButton:"Piirr\xe4 neliskulmioita",editButton:"Muokkaa",dragButton:"Siirr\xe4",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirr\xe4 ympyr\xe4merkki",snappingButton:"Kiinnit\xe4 siirrett\xe4v\xe4 merkki toisiin muotoihin",pinningButton:"Kiinnit\xe4 jaetut muodot yhteen",rotateButton:"K\xe4\xe4nn\xe4",drawTextButton:"Piirr\xe4 teksti\xe4"}},ko:{tooltips:{placeMarker:"마커 위치를 클릭하세요",firstVertex:"첫번째 꼭지점 위치을 클릭하세요",continueLine:"계속 그리려면 클릭하세요",finishLine:"끝내려면 기존 마커를 클릭하세요",finishPoly:"끝내려면 처음 마커를 클릭하세요",finishRect:"끝내려면 클릭하세요",startCircle:"원의 중심이 될 위치를 클릭하세요",finishCircle:"원을 끝내려면 클릭하세요",placeCircleMarker:"원 마커 위치를 클릭하세요",placeText:"텍스트 위치를 클릭하세요"},actions:{finish:"끝내기",cancel:"취소",removeLastVertex:"마지막 꼭지점 제거"},buttonTitles:{drawMarkerButton:"마커 그리기",drawPolyButton:"다각형 그리기",drawLineButton:"다각선 그리기",drawCircleButton:"원 그리기",drawRectButton:"직사각형 그리기",editButton:"레이어 편집하기",dragButton:"레이어 끌기",cutButton:"레이어 자르기",deleteButton:"레이어 제거하기",drawCircleMarkerButton:"원 마커 그리기",snappingButton:"잡아끈 마커를 다른 레이어 및 꼭지점에 들러붙게 하기",pinningButton:"공유 꼭지점을 함께 찍기",rotateButton:"레이어 회전하기",drawTextButton:"텍스트 그리기"}},ky:{tooltips:{placeMarker:"Маркерди жайгаштыруу үчүн басыңыз",firstVertex:"Биринчи чокуну жайгаштырууну үчүн басыңыз",continueLine:"Сүрөт тартууну улантуу үчүн басыңыз",finishLine:"Аяктоо үчүн учурдагы маркерди басыңыз",finishPoly:"Бүтүрүү үчүн биринчи маркерди басыңыз",finishRect:"Бүтүрүү үчүн басыңыз",startCircle:"Айлананын борборун жайгаштырууну үчүн басыңыз",finishCircle:"Айлананы бүтүрүү үчүн басыңыз",placeCircleMarker:"Тегерек маркерди жайгаштыруу үчүн басыңыз",placeText:"Текстти жайгаштыруу үчүн басыңыз"},actions:{finish:"Аягы",cancel:"Жок кылуу",removeLastVertex:"Акыркы чокуну өчүрүү"},buttonTitles:{drawMarkerButton:"Маркерди чизуу",drawPolyButton:"Полигон чизуу",drawLineButton:"Полилиния чизуу",drawCircleButton:"Дайынды чизуу",drawRectButton:"Прямоугольник чизуу",editButton:"Слоопту түзөтүү",dragButton:"Слоопту карап сүйлөү",cutButton:"Слооптун башын кесүү",deleteButton:"Слооптун өчүрүү",drawCircleMarkerButton:"Дайынды маркерди чизуу",snappingButton:"Башка слооптордун жана вертекстердин арасына чекилдөө",pinningButton:"Бөлүшкөн вертекстерди бирге тутуштуруу",rotateButton:"Слооптун өзгөртүү",drawTextButton:"Текст чизуу",scaleButton:"Слооптун өлчөмүн өзгөртүү",autoTracingButton:"Автоматтык тизмеги чизуу"},measurements:{totalLength:"Узундук",segmentLength:"Сегмент узундугу",area:"Аймак",radius:"Радиус",perimeter:"Периметр",height:"Диаметр",width:"Кенчилик",coordinates:"Координаттар",coordinatesMarker:"Маркердин координаттары"}}},ed=d(t2()),eg={_fireDrawStart(t="Draw",e={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},t,e)},_fireDrawEnd(t="Draw",e={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},t,e)},_fireCreate(t,e="Draw",i={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:t,layer:t},e,i)},_fireCenterPlaced(t="Draw",e={}){let i="Draw"===t?this._layer:void 0,r="Draw"!==t?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:i,layer:r,latlng:this._layer.getLatLng()},t,e)},_fireCut(t,e,i,r="Draw",n={}){this.__fire(t,"pm:cut",{shape:this._shape,layer:e,originalLayer:i},r,n)},_fireEdit(t=this._layer,e="Edit",i={}){this.__fire(t,"pm:edit",{layer:this._layer,shape:this.getShape()},e,i)},_fireEnable(t="Edit",e={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},t,e)},_fireDisable(t="Edit",e={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},t,e)},_fireUpdate(t="Edit",e={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},t,e)},_fireMarkerDragStart(t,e,i="Edit",r={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e},i,r)},_fireMarkerDrag(t,e,i="Edit",r={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e},i,r)},_fireMarkerDragEnd(t,e,i,r="Edit",n={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e,intersectionReset:i},r,n)},_fireDragStart(t="Edit",e={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},t,e)},_fireDrag(t,e="Edit",i={}){this.__fire(this._layer,"pm:drag",{...t,shape:this.getShape()},e,i)},_fireDragEnd(t="Edit",e={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},t,e)},_fireDragEnable(t="Edit",e={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},t,e)},_fireDragDisable(t="Edit",e={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},t,e)},_fireRemove(t,e=t,i="Edit",r={}){this.__fire(t,"pm:remove",{layer:e,shape:this.getShape()},i,r)},_fireVertexAdded(t,e,i,r="Edit",n={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:t,indexPath:e,latlng:i,shape:this.getShape()},r,n)},_fireVertexRemoved(t,e,i="Edit",r={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:t,indexPath:e,shape:this.getShape()},i,r)},_fireVertexClick(t,e,i="Edit",r={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:t,indexPath:e,shape:this.getShape()},i,r)},_fireIntersect(t,e=this._layer,i="Edit",r={}){this.__fire(e,"pm:intersect",{layer:this._layer,intersection:t,shape:this.getShape()},i,r)},_fireLayerReset(t,e,i="Edit",r={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:t,indexPath:e,shape:this.getShape()},i,r)},_fireChange(t,e="Edit",i={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:t,shape:this.getShape()},e,i)},_fireTextChange(t,e="Edit",i={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:t,shape:this.getShape()},e,i)},_fireTextFocus(t="Edit",e={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},t,e)},_fireTextBlur(t="Edit",e={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},t,e)},_fireSnapDrag(t,e,i="Snapping",r={}){this.__fire(t,"pm:snapdrag",e,i,r)},_fireSnap(t,e,i="Snapping",r={}){this.__fire(t,"pm:snap",e,i,r)},_fireUnsnap(t,e,i="Snapping",r={}){this.__fire(t,"pm:unsnap",e,i,r)},_fireRotationEnable(t,e,i="Rotation",r={}){this.__fire(t,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},i,r)},_fireRotationDisable(t,e="Rotation",i={}){this.__fire(t,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},e,i)},_fireRotationStart(t,e,i="Rotation",r={}){this.__fire(t,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:e},i,r)},_fireRotation(t,e,i,r=this._rotationLayer,n="Rotation",a={}){this.__fire(t,"pm:rotate",{layer:r,helpLayer:this._layer,startAngle:this._startAngle,angle:r.pm.getAngle(),angleDiff:e,oldLatLngs:i,newLatLngs:r.getLatLngs()},n,a)},_fireRotationEnd(t,e,i,r="Rotation",n={}){this.__fire(t,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:e,angle:this._rotationLayer.pm.getAngle(),originLatLngs:i,newLatLngs:this._rotationLayer.getLatLngs()},r,n)},_fireActionClick(t,e,i,r="Toolbar",n={}){this.__fire(this._map,"pm:actionclick",{text:t.text,action:t,btnName:e,button:i},r,n)},_fireButtonClick(t,e,i="Toolbar",r={}){this.__fire(this._map,"pm:buttonclick",{btnName:t,button:e},i,r)},_fireLangChange(t,e,i,r,n="Global",a={}){this.__fire(this.map,"pm:langchange",{oldLang:t,activeLang:e,fallback:i,translations:r},n,a)},_fireGlobalDragModeToggled(t,e="Global",i={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:t,map:this.map},e,i)},_fireGlobalEditModeToggled(t,e="Global",i={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:t,map:this.map},e,i)},_fireGlobalRemovalModeToggled(t,e="Global",i={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:t,map:this.map},e,i)},_fireGlobalCutModeToggled(t="Global",e={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},t,e)},_fireGlobalDrawModeToggled(t="Global",e={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},t,e)},_fireGlobalRotateModeToggled(t="Global",e={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},t,e)},_fireRemoveLayerGroup(t,e=t,i="Edit",r={}){this.__fire(t,"pm:remove",{layer:e,shape:void 0},i,r)},_fireKeyeventEvent(t,e,i,r="Global",n={}){this.__fire(this.map,"pm:keyevent",{event:t,eventType:e,focusOn:i},r,n)},__fire(t,e,i,r,n={}){i=(0,ed.default)(i,n,{source:r}),L.PM.Utils._fireEvent(t,e,i)}},ef=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(t){this.map=t,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),t.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(t){let e="document";this.map.getContainer().contains(t.target)&&(e="map");let i={event:t,eventType:t.type,focusOn:e};this._lastEvents[t.type]=i,this._lastEvents.current=i,this.map.pm._fireKeyeventEvent(t,t.type,e)},_onBlur(t){t.altKey=!1;let e={event:t,eventType:t.type,focusOn:"document"};this._lastEvents[t.type]=e,this._lastEvents.current=e},getLastKeyEvent(t="current"){return this._lastEvents[t]},isShiftKeyPressed(){return this._lastEvents.current?.event.shiftKey},isAltKeyPressed(){return this._lastEvents.current?.event.altKey},isCtrlKeyPressed(){return this._lastEvents.current?.event.ctrlKey},isMetaKeyPressed(){return this._lastEvents.current?.event.metaKey},getPressedKey(){return this._lastEvents.current?.event.key}}),e_=d(en());function em(t){let e=L.PM.activeLang;return(0,e_.default)(ec[e],t)||(0,e_.default)(ec.en,t)||t}function ey(t){for(let e=0;e<t.length;e+=1){let i=t[e];if(Array.isArray(i)){if(ey(i))return!0}else if(null!=i&&""!==i)return!0}return!1}function eL(t){return t.reduce((t,e)=>{if(0!==e.length){let i=Array.isArray(e)?eL(e):e;Array.isArray(i)?0!==i.length&&t.push(i):t.push(i)}return t},[])}function eb(t,e,i,r,n=!0){let a,s,o=[];for(let l=0;l<i;l+=1){if(n)a=function(t,e,i){let{a:r,b:n,f:a}={a:L.CRS.Earth.R,b:6356752.3142,f:.0033528106647474805},s=t.lng,o=t.lat,l=Math.PI,h=e*l/180,p=Math.sin(h),u=Math.cos(h),c=(1-a)*Math.tan(o*l/180),d=1/Math.sqrt(1+c*c),g=c*d,f=Math.atan2(c,u),_=d*p,m=1-_*_,y=m*(r*r-n*n)/(n*n),b=1+y/16384*(4096+y*(-768+y*(320-175*y))),k=y/1024*(256+y*(-128+y*(74-47*y))),M=i/(n*b),v=2*Math.PI,x,C,w;for(;Math.abs(M-v)>1e-12;){x=Math.cos(2*f+M);let t=k*(C=Math.sin(M))*(x+k/4*((w=Math.cos(M))*(-1+2*x*x)-k/6*x*(-3+4*C*C)*(-3+4*x*x)));v=M,M=i/(n*b)+t}let P=g*C-d*w*u,E=Math.atan2(g*w+d*C*u,(1-a)*Math.sqrt(_*_+P*P)),S=a/16*m*(4+a*(4-3*m)),B=Math.atan2(C*p,d*w-g*C*u)-(1-S)*a*_*(M+S*C*(x+S*w*(-1+2*x*x)));return L.latLng(s+180*B/l,180*E/l)}(t,360*l/i+r,e),s=L.latLng(a.lng,a.lat);else{let r=t.lat+Math.cos(2*l*Math.PI/i)*e,n=t.lng+Math.sin(2*l*Math.PI/i)*e;s=L.latLng(r,n)}o.push(s)}return o}function ek(t,e,i){let r=t.latLngToContainerPoint(e),n=t.latLngToContainerPoint(i),a=180*Math.atan2(n.y-r.y,n.x-r.x)/Math.PI+90;return a+360*(a<0)}function eM(t,e,i,r){let n=ek(t,e,i);return function(t,e,i){e=(e+360)%360;let r=Math.PI/180,n=180/Math.PI,{R:a}=L.CRS.Earth,s=t.lng*r,o=t.lat*r,l=e*r,h=Math.sin(o),p=Math.cos(o),u=Math.cos(i/a),c=Math.sin(i/a),d=Math.asin(h*u+p*c*Math.cos(l)),g=s+Math.atan2(Math.sin(l)*c*p,u-h*Math.sin(d)),f=(g*=n)-360,_=g<-180?g+360:g;return g=g>180?f:_,L.latLng([d*n,g])}(e,n,r)}function ev(t,e=t.getLatLngs()){return t instanceof L.Polygon?L.polygon(e).getLatLngs():L.polyline(e).getLatLngs()}function ex(t,e){if(e.options.crs?.projection?.MAX_LATITUDE){let i=e.options.crs?.projection?.MAX_LATITUDE;t.lat=Math.max(Math.min(i,t.lat),-i)}return t}function eC(t){return t.options.renderer||t._map&&(t._map._getPaneRenderer(t.options.pane)||t._map.options.renderer||t._map._renderer)||t._renderer}var ew=L.Class.extend({includes:[{_globalEditModeEnabled:!1,enableGlobalEditMode(t){let e={...t};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(t=>{this._isRelevantForEdit(t)&&t.pm.enable(e)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(t=>{t.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(t=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(t)},handleLayerAdditionInGlobalEditMode(){let t=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let e in t){let i=t[e];this._isRelevantForEdit(i)&&i.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:t}){this._addedLayersEdit[L.stamp(t)]=t},_isRelevantForEdit:t=>t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.allowEditing},{_globalDragModeEnabled:!1,enableGlobalDragMode(){let t=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},t.forEach(t=>{this._isRelevantForDrag(t)&&t.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let t=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,t.forEach(t=>{t.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let t=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let e in t){let i=t[e];this._isRelevantForDrag(i)&&i.pm.enableLayerDrag()}},_layerAddedDrag({layer:t}){this._addedLayersDrag[L.stamp(t)]=t},_isRelevantForDrag:t=>t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.draggable},{_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(t=>{this._isRelevantForRemoval(t)&&(t.pm.enabled()&&t.pm.disable(),t.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(t=>{t.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(t){let e=t.target;this._isRelevantForRemoval(e)&&!e.pm.dragging()&&(e.removeFrom(this.map.pm._getContainingLayer()),e.remove(),e instanceof L.LayerGroup?(this._fireRemoveLayerGroup(e),this._fireRemoveLayerGroup(this.map,e)):(e.pm._fireRemove(e),e.pm._fireRemove(this.map,e)))},_isRelevantForRemoval:t=>t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.allowRemoval,handleLayerAdditionInGlobalRemovalMode(){let t=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let e in t){let i=t[e];this._isRelevantForRemoval(i)&&(i.pm.enabled()&&i.pm.disable(),i.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:t}){this._addedLayersRemoval[L.stamp(t)]=t}},{_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(t=>t instanceof L.Polyline).forEach(t=>{this._isRelevantForRotate(t)&&t.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(t=>t instanceof L.Polyline).forEach(t=>{t.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate:t=>t.pm&&t instanceof L.Polyline&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.allowRotation,handleLayerAdditionInGlobalRotateMode(){let t=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let e in t){let i=t[e];this._isRelevantForRemoval(i)&&i.pm.enableRotate()}},_layerAddedRotate({layer:t}){this._addedLayersRotate[L.stamp(t)]=t}},eg],initialize(t){this.map=t,this.Draw=new L.PM.Draw(t),this.Toolbar=new L.PM.Toolbar(t),this.Keyboard=ef(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(t)},setLang(t="en",e,i="en"){if(t=t.trim().toLowerCase(),!/^[a-z]{2}$/.test(t)){let e=t.replace(/[-_\s]/g,"-").replace(/^(\w{2})$/,"$1-").match(/([a-z]{2})-?([a-z]{2})?/);if(e){for(let i of[`${e[1]}_${e[2]}`,`${e[1]}`])if(ec[i]){t=i;break}}}let r=L.PM.activeLang;e&&(ec[t]=(0,ep.default)(ec[i],e)),L.PM.activeLang=t,this.map.pm.Toolbar.reinit(),this._fireLangChange(r,t,i,ec[t])},addControls(t){this.Toolbar.addControls(t)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(t="Polygon",e){"Poly"===t&&(t="Polygon"),this.Draw.enable(t,e)},disableDraw(t="Polygon"){"Poly"===t&&(t="Polygon"),this.Draw.disable(t)},setPathOptions(t,e={}){let i=e.ignoreShapes||[],r=e.merge||!1;this.map.pm.Draw.shapes.forEach(e=>{-1===i.indexOf(e)&&this.map.pm.Draw[e].setPathOptions(t,r)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(t){let e=(0,ep.default)(this.globalOptions,t);e.editable&&(e.resizeableCircleMarker=e.editable,delete e.editable);let i=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!e.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),i=!0);let r=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizeableCircle!=!!e.resizeableCircle&&(this.map.pm.Draw.Circle.disable(),r=!0),this.map.pm.Draw.shapes.forEach(t=>{this.map.pm.Draw[t].setOptions(e)}),i&&this.map.pm.Draw.CircleMarker.enable(),r&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(t=>{t.pm.setOptions(e)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=e,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(t=>{t.pm.enabled()&&t.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(t){return this.Draw.Cut.enable(t)},toggleGlobalCutMode(t){return this.Draw.Cut.toggle(t)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(t=!1){let e=L.PM.Utils.findLayers(this.map);if(!t)return e;let i=L.featureGroup();return i._pmTempLayer=!0,e.forEach(t=>{i.addLayer(t)}),i},getGeomanDrawLayers(t=!1){let e=L.PM.Utils.findLayers(this.map).filter(t=>!0===t._drawnByGeoman);if(!t)return e;let i=L.featureGroup();return i._pmTempLayer=!0,e.forEach(t=>{i.addLayer(t)}),i},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(t){0===this._touchEventCounter&&(L.DomEvent.on(t,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(t,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(t){1===this._touchEventCounter&&(L.DomEvent.off(t,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(t,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(t){eC(this.map)._onMouseMove(this._createMouseEvent("mousemove",t))},_canvasTouchClick(t){let e="";"touchstart"===t.type||"pointerdown"===t.type?e="mousedown":("touchend"===t.type||"pointerup"===t.type||"touchcancel"===t.type||"pointercancel"===t.type)&&(e="mouseup"),e&&eC(this.map)._onClick(this._createMouseEvent(e,t))},_createMouseEvent(t,e){let i,r=e.touches[0]||e.changedTouches[0];try{i=new MouseEvent(t,{bubbles:e.bubbles,cancelable:e.cancelable,view:e.view,detail:r.detail,screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,button:e.button,relatedTarget:e.relatedTarget})}catch{(i=document.createEvent("MouseEvents")).initMouseEvent(t,e.bubbles,e.cancelable,e.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}return i}}),eP=L.Control.extend({includes:[eg],options:{position:"topleft",disableByOtherButtons:!0},initialize(t){this._button=L.Util.extend({},this.options,t)},onAdd(t){return this._map=t,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):"edit"===this._button.tool?this._container=this._map.pm.Toolbar.editContainer:"options"===this._button.tool?this._container=this._map.pm.Toolbar.optionsContainer:"custom"===this._button.tool?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let t=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),t?t.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(t){return"boolean"==typeof t?this._button.toggleStatus=t:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._updateActiveAction(this._button),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled(),this._updateActiveAction(this._button)},_triggerClick(t){t&&t.preventDefault(),this._button.disabled||(this._button.onClick(t,{button:this,event:t}),this._clicked(t),this._button.afterClick(t,{button:this,event:t}))},_makeButton(t){let e=this.options.position.indexOf("right")>-1?"pos-right":"",i=L.DomUtil.create("div",`button-container  ${e}`,this._container);t.title&&i.setAttribute("title",t.title);let r=L.DomUtil.create("a","leaflet-buttons-control-button",i);r.setAttribute("role","button"),r.setAttribute("tabindex","0"),r.href="#";let n=L.DomUtil.create("div",`leaflet-pm-actions-container ${e}`,i),a=t.actions,s={cancel:{text:em("actions.cancel"),title:em("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:em("actions.finish"),title:em("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:em("actions.removeLastVertex"),title:em("actions.removeLastVertex"),onClick(){this._map.pm.Draw[t.jsClass]._removeLastVertex()}},finish:{text:em("actions.finish"),title:em("actions.finish"),onClick(e){this._map.pm.Draw[t.jsClass]._finishShape(e)}}};t._preparedActions=a.map(i=>{let r="string"==typeof i?i:i.name,a;if(s[r])a=s[r];else{if(!i.text)return a;a=i}let o=L.DomUtil.create("a",`leaflet-pm-action ${e} action-${r}`,n);return o.setAttribute("role","button"),o.setAttribute("tabindex","0"),o.href="#",a.title&&(o.title=a.title),o.innerHTML=a.text,L.DomEvent.disableClickPropagation(o),L.DomEvent.on(o,"click",L.DomEvent.stop),a._node=o,!t.disabled&&a.onClick&&(L.DomEvent.addListener(o,"click",e=>{e.preventDefault();let i="",{buttons:r}=this._map.pm.Toolbar;for(let e in r)if(r[e]._button===t){i=e;break}this._fireActionClick(a,i,t)},this),L.DomEvent.addListener(o,"click",a.onClick,this),L.DomEvent.addListener(o,"click",()=>this._updateActiveAction(t))),a}),this._updateActiveAction(t),t.toggleStatus&&L.DomUtil.addClass(i,"active");let o=L.DomUtil.create("div","control-icon",r);return t.iconUrl&&o.setAttribute("src",t.iconUrl),t.className&&L.DomUtil.addClass(o,t.className),L.DomEvent.disableClickPropagation(r),L.DomEvent.on(r,"click",L.DomEvent.stop),t.disabled||(L.DomEvent.addListener(r,"click",this._onBtnClick,this),L.DomEvent.addListener(r,"click",this._triggerClick,this)),t.disabled&&(L.DomUtil.addClass(r,"pm-disabled"),r.setAttribute("aria-disabled","true")),i},_applyStyleClasses(){this._container&&(this._button.toggleStatus&&!1!==this._button.cssToggle?(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")):(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let t="",{buttons:e}=this._map.pm.Toolbar;for(let i in e)if(e[i]._button===this._button){t=i;break}this._fireButtonClick(t,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let t="pm-disabled",e=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(e,t),e.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(e,t),e.setAttribute("aria-disabled","false"))},_updateActiveAction(t){t._preparedActions?.forEach(t=>{t?._node&&(t.isActive&&t.isActive.call(this)?L.DomUtil.addClass(t._node,"active-action"):L.DomUtil.removeClass(t._node,"active-action"))})}});L.Control.PMButton=eP;var eE=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(t){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(t)},reinit(){let t=this.isVisible;this.removeControls(),this._defineButtons(),t&&this.addControls()},init(t){this.map=t,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(t){let e=`${t}Container`;return this[e]||(this[e]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${t} leaflet-bar leaflet-control`)),this[e]},getButtons(){return this.buttons},addControls(t=this.options){"u">typeof t.editPolygon&&(t.editMode=t.editPolygon),"u">typeof t.deleteLayer&&(t.removalMode=t.deleteLayer),L.Util.setOptions(this,t),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let t=this.getButtons(),e={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let i in t){let r=t[i];L.Util.setOptions(r,{className:e.geomanIcons[i]})}},removeControls(){let t=this.getButtons();for(let e in t)t[e].remove();this.isVisible=!1},toggleControls(t=this.options){this.isVisible?this.removeControls():this.addControls(t)},_addButton(t,e){return this.buttons[t]=e,this.options[t]=!!this.options[t],this.buttons[t]},triggerClickOnToggledButtons(t){for(let e in this.buttons){let i=this.buttons[e];i._button.disableByOtherButtons&&i!==t&&i.toggled()&&i._triggerClick()}},toggleButton(t,e,i=!0){"editPolygon"===t&&(t="editMode"),"deleteLayer"===t&&(t="removalMode");let r=t;return i&&this.triggerClickOnToggledButtons(this.buttons[r]),!!this.buttons[r]&&this.buttons[r].toggle(e)},_defineButtons(){let t={className:"control-icon leaflet-pm-icon-marker",title:em("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},e={title:em("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},i={className:"control-icon leaflet-pm-icon-polyline",title:em("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},r={title:em("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},n={title:em("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},a={title:em("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},s={title:em("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},o={title:em("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},l={title:em("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},h={title:em("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},p={title:em("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},u={className:"control-icon leaflet-pm-icon-text",title:em("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(t)),this._addButton("drawPolyline",new L.Control.PMButton(i)),this._addButton("drawRectangle",new L.Control.PMButton(a)),this._addButton("drawPolygon",new L.Control.PMButton(e)),this._addButton("drawCircle",new L.Control.PMButton(r)),this._addButton("drawCircleMarker",new L.Control.PMButton(n)),this._addButton("drawText",new L.Control.PMButton(u)),this._addButton("editMode",new L.Control.PMButton(s)),this._addButton("dragMode",new L.Control.PMButton(o)),this._addButton("cutPolygon",new L.Control.PMButton(l)),this._addButton("removalMode",new L.Control.PMButton(h)),this._addButton("rotateMode",new L.Control.PMButton(p))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let t=this.getButtons(),e=[];for(let i in!1===this.options.drawControls&&(e=e.concat(Object.keys(t).filter(e=>!t[e]._button.tool))),!1===this.options.editControls&&(e=e.concat(Object.keys(t).filter(e=>"edit"===t[e]._button.tool))),!1===this.options.optionsControls&&(e=e.concat(Object.keys(t).filter(e=>"options"===t[e]._button.tool))),!1===this.options.customControls&&(e=e.concat(Object.keys(t).filter(e=>"custom"===t[e]._button.tool))),t)if(this.options[i]&&-1===e.indexOf(i)){let e=t[i]._button.tool;e||(e="draw"),t[i].setPosition(this._getBtnPosition(e)),t[i].addTo(this.map)}},_getBtnPosition(t){return this.options.positions&&this.options.positions[t]?this.options.positions[t]:this.options.position},setBlockPosition(t,e){this.options.positions[t]=e,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(t,e){if(e)"object"!=typeof e&&(e={name:e});else throw TypeError("Button has no name");let i=this._btnNameMapping(t);if(!e.name)throw TypeError("Button has no name");if(this.buttons[e.name])throw TypeError("Button with this name already exists");let r=this.map.pm.Draw.createNewDrawInstance(e.name,i);return e={...this.buttons[i]._button,...e},{drawInstance:r,control:this.createCustomControl(e)}},createCustomControl(t){if(!t.name)throw TypeError("Button has no name");if(this.buttons[t.name])throw TypeError("Button with this name already exists");t.onClick||(t.onClick=()=>{}),t.afterClick||(t.afterClick=()=>{}),!1!==t.toggle&&(t.toggle=!0),t.block&&(t.block=t.block.toLowerCase()),t.block&&"draw"!==t.block||(t.block=""),t.className?-1===t.className.indexOf("control-icon")&&(t.className=`control-icon ${t.className}`):t.className="control-icon";let e={tool:t.block,className:t.className,title:t.title||"",jsClass:t.name,onClick:t.onClick,afterClick:t.afterClick,doToggle:t.toggle,toggleStatus:!1,disableOtherButtons:t.disableOtherButtons??!0,disableByOtherButtons:t.disableByOtherButtons??!0,cssToggle:t.toggle,position:this.options.position,actions:t.actions||[],disabled:!!t.disabled};!1!==this.options[t.name]&&(this.options[t.name]=!0);let i=this._addButton(t.name,new L.Control.PMButton(e));return this.changeControlOrder(),i},controlExists(t){return!!this.getButton(t)},getButton(t){return this.getButtons()[t]},getButtonsInBlock(t){let e={};if(t)for(let i in this.getButtons()){let r=this.getButtons()[i];r._button.tool!==t&&("draw"!==t||r._button.tool)||(e[i]=r)}return e},changeControlOrder(t=[]){let e=this._shapeMapping(),i=[];t.forEach(t=>{e[t]?i.push(e[t]):i.push(t)});let r=this.getButtons(),n={};i.forEach(t=>{r[t]&&(n[t]=r[t])}),Object.keys(r).filter(t=>!r[t]._button.tool||"draw"===r[t]._button.tool).forEach(t=>{-1===i.indexOf(t)&&(n[t]=r[t])}),Object.keys(r).filter(t=>"edit"===r[t]._button.tool).forEach(t=>{-1===i.indexOf(t)&&(n[t]=r[t])}),Object.keys(r).filter(t=>"options"===r[t]._button.tool).forEach(t=>{-1===i.indexOf(t)&&(n[t]=r[t])}),Object.keys(r).filter(t=>"custom"===r[t]._button.tool).forEach(t=>{-1===i.indexOf(t)&&(n[t]=r[t])}),Object.keys(r).forEach(t=>{-1===i.indexOf(t)&&(n[t]=r[t])}),this.map.pm.Toolbar.buttons=n,this._showHideButtons()},getControlOrder(){let t=this.getButtons(),e=[];for(let i in t)e.push(i);return e},changeActionsOfControl(t,e){let i=this._btnNameMapping(t);if(!i)throw TypeError("No name passed");if(!e)throw TypeError("No actions passed");if(!this.buttons[i])throw TypeError("Button with this name not exists");this.buttons[i]._button.actions=e,this.changeControlOrder()},setButtonDisabled(t,e){let i=this._btnNameMapping(t);e?this.buttons[i].disable():this.buttons[i].enable()},_shapeMapping:()=>({Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}),_btnNameMapping(t){let e=this._shapeMapping();return e[t]?e[t]:t}}),eS=d(t2()),eB={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(t){t.forEach(t=>{if(Array.isArray(t)){this._assignEvents(t);return}t.off("drag",this._handleSnapping,this),t.on("drag",this._handleSnapping,this),t.off("dragend",this._cleanupSnapping,this),t.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(t){t&&(t.target._snapped=!1),delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(t=>{t.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(t){let e,i=t.target;if(i._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),t?.originalEvent?.altKey||this._map?.pm?.Keyboard.isAltKeyPressed()||(void 0===this._snapList&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let r=this._calcClosestLayer(i.getLatLng(),this._snapList);if(0===Object.keys(r).length)return!1;e=r.layer instanceof L.Marker||r.layer instanceof L.CircleMarker||!this.options.snapSegment?r.latlng:this._checkPrioritiySnapping(r);let n=this.options.snapDistance,a={marker:i,shape:this._shape,snapLatLng:e,segment:r.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:r.layer,distance:r.distance};if(this._fireSnapDrag(a.marker,a),this._fireSnapDrag(this._layer,a),r.distance<n){i._orgLatLng=i.getLatLng(),i.setLatLng(e),i._snapped=!0,i._snapInfo=a;let t=this._snapLatLng||{},r=e||{};(t.lat!==r.lat||t.lng!==r.lng)&&(()=>{this._snapLatLng=e,this._fireSnap(i,a),this._fireSnap(this._layer,a)})()}else this._snapLatLng&&(this._unsnap(a),i._snapped=!1,i._snapInfo=void 0,this._fireUnsnap(a.marker,a),this._fireUnsnap(this._layer,a));return!0},_createSnapList(){let t=[],e=[],i=this._map;i.off("layerremove",this._handleSnapLayerRemoval,this),i.on("layerremove",this._handleSnapLayerRemoval,this),i.eachLayer(i=>{if((i instanceof L.Polyline||i instanceof L.Marker||i instanceof L.CircleMarker||i instanceof L.ImageOverlay)&&!0!==i.options.snapIgnore){if(void 0===i.options.snapIgnore&&(!L.PM.optIn&&!0===i.options.pmIgnore||L.PM.optIn&&!1!==i.options.pmIgnore))return;(i instanceof L.Circle||i instanceof L.CircleMarker)&&i.pm&&i.pm._hiddenPolyCircle?t.push(i.pm._hiddenPolyCircle):i instanceof L.ImageOverlay&&(i=L.rectangle(i.getBounds())),t.push(i);let r=L.polyline([],{color:"red",pmIgnore:!0});r._pmTempLayer=!0,e.push(r),(i instanceof L.Circle||i instanceof L.CircleMarker)&&e.push(r)}}),t=(t=(t=t.filter(t=>this._layer!==t)).filter(t=>t._latlng||t._latlngs&&ey(t._latlngs))).filter(t=>!t._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let t=L.polyline([],{color:"red",pmIgnore:!0});t._pmTempLayer=!0,e.push(t)}),this._snapList=t.concat(this._otherSnapLayers)):this._snapList=t,this.debugIndicatorLines=e},_handleSnapLayerRemoval({layer:t}){if(!t._leaflet_id)return;let e=this._snapList.findIndex(e=>e._leaflet_id===t._leaflet_id);e>-1&&this._snapList.splice(e,1)},_calcClosestLayer(t,e){return this._calcClosestLayers(t,e,1)[0]},_calcClosestLayers(t,e,i=1){let r=[],n={};e.forEach((e,a)=>{if(e._parentCopy&&e._parentCopy===this._layer||e.getLatLngs?.().flat(5).length<2)return;let s=this._calcLayerDistances(t,e);if(s.distance=Math.floor(s.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[a]){let t=L.polyline([],{color:"red",pmIgnore:!0});t._pmTempLayer=!0,this.debugIndicatorLines[a]=t}this.debugIndicatorLines[a].setLatLngs([t,s.latlng])}1===i&&(void 0===n.distance||s.distance-5<=n.distance)?(s.distance+5<n.distance&&(r=[]),(n=s).layer=e,r.push(n)):1!==i&&(n={},(n=s).layer=e,r.push(n))}),1!==i&&(r=r.sort((t,e)=>t.distance-e.distance)),-1===i&&(i=r.length);let a=this._getClosestLayerByPriority(r,i);return L.Util.isArray(a)?a:[a]},_calcLayerDistances(t,e){let i=this._map,r=e instanceof L.Marker||e instanceof L.CircleMarker,n=e instanceof L.Polygon;if(r){let r=e.getLatLng();return{latlng:{...r},distance:this._getDistance(i,r,t)}}return this._calcLatLngDistances(t,e.getLatLngs(),i,n)},_calcLatLngDistances(t,e,i,r=!1){let n,a,s,o=e=>{e.forEach((l,h)=>{if(Array.isArray(l)){o(l);return}if(this.options.snapSegment){let n;n=r?h+1===e.length?0:h+1:h+1===e.length?void 0:h+1;let o=e[n];if(o){let e=this._getDistanceToSegment(i,t,l,o);(void 0===a||e<a)&&(a=e,s=[l,o])}}else{let e=this._getDistance(i,t,l);(void 0===a||e<a)&&(a=e,n=l)}})};return o(e),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(i,t,s[0],s[1])},segment:s,distance:a}:{latlng:n,distance:a}},_getClosestLayerByPriority(t,e=1){t=t.sort((t,e)=>t._leaflet_id-e._leaflet_id);let i=this._map.pm.globalOptions.snappingOrder||[],r=0,n={};return i.concat(["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"]).forEach(t=>{n[t]||(r+=1,n[t]=r)}),t.sort(function(t,e,i="asc"){if(!e||0===Object.keys(e).length)return(t,e)=>t-e;let r=Object.keys(e),n,a=r.length-1,s={};for(;a>=0;)s[(n=r[a]).toLowerCase()]=e[n],a-=1;function o(t){return t instanceof L.Marker?"Marker":t instanceof L.Circle?"Circle":t instanceof L.CircleMarker?"CircleMarker":t instanceof L.Rectangle?"Rectangle":t instanceof L.Polygon?"Polygon":t instanceof L.Polyline?"Line":void 0}return(e,r)=>{let n,a;if("instanceofShape"===t){if(n=o(e.layer).toLowerCase(),a=o(r.layer).toLowerCase(),!n||!a)return 0}else{if(!e.hasOwnProperty(t)||!r.hasOwnProperty(t))return 0;n=e[t].toLowerCase(),a=r[t].toLowerCase()}let l=n in s?s[n]:Number.MAX_SAFE_INTEGER,h=a in s?s[a]:Number.MAX_SAFE_INTEGER,p=0;return l<h?p=-1:l>h&&(p=1),"desc"===i?-1*p:p}}("instanceofShape",n)),1===e?t[0]||{}:t.slice(0,e)},_checkPrioritiySnapping(t){let e=this._map,i=t.segment[0],r=t.segment[1],n=t.latlng,a=n;if(this.options.snapVertex){let t=this._getDistance(e,i,n),s=this._getDistance(e,r,n),o=t<s?i:r,l=t<s?t:s;if(this.options.snapMiddle){let a=L.PM.Utils.calcMiddleLatLng(e,i,r),h=this._getDistance(e,a,n);h<t&&h<s&&(o=a,l=h)}l<this.options.snapDistance&&(a=o)}return{...a}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(t,e,i,r){let n=t.getMaxZoom();n===1/0&&(n=t.getZoom());let a=t.project(e,n),s=t.project(i,n),o=t.project(r,n),l=L.LineUtil.closestPointOnSegment(a,s,o);return t.unproject(l,n)},_getDistanceToSegment(t,e,i,r){let n=t.latLngToContainerPoint(e),a=t.latLngToContainerPoint(i),s=t.latLngToContainerPoint(r);return L.LineUtil.pointToSegmentDistance(n,a,s)},_getDistance:(t,e,i)=>t.latLngToContainerPoint(e).distanceTo(t.latLngToContainerPoint(i))},eR=L.Class.extend({includes:[eB,eg],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizeableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0,textOptions:{text:null,focusAfterDraw:null,removeIfEmpty:null,className:null},snapVertex:!0},setOptions(t){L.Util.setOptions(this,t),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(t){let e=new L.Icon.Default;e.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=e,this._map=t,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(t=>{this[t]=new L.PM.Draw[t](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(t,e=!1){e?this.options.pathOptions=(0,eS.default)(this.options.pathOptions,t):this.options.pathOptions=t},getShapes(){return this.shapes},getShape(){return this._shape},enable(t,e){if(!t)throw Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[t].enable(e)},disable(){this.shapes.forEach(t=>{this[t].disable()})},addControls(){this.shapes.forEach(t=>{this[t].addButton()})},getActiveShape(){let t;return this.shapes.forEach(e=>{this[e]._enabled&&(t=e)}),t},_setGlobalDrawMode(){"Cut"===this._shape?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let t=[];this._map.eachLayer(e=>{(e instanceof L.Polyline||e instanceof L.Marker||e instanceof L.Circle||e instanceof L.CircleMarker||e instanceof L.ImageOverlay)&&(e._pmTempLayer||t.push(e))}),this._enabled?t.forEach(t=>{L.PM.Utils.disablePopup(t)}):t.forEach(t=>{L.PM.Utils.enablePopup(t)})},createNewDrawInstance(t,e){let i=this._getShapeFromBtnName(e);if(this[t])throw TypeError("Draw Type already exists");if(!L.PM.Draw[i])throw TypeError(`There is no class L.PM.Draw.${i}`);return this[t]=new L.PM.Draw[i](this._map),this[t].toolbarButtonName=t,this[t]._shape=t,this.shapes.push(t),this[e]&&this[t].setOptions(this[e].options),this[t].setOptions(this[t].options),this[t]},_getShapeFromBtnName(t){let e={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return e[t]?e[t]:this[t]?this[t]._shape:t},_finishLayer(t){t.pm&&(t.pm.setOptions(this.options),t.pm._shape=this._shape,t.pm._map=this._map),this._addDrawnLayerProp(t)},_addDrawnLayerProp(t){t._drawnByGeoman=!0},_setPane(t,e){"layerPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":"vertexPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":"markerPane"===e&&(t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return 0===(this._map||this._layer._map).pm.getGeomanLayers().length}});eR.Marker=eR.extend({initialize(t){this._map=t,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(t){L.Util.setOptions(this,t),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(em("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(t=>{this.isRelevantMarker(t)&&t.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(t=>{this.isRelevantMarker(t)&&t.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},isRelevantMarker:t=>t instanceof L.Marker&&t.pm&&!t._pmTempLayer&&!t.pm._initTextMarker,_syncHintMarker(t){this._hintMarker.setLatLng(t.latlng),this.options.snappable&&(t.target=this._hintMarker,this._handleSnapping(t)),this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(t){if(!t.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=new L.Marker(e,this.options.markerStyle);this._setPane(i,"markerPane"),this._finishLayer(i),i.pm||(i.options.draggable=!1),i.addTo(this._map.pm._getContainingLayer()),i.pm&&this.options.markerEditable?i.pm.enable():i.dragging&&i.dragging.disable(),this._fireCreate(i),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){this.options.markerStyle?.icon&&this._hintMarker?.setIcon(this.options.markerStyle.icon)}});var eT={centimeters:0x25f96350,centimetres:0x25f96350,degrees:57.22891354143274,feet:20902260.511392,inches:250826616.45599997,kilometers:6371.0088,kilometres:6371.0088,meters:6371008.8,metres:6371008.8,miles:3958.761333810546,millimeters:0x17bbde120,millimetres:0x17bbde120,nauticalmiles:6371008.8/1852,radians:1,yards:6967335.223679999};function eD(t,e,i){void 0===i&&(i={});var r={type:"Feature"};return(0===i.id||i.id)&&(r.id=i.id),i.bbox&&(r.bbox=i.bbox),r.properties=e||{},r.geometry=t,r}function eO(t,e,i){if(void 0===i&&(i={}),!t)throw Error("coordinates is required");if(!Array.isArray(t))throw Error("coordinates must be an Array");if(t.length<2)throw Error("coordinates must be at least 2 numbers long");if(!eN(t[0])||!eN(t[1]))throw Error("coordinates must contain numbers");return eD({type:"Point",coordinates:t},e,i)}function eI(t,e,i){if(void 0===i&&(i={}),t.length<2)throw Error("coordinates must be an array of two or more positions");return eD({type:"LineString",coordinates:t},e,i)}function eA(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function eG(t){return t%(2*Math.PI)*180/Math.PI}function ej(t){return t%360*Math.PI/180}function eN(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function ez(t){var e,i,r={type:"FeatureCollection",features:[]};if("LineString"===(i="Feature"===t.type?t.geometry:t).type)e=[i.coordinates];else if("MultiLineString"===i.type)e=i.coordinates;else if("MultiPolygon"===i.type)e=[].concat.apply([],i.coordinates);else if("Polygon"===i.type)e=i.coordinates;else throw Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return e.forEach(function(t){e.forEach(function(e){for(var i=0;i<t.length-1;i++)for(var n=i;n<e.length-1;n++)if(t!==e||1!==Math.abs(i-n)&&(0!==i||n!==t.length-2||t[i][0]!==t[t.length-1][0]||t[i][1]!==t[t.length-1][1])){var a=function(t,e,i,r,n,a,s,o){var l,h,p,u,c,d={x:null,y:null,onLine1:!1,onLine2:!1};return 0==(l=(o-a)*(i-t)-(s-n)*(r-e))?null!==d.x&&null!==d.y&&d:(h=e-a,p=t-n,u=(s-n)*h-(o-a)*p,c=(i-t)*h-(r-e)*p,h=u/l,p=c/l,d.x=t+h*(i-t),d.y=e+h*(r-e),h>=0&&h<=1&&(d.onLine1=!0),p>=0&&p<=1&&(d.onLine2=!0),!!d.onLine1&&!!d.onLine2&&[d.x,d.y])}(t[i][0],t[i][1],t[i+1][0],t[i+1][1],e[n][0],e[n][1],e[n+1][0],e[n+1][1]);a&&r.features.push(eO([a[0],a[1]]))}})}),r}function eF(t){if(!t)throw Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw Error("coord must be GeoJSON Point or an Array of numbers")}function eU(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function eV(t){return"Feature"===t.type?t.geometry:t}function eK(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}function eq(t,e,i){if(null!==t)for(var r,n,a,s,o,l,h,p,u=0,c=0,d=t.type,g="FeatureCollection"===d,f="Feature"===d,_=g?t.features.length:1,m=0;m<_;m++){o=(p=!!(h=g?t.features[m].geometry:f?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var y=0;y<o;y++){var b=0,k=0;if(null!==(s=p?h.geometries[y]:h)){l=s.coordinates;var M=s.type;switch(u=i&&("Polygon"===M||"MultiPolygon"===M)?1:0,M){case null:break;case"Point":if(!1===e(l,c,m,b,k))return!1;c++,b++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(!1===e(l[r],c,m,b,k))return!1;c++,"MultiPoint"===M&&b++}"LineString"===M&&b++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(n=0;n<l[r].length-u;n++){if(!1===e(l[r][n],c,m,b,k))return!1;c++}"MultiLineString"===M&&b++,"Polygon"===M&&k++}"Polygon"===M&&b++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(k=0,n=0;n<l[r].length;n++){for(a=0;a<l[r][n].length-u;a++){if(!1===e(l[r][n][a],c,m,b,k))return!1;c++}k++}b++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===eq(s.geometries[r],e,i))return!1;break;default:throw Error("Unknown Geometry Type")}}}}}function eH(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function eY(t,e){!function(t,e){var i,r,n,a,s,o,l,h,p,u,c=0,d="FeatureCollection"===t.type,g="Feature"===t.type,f=d?t.features.length:1;for(i=0;i<f;i++){for(o=d?t.features[i].geometry:g?t.geometry:t,h=d?t.features[i].properties:g?t.properties:{},p=d?t.features[i].bbox:g?t.bbox:void 0,u=d?t.features[i].id:g?t.id:void 0,s=(l=!!o&&"GeometryCollection"===o.type)?o.geometries.length:1,n=0;n<s;n++){if(null===(a=l?o.geometries[n]:o)){if(!1===e(null,c,h,p,u))return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(a,c,h,p,u))return!1;break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===e(a.geometries[r],c,h,p,u))return!1;break;default:throw Error("Unknown Geometry Type")}}c++}}(t,function(t,i,r,n,a){var s,o=null===t?null:t.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return!1!==e(eD(t,r,{bbox:n,id:a}),i,0)&&void 0}switch(o){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<t.coordinates.length;l++)if(!1===e(eD({type:s,coordinates:t.coordinates[l]},r),i,l))return!1})}eR.Line=eR.extend({initialize(t){this._map=t,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(t){L.Util.setOptions(this,t),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(em("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&"snap"!==this.options.finishOn&&this._map.on(this.options.finishOn,this._finishShape,this),"dblclick"===this.options.finishOn&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&"snap"!==this.options.finishOn&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine(){let t=this._layer.getLatLngs();if(t.length>0){let e=t[t.length-1];this._hintline.setLatLngs([e,this._hintMarker.getLatLng()])}},_syncHintMarker(t){this._hintMarker.setLatLng(t.latlng),this.options.snappable&&(t.target=this._hintMarker,this._handleSnapping(t)),this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let e=this._layer._defaultShape().slice();e.push(this._hintMarker.getLatLng()),this._change(e)},hasSelfIntersection(){return ez(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(t,e){let i=L.polyline(this._layer.getLatLngs());t&&(e||(e=this._hintMarker.getLatLng()),i.addLatLng(e));let r=ez(i.toGeoJSON(15));this._doesSelfIntersect=r.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(r,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(t){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,t.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=this._layer.getLatLngs(),r=i[i.length-1];if(e.equals(i[0])||i.length>0&&e.equals(r)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:e,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(e);let n=this._createMarker(e);this._setTooltipText(),this._setHintLineAfterNewVertex(e),this._fireVertexAdded(n,void 0,e,"Draw"),this._change(this._layer.getLatLngs()),"snap"===this.options.finishOn&&this._hintMarker._snapped&&this._finishShape(t)},_setHintLineAfterNewVertex(t){this._hintline.setLatLngs([t,t])},_removeLastVertex(){let t=this._markers;if(t.length<=1){this.disable();return}let e=this._layer.getLatLngs(),i=t[t.length-1],{indexPath:r}=L.PM.Utils.findDeepMarkerIndex(t,i);t.pop(),this._layerGroup.removeLayer(i);let n=t[t.length-1],a=e.indexOf(n.getLatLng());e=e.slice(0,a+1),this._layer.setLatLngs(e),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(i,r,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let t=this._layer.getLatLngs();if(t.length<=1)return;let e=L.polyline(t,this.options.pathOptions);this._setPane(e,"layerPane"),this._finishLayer(e),e.addTo(this._map.pm._getContainingLayer()),this._fireCreate(e),this.options.snappable&&this._cleanupSnapping();let i=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(i))},_createMarker(t){let e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this._layerGroup.addLayer(e),this._markers.push(e),e.on("click",this._finishShape,this),e},_setTooltipText(){let{length:t}=this._layer.getLatLngs().flat(),e="";e=t<=1?em("tooltips.continueLine"):em("tooltips.finishLine"),this._hintMarker.setTooltipContent(e)},_change(t){this._fireChange(t,"Draw")},setStyle(){this._layer?.setStyle(this.options.templineStyle),this._hintline?.setStyle(this.options.hintlineStyle)}}),eR.Polygon=eR.Line.extend({initialize(t){this._map=t,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(t){L.PM.Draw.Line.prototype.enable.call(this,t),this._layer.pm._shape="Polygon"},_createMarker(t){let e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this._layerGroup.addLayer(e),this._markers.push(e),1===this._layer.getLatLngs().flat().length?(e.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(e)-1,this.options.snappable&&this._cleanupSnapping()):e.on("click",()=>1),e},_setTooltipText(){let{length:t}=this._layer.getLatLngs().flat(),e="";e=t<=2?em("tooltips.continueLine"):em("tooltips.finishPoly"),this._hintMarker.setTooltipContent(e)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let t=this._layer.getLatLngs();if(t.length<=2)return;let e=L.polygon(t,this.options.pathOptions);this._setPane(e,"layerPane"),this._finishLayer(e),e.addTo(this._map.pm._getContainingLayer()),this._fireCreate(e),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex;let i=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(i))}}),eR.Rectangle=eR.extend({initialize(t){this._map=t,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(t){if(L.Util.setOptions(this,t),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:+!!this.options.cursorMarker}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(em("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let t=0;t<2;t+=1){let t=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(t,"vertexPane"),t._pmTempLayer=!0,this._layerGroup.addLayer(t),this._styleMarkers.push(t)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_placeStartingMarkers(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(e),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(t=>{L.DomUtil.addClass(t._icon,"visible"),t.setLatLng(e)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(em("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let t=this._startMarker.getLatLng();t&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([t,t]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(t){this._hintMarker.setLatLng(t.latlng),this.options.snappable&&(t.target=this._hintMarker,this._handleSnapping(t));let e=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(e,"Draw")},_syncRectangleSize(){let t=ex(this._startMarker.getLatLng(),this._map),e=ex(this._hintMarker.getLatLng(),this._map),i=L.PM.Utils._getRotatedRectangle(t,e,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(i),this.options.cursorMarker&&this._styleMarkers){let r=[];i.forEach(i=>{i.equals(t,1e-8)||i.equals(e,1e-8)||r.push(i)}),r.forEach((t,e)=>{try{this._styleMarkers[e].setLatLng(t)}catch{}})}},_findCorners(){let t=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(t[0],t[2],this.options.rectangleAngle||0,this._map)},_finishShape(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||i.equals(e))return;let r=L.rectangle([i,e],this.options.pathOptions);if(this.options.rectangleAngle){let t=L.PM.Utils._getRotatedRectangle(i,e,this.options.rectangleAngle||0,this._map);r.setLatLngs(t),r.pm&&r.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(r,"layerPane"),this._finishLayer(r),r.addTo(this._map.pm._getContainingLayer()),this._fireCreate(r);let n=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(n))},setStyle(){this._layer?.setStyle(this.options.pathOptions)}}),eR.CircleMarker=eR.extend({initialize(t){this._map=t,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(t){if(L.Util.setOptions(this,t),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let t={};L.extend(t,this.options.templineStyle),t.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),t),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(em("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(em("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(t=>{this.isRelevantMarker(t)&&t.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(t=>{this.isRelevantMarker(t)&&t.pm.disable()})},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_placeCenterMarker(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng),this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker);let e=this._hintMarker.getLatLng();this._centerMarker.setLatLng(e),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(em("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let t=this._centerMarker.getLatLng(),e=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([t,e])},_syncCircleRadius(){let t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),i=this._distanceCalculation(t,e);this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(i)},_syncHintMarker(t){this._hintMarker.setLatLng(t.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable&&(t.target=this._hintMarker,this._handleSnapping(t)),this._handleHintMarkerSnapping();let e=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(e,"Draw")},isRelevantMarker:t=>t instanceof L.CircleMarker&&!(t instanceof L.Circle)&&t.pm&&!t._pmTempLayer,_createMarker(t){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!t.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=new this._BaseCircleClass(e,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(i,"layerPane"),this._finishLayer(i),i.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(i),this._fireCreate(i),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(t){t.pm&&this.options.markerEditable&&t.pm.enable()},_finishShape(t){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._centerMarker.getLatLng(),i=this._defaultRadius;if(this.options[this._editableOption]){let t=this._hintMarker.getLatLng();i=this._distanceCalculation(e,t),this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?i=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&(i=this.options[this._maxRadiusOption])}let r={...this.options.pathOptions,radius:i},n=new this._BaseCircleClass(e,r);this._setPane(n,"layerPane"),this._finishLayer(n),n.addTo(this._map.pm._getContainingLayer()),n.pm&&n.pm._updateHiddenPolyCircle(),this._fireCreate(n);let a=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(a))},_getNewDestinationOfHintMarker(){let t=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return t;let e=this._centerMarker.getLatLng(),i=this._distanceCalculation(e,t);this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?t=eM(this._map,e,t,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&(t=eM(this._map,e,t,this._getMaxDistanceInMeter()))}return t},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),i=this._distanceCalculation(t,e);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){let t={};L.extend(t,this.options.templineStyle),this.options[this._editableOption]&&(t.radius=0),this._layer?.setStyle(t),this._hintline?.setStyle(this.options.hintlineStyle)},_distanceCalculation(t,e){return this._map.project(t).distanceTo(this._map.project(e))}}),eR.Circle=eR.CircleMarker.extend({initialize(t){this._map=t,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(t,e){return this._map.distance(t,e)}});var eX=function(t){if(!t)throw Error("geojson is required");var e=[];return eY(t,function(t){(function(t,e){var i=[],r=t.geometry;if(null!==r){switch(r.type){case"Polygon":i=eU(r);break;case"LineString":i=[eU(r)]}i.forEach(function(i){var r,n,a;(r=i,n=t.properties,a=[],r.reduce(function(t,e){var i,r,s,o,l,h,p=eI([t,e],n);return i=t,r=e,s=i[0],o=i[1],p.bbox=[s<(l=r[0])?s:l,o<(h=r[1])?o:h,s>l?s:l,o>h?o:h],a.push(p),e}),a).forEach(function(t){t.id=e.length,e.push(t)})})}})(t,e)}),eA(e)},e$=d(eh(),1);function eJ(t,e){var i=eU(t),r=eU(e);if(2!==i.length)throw Error("<intersects> line1 must only contain 2 coordinates");if(2!==r.length)throw Error("<intersects> line2 must only contain 2 coordinates");var n=i[0][0],a=i[0][1],s=i[1][0],o=i[1][1],l=r[0][0],h=r[0][1],p=r[1][0],u=r[1][1],c=(u-h)*(s-n)-(p-l)*(o-a);if(0===c)return null;var d=((p-l)*(a-h)-(u-h)*(n-l))/c,g=((s-n)*(a-h)-(o-a)*(n-l))/c;return d>=0&&d<=1&&g>=0&&g<=1?eO([n+d*(s-n),a+d*(o-a)]):null}var eZ=function(t,e){var i={},r=[];if("LineString"===t.type&&(t=eD(t)),"LineString"===e.type&&(e=eD(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var n=eJ(t,e);return n&&r.push(n),eA(r)}var a=(0,e$.default)();return a.load(eX(e)),eH(eX(t),function(t){eH(a.search(t),function(e){var n=eJ(t,e);if(n){var a=eU(n).join(",");i[a]||(i[a]=!0,r.push(n))}})}),eA(r)},eW=d(eh(),1),eQ=function(t,e,i){void 0===i&&(i={});var r=eF(t),n=eF(e),a=Math.pow(Math.sin(ej(n[1]-r[1])/2),2)+Math.pow(Math.sin(ej(n[0]-r[0])/2),2)*Math.cos(ej(r[1]))*Math.cos(ej(n[1]));return function(t,e){void 0===e&&(e="kilometers");var i=eT[e];if(!i)throw Error(e+" units is invalid");return t*i}(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),i.units)},e0=function(t){var e=t[0],i=t[1],r=t[2],n=t[3];if(eQ(t.slice(0,2),[r,i])>=eQ(t.slice(0,2),[e,n])){var a=(i+n)/2;return[e,a-(r-e)/2,r,a+(r-e)/2]}var s=(e+r)/2;return[s-(n-i)/2,i,s+(n-i)/2,n]};function e1(t){var e=[1/0,1/0,-1/0,-1/0];return eq(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}e1.default=e1;var e2=function(t,e){void 0===e&&(e={});var i=e.precision,r=e.coordinates,n=e.mutate;if(i=null==i||isNaN(i)?6:i,r=null==r||isNaN(r)?3:r,!t)throw Error("<geojson> is required");if("number"!=typeof i)throw Error("<precision> must be a number");if("number"!=typeof r)throw Error("<coordinates> must be a number");(!1===n||void 0===n)&&(t=JSON.parse(JSON.stringify(t)));var a=Math.pow(10,i);return eq(t,function(t){(function(t,e,i){t.length>i&&t.splice(i,t.length);for(var r=0;r<t.length;r++)t[r]=Math.round(t[r]*e)/e})(t,a,r)}),t};function e4(t,e,i,r){void 0===r&&(r={});var n=eF(t),a=ej(n[0]),s=ej(n[1]),o=ej(i),l=function(t,e){void 0===e&&(e="kilometers");var i=eT[e];if(!i)throw Error(e+" units is invalid");return t/i}(e,r.units),h=Math.asin(Math.sin(s)*Math.cos(l)+Math.cos(s)*Math.sin(l)*Math.cos(o));return eO([eG(a+Math.atan2(Math.sin(o)*Math.sin(l)*Math.cos(s),Math.cos(l)-Math.sin(s)*Math.sin(h))),eG(h)],r.properties)}var e3=function(t,e,i){void 0===i&&(i={});var r=eO([1/0,1/0],{dist:1/0}),n=0;return eY(t,function(t){for(var a=eU(t),s=0;s<a.length-1;s++){var o=eO(a[s]);o.properties.dist=eQ(e,o,i);var l=eO(a[s+1]);l.properties.dist=eQ(e,l,i);var h=eQ(o,l,i),p=Math.max(o.properties.dist,l.properties.dist),u=function t(e,i,r){if(void 0===r&&(r={}),!0===r.final)return(t(i,e)+180)%360;var n=eF(e),a=eF(i),s=ej(n[0]),o=ej(a[0]),l=ej(n[1]),h=ej(a[1]);return eG(Math.atan2(Math.sin(o-s)*Math.cos(h),Math.cos(l)*Math.sin(h)-Math.sin(l)*Math.cos(h)*Math.cos(o-s)))}(o,l),c=e4(e,p,u+90,i),d=e4(e,p,u-90,i),g=eZ(eI([c.geometry.coordinates,d.geometry.coordinates]),eI([o.geometry.coordinates,l.geometry.coordinates])),f=null;g.features.length>0&&((f=g.features[0]).properties.dist=eQ(e,f,i),f.properties.location=n+eQ(o,f,i)),o.properties.dist<r.properties.dist&&((r=o).properties.index=s,r.properties.location=n),l.properties.dist<r.properties.dist&&((r=l).properties.index=s+1,r.properties.location=n+h),f&&f.properties.dist<r.properties.dist&&((r=f).properties.index=s),n+=h}}),r};function e5(t,e){var i=[],r=(0,eW.default)();return eY(e,function(e){if(i.forEach(function(t,e){t.id=e}),i.length){var n=r.search(e);if(n.features.length){var a=e6(e,n);i=i.filter(function(t){return t.id!==a.id}),r.remove(a),eH(e8(a,e),function(t){i.push(t),r.insert(t)})}}else(i=e8(t,e).features).forEach(function(t){t.bbox||(t.bbox=e0(e1(t)))}),r.load(eA(i))}),eA(i)}function e8(t,e){var i,r,n,a=[],s=eU(t)[0],o=eU(t)[t.geometry.coordinates.length-1];if(e9(s,eF(e))||e9(o,eF(e)))return eA([t]);var l=(0,eW.default)(),h=eX(t);l.load(h);var p=l.search(e);if(!p.features.length)return eA([t]);var u=e6(e,p),c=(i=function(t,i,r){var n=eU(i)[1],s=eF(e);return r===u.id?(t.push(s),a.push(eI(t)),e9(s,n)?[s]:[s,n]):(t.push(n),t)},n=r=[s],eH(h,function(t,e){n=0===e&&void 0===r?t:i(n,t,e)}),n);return c.length>1&&a.push(eI(c)),eA(a)}function e6(t,e){if(!e.features.length)throw Error("lines must contain features");if(1===e.features.length)return e.features[0];var i,r=1/0;return eH(e,function(e){var n=e3(e,t).properties.dist;n<r&&(i=e,r=n)}),i}function e9(t,e){return t[0]===e[0]&&t[1]===e[1]}var e7=function(t,e){if(!t)throw Error("line is required");if(!e)throw Error("splitter is required");var i=eK(t),r=eK(e);if("LineString"!==i)throw Error("line must be LineString");if("FeatureCollection"===r)throw Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===r)throw Error("splitter cannot be a GeometryCollection");var n=e2(e,{precision:7});switch(r){case"Point":return e8(t,n);case"MultiPoint":return e5(t,n);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return e5(t,eZ(t,n))}};function it(t,e,i){if(void 0===i&&(i={}),!t)throw Error("point is required");if(!e)throw Error("polygon is required");var r,n,a=eF(t),s=eV(e),o=s.type,l=e.bbox,h=s.coordinates;if(l&&!1==(r=a,(n=l)[0]<=r[0]&&n[1]<=r[1]&&n[2]>=r[0]&&n[3]>=r[1]))return!1;"Polygon"===o&&(h=[h]);for(var p=!1,u=0;u<h.length&&!p;u++)if(ie(a,h[u][0],i.ignoreBoundary)){for(var c=!1,d=1;d<h[u].length&&!c;)ie(a,h[u][d],!i.ignoreBoundary)&&(c=!0),d++;c||(p=!0)}return p}function ie(t,e,i){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var n=0,a=e.length-1;n<e.length;a=n++){var s=e[n][0],o=e[n][1],l=e[a][0],h=e[a][1];if(t[1]*(s-l)+o*(l-t[0])+h*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(o-t[1])*(h-t[1])<=0)return!i;o>t[1]!=h>t[1]&&t[0]<(l-s)*(t[1]-o)/(h-o)+s&&(r=!r)}return r}var ii=function(t,e,i){void 0===i&&(i={});for(var r=eF(t),n=eU(e),a=0;a<n.length-1;a++){var s=!1;if(i.ignoreEndVertices&&(0===a&&(s="start"),a===n.length-2&&(s="end"),0===a&&a+1===n.length-1&&(s="both")),function(t,e,i,r,n){var a=i[0],s=i[1],o=t[0],l=t[1],h=e[0],p=e[1],u=i[0]-o,c=i[1]-l,d=h-o,g=p-l,f=u*g-c*d;if(null!==n){if(Math.abs(f)>n)return!1}else if(0!==f)return!1;return r?"start"===r?Math.abs(d)>=Math.abs(g)?d>0?o<a&&a<=h:h<=a&&a<o:g>0?l<s&&s<=p:p<=s&&s<l:"end"===r?Math.abs(d)>=Math.abs(g)?d>0?o<=a&&a<h:h<a&&a<=o:g>0?l<=s&&s<p:p<s&&s<=l:"both"===r&&(Math.abs(d)>=Math.abs(g)?d>0?o<a&&a<h:h<a&&a<o:g>0?l<s&&s<p:p<s&&s<l):Math.abs(d)>=Math.abs(g)?d>0?o<=a&&a<=h:h<=a&&a<=o:g>0?l<=s&&s<=p:p<=s&&s<=l}(n[a],n[a+1],r,s,typeof i.epsilon>"u"?null:i.epsilon))return!0}return!1};function ir(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function ia(t,e){return t[0]===e[0]&&t[1]===e[1]}var is=d(en()),io=t=>()=>t,il=t=>{let e=t?(e,i)=>i.minus(e).abs().isLessThanOrEqualTo(t):io(!1);return(t,i)=>e(t,i)?0:t.comparedTo(i)},ih=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,ip=Math.ceil,iu=Math.floor,ic="[BigNumber Error] ",id=ic+"Number primitive has more than 15 significant digits: ",ig=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function i_(t){var e=0|t;return t>0||t===e?e:e-1}function im(t){for(var e,i,r=1,n=t.length,a=t[0]+"";r<n;){for(i=14-(e=t[r++]+"").length;i--;e="0"+e);a+=e}for(n=a.length;48===a.charCodeAt(--n););return a.slice(0,n+1||1)}function iy(t,e){var i,r,n=t.c,a=e.c,s=t.s,o=e.s,l=t.e,h=e.e;if(!s||!o)return null;if(i=n&&!n[0],r=a&&!a[0],i||r)return i?r?0:-o:s;if(s!=o)return s;if(i=s<0,r=l==h,!n||!a)return r?0:!n^i?1:-1;if(!r)return l>h^i?1:-1;for(o=(l=n.length)<(h=a.length)?l:h,s=0;s<o;s++)if(n[s]!=a[s])return n[s]>a[s]^i?1:-1;return l==h?0:l>h^i?1:-1}function iL(t,e,i,r){if(t<e||t>i||t!==iu(t))throw Error(ic+(r||"Argument")+("number"==typeof t?t<e||t>i?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function ib(t){var e=t.c.length-1;return i_(t.e/14)==e&&t.c[e]%2!=0}function ik(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function iM(t,e,i){var r,n;if(e<0){for(n=i+".";++e;n+=i);t=n+t}else if(r=t.length,++e>r){for(n=i,e-=r;--e;n+=i);t+=n}else e<r&&(t=t.slice(0,e)+"."+t.slice(e));return t}var iv=function t(e){var i,r,n,a,s,o,l,h,p,u=w.prototype={constructor:w,toString:null,valueOf:null},c=new w(1),d=20,g=4,f=-7,_=21,m=-1e7,y=1e7,b=!1,k=1,M=0,v={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},x="0123456789abcdefghijklmnopqrstuvwxyz",C=!0;function w(t,e){var i,r,n,a,s,o,l,u,c=this;if(!(c instanceof w))return new w(t,e);if(null==e){if(t&&!0===t._isBigNumber){c.s=t.s,!t.c||t.e>y?c.c=c.e=null:t.e<m?c.c=[c.e=0]:(c.e=t.e,c.c=t.c.slice());return}if((o="number"==typeof t)&&0*t==0){if(c.s=1/t<0?(t=-t,-1):1,t===~~t){for(a=0,s=t;s>=10;s/=10,a++);a>y?c.c=c.e=null:(c.e=a,c.c=[t]);return}u=String(t)}else{if(!ih.test(u=String(t)))return p(c,u,o);c.s=45==u.charCodeAt(0)?(u=u.slice(1),-1):1}(a=u.indexOf("."))>-1&&(u=u.replace(".","")),(s=u.search(/e/i))>0?(a<0&&(a=s),a+=+u.slice(s+1),u=u.substring(0,s)):a<0&&(a=u.length)}else{if(iL(e,2,x.length,"Base"),10==e&&C)return B(c=new w(t),d+c.e+1,g);if(u=String(t),o="number"==typeof t){if(0*t!=0)return p(c,u,o,e);if(c.s=1/t<0?(u=u.slice(1),-1):1,w.DEBUG&&u.replace(/^0\.0*|\./,"").length>15)throw Error(id+t)}else c.s=45===u.charCodeAt(0)?(u=u.slice(1),-1):1;for(i=x.slice(0,e),a=s=0,l=u.length;s<l;s++)if(0>i.indexOf(r=u.charAt(s))){if("."==r){if(s>a){a=l;continue}}else if(!n&&(u==u.toUpperCase()&&(u=u.toLowerCase())||u==u.toLowerCase()&&(u=u.toUpperCase()))){n=!0,s=-1,a=0;continue}return p(c,String(t),o,e)}o=!1,(a=(u=h(u,e,10,c.s)).indexOf("."))>-1?u=u.replace(".",""):a=u.length}for(s=0;48===u.charCodeAt(s);s++);for(l=u.length;48===u.charCodeAt(--l););if(u=u.slice(s,++l)){if(l-=s,o&&w.DEBUG&&l>15&&(t>0x1fffffffffffff||t!==iu(t)))throw Error(id+c.s*t);if((a=a-s-1)>y)c.c=c.e=null;else if(a<m)c.c=[c.e=0];else{if(c.e=a,c.c=[],s=(a+1)%14,a<0&&(s+=14),s<l){for(s&&c.c.push(+u.slice(0,s)),l-=14;s<l;)c.c.push(+u.slice(s,s+=14));s=14-(u=u.slice(s)).length}else s-=l;for(;s--;u+="0");c.c.push(+u)}}else c.c=[c.e=0]}function P(t,e,i,r){var n,a,s,o,l;if(null==i?i=g:iL(i,0,8),!t.c)return t.toString();if(n=t.c[0],s=t.e,null==e)l=im(t.c),l=1==r||2==r&&(s<=f||s>=_)?ik(l,s):iM(l,s,"0");else if(a=(t=B(new w(t),e,i)).e,o=(l=im(t.c)).length,1==r||2==r&&(e<=a||a<=f)){for(;o<e;l+="0",o++);l=ik(l,a)}else if(e-=s,l=iM(l,a,"0"),a+1>o){if(--e>0)for(l+=".";e--;l+="0");}else if((e+=a-o)>0)for(a+1==o&&(l+=".");e--;l+="0");return t.s<0&&n?"-"+l:l}function E(t,e){for(var i,r,n=1,a=new w(t[0]);n<t.length;n++)(r=new w(t[n])).s&&(i=iy(a,r))!==e&&(0!==i||a.s!==e)||(a=r);return a}function S(t,e,i){for(var r=1,n=e.length;!e[--n];e.pop());for(n=e[0];n>=10;n/=10,r++);return(i=r+14*i-1)>y?t.c=t.e=null:i<m?t.c=[t.e=0]:(t.e=i,t.c=e),t}function B(t,e,i,r){var n,a,s,o,l,h,p,u=t.c;if(u){t:{for(n=1,o=u[0];o>=10;o/=10,n++);if((a=e-n)<0)a+=14,s=e,p=iu((l=u[h=0])/ig[n-s-1]%10);else if((h=ip((a+1)/14))>=u.length){if(r){for(;u.length<=h;u.push(0));l=p=0,n=1,a%=14,s=a-14+1}else break t}else{for(l=o=u[h],n=1;o>=10;o/=10,n++);a%=14,p=(s=a-14+n)<0?0:iu(l/ig[n-s-1]%10)}if(r=r||e<0||null!=u[h+1]||(s<0?l:l%ig[n-s-1]),r=i<4?(p||r)&&(0==i||i==(t.s<0?3:2)):p>5||5==p&&(4==i||r||6==i&&(a>0?s>0?l/ig[n-s]:0:u[h-1])%10&1||i==(t.s<0?8:7)),e<1||!u[0])return u.length=0,r?(e-=t.e+1,u[0]=ig[(14-e%14)%14],t.e=-e||0):u[0]=t.e=0,t;if(0==a?(u.length=h,o=1,h--):(u.length=h+1,o=ig[14-a],u[h]=s>0?iu(l/ig[n-s]%ig[s])*o:0),r)for(;;)if(0==h){for(a=1,s=u[0];s>=10;s/=10,a++);for(s=u[0]+=o,o=1;s>=10;s/=10,o++);a!=o&&(t.e++,1e14==u[0]&&(u[0]=1));break}else{if(u[h]+=o,1e14!=u[h])break;u[h--]=0,o=1}for(a=u.length;0===u[--a];u.pop());}t.e>y?t.c=t.e=null:t.e<m&&(t.c=[t.e=0])}return t}function R(t){var e,i=t.e;return null===i?t.toString():(e=im(t.c),e=i<=f||i>=_?ik(e,i):iM(e,i,"0"),t.s<0?"-"+e:e)}return w.clone=t,w.ROUND_UP=0,w.ROUND_DOWN=1,w.ROUND_CEIL=2,w.ROUND_FLOOR=3,w.ROUND_HALF_UP=4,w.ROUND_HALF_DOWN=5,w.ROUND_HALF_EVEN=6,w.ROUND_HALF_CEIL=7,w.ROUND_HALF_FLOOR=8,w.EUCLID=9,w.config=w.set=function(t){var e,i;if(null!=t){if("object"==typeof t){if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(iL(i=t[e],0,1e9,e),d=i),t.hasOwnProperty(e="ROUNDING_MODE")&&(iL(i=t[e],0,8,e),g=i),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((i=t[e])&&i.pop?(iL(i[0],-1e9,0,e),iL(i[1],0,1e9,e),f=i[0],_=i[1]):(iL(i,-1e9,1e9,e),f=-(_=i<0?-i:i))),t.hasOwnProperty(e="RANGE")){if((i=t[e])&&i.pop)iL(i[0],-1e9,-1,e),iL(i[1],1,1e9,e),m=i[0],y=i[1];else if(iL(i,-1e9,1e9,e),i)m=-(y=i<0?-i:i);else throw Error(ic+e+" cannot be zero: "+i)}if(t.hasOwnProperty(e="CRYPTO")){if(!!(i=t[e])===i){if(i){if("u">typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))b=i;else throw b=!i,Error(ic+"crypto unavailable")}else b=i}else throw Error(ic+e+" not true or false: "+i)}if(t.hasOwnProperty(e="MODULO_MODE")&&(iL(i=t[e],0,9,e),k=i),t.hasOwnProperty(e="POW_PRECISION")&&(iL(i=t[e],0,1e9,e),M=i),t.hasOwnProperty(e="FORMAT")){if("object"==typeof(i=t[e]))v=i;else throw Error(ic+e+" not an object: "+i)}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(i=t[e])||/^.?$|[+\-.\s]|(.).*\1/.test(i))throw Error(ic+e+" invalid: "+i);C="0123456789"==i.slice(0,10),x=i}}else throw Error(ic+"Object expected: "+t)}return{DECIMAL_PLACES:d,ROUNDING_MODE:g,EXPONENTIAL_AT:[f,_],RANGE:[m,y],CRYPTO:b,MODULO_MODE:k,POW_PRECISION:M,FORMAT:v,ALPHABET:x}},w.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!w.DEBUG)return!0;var e,i,r=t.c,n=t.e,a=t.s;t:if("[object Array]"==({}).toString.call(r)){if((1===a||-1===a)&&n>=-1e9&&n<=1e9&&n===iu(n)){if(0===r[0]){if(0===n&&1===r.length)return!0;break t}if((e=(n+1)%14)<1&&(e+=14),String(r[0]).length==e){for(e=0;e<r.length;e++)if((i=r[e])<0||i>=1e14||i!==iu(i))break t;if(0!==i)return!0}}}else if(null===r&&null===n&&(null===a||1===a||-1===a))return!0;throw Error(ic+"Invalid BigNumber: "+t)},w.maximum=w.max=function(){return E(arguments,-1)},w.minimum=w.min=function(){return E(arguments,1)},i=0x20000000000000*Math.random()&2097151?function(){return iu(0x20000000000000*Math.random())}:function(){return(0x40000000*Math.random()|0)*8388608+(8388608*Math.random()|0)},w.random=function(t){var e,r,n,a,s,o=0,l=[],h=new w(c);if(null==t?t=d:iL(t,0,1e9),a=ip(t/14),b){if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(a*=2));o<a;)(s=131072*e[o]+(e[o+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),e[o]=r[0],e[o+1]=r[1]):(l.push(s%1e14),o+=2);o=a/2}else if(crypto.randomBytes){for(e=crypto.randomBytes(a*=7);o<a;)(s=(31&e[o])*0x1000000000000+0x10000000000*e[o+1]+0x100000000*e[o+2]+0x1000000*e[o+3]+(e[o+4]<<16)+(e[o+5]<<8)+e[o+6])>=9e15?crypto.randomBytes(7).copy(e,o):(l.push(s%1e14),o+=7);o=a/7}else throw b=!1,Error(ic+"crypto unavailable")}if(!b)for(;o<a;)(s=i())<9e15&&(l[o++]=s%1e14);for(a=l[--o],t%=14,a&&t&&(s=ig[14-t],l[o]=iu(a/s)*s);0===l[o];l.pop(),o--);if(o<0)l=[n=0];else{for(n=-1;0===l[0];l.splice(0,1),n-=14);for(o=1,s=l[0];s>=10;s/=10,o++);o<14&&(n-=14-o)}return h.e=n,h.c=l,h},w.sum=function(){for(var t=1,e=arguments,i=new w(e[0]);t<e.length;)i=i.plus(e[t++]);return i},h=function(){var t="0123456789";function e(t,e,i,r){for(var n,a,s=[0],o=0,l=t.length;o<l;){for(a=s.length;a--;s[a]*=e);for(s[0]+=r.indexOf(t.charAt(o++)),n=0;n<s.length;n++)s[n]>i-1&&(null==s[n+1]&&(s[n+1]=0),s[n+1]+=s[n]/i|0,s[n]%=i)}return s.reverse()}return function(i,r,n,a,s){var o,h,p,u,c,f,_,m,y=i.indexOf("."),b=d,k=g;for(y>=0&&(u=M,M=0,i=i.replace(".",""),f=(m=new w(r)).pow(i.length-y),M=u,m.c=e(iM(im(f.c),f.e,"0"),10,n,t),m.e=m.c.length),p=u=(_=e(i,r,n,s?(o=x,t):(o=t,x))).length;0==_[--u];_.pop());if(!_[0])return o.charAt(0);if(y<0?--p:(f.c=_,f.e=p,f.s=a,_=(f=l(f,m,b,k,n)).c,c=f.r,p=f.e),y=_[h=p+b+1],u=n/2,c=c||h<0||null!=_[h+1],c=k<4?(null!=y||c)&&(0==k||k==(f.s<0?3:2)):y>u||y==u&&(4==k||c||6==k&&1&_[h-1]||k==(f.s<0?8:7)),h<1||!_[0])i=c?iM(o.charAt(1),-b,o.charAt(0)):o.charAt(0);else{if(_.length=h,c)for(--n;++_[--h]>n;)_[h]=0,h||(++p,_=[1].concat(_));for(u=_.length;!_[--u];);for(y=0,i="";y<=u;i+=o.charAt(_[y++]));i=iM(i,p,o.charAt(0))}return i}}(),l=function(){function t(t,e,i){var r,n,a,s,o=0,l=t.length,h=e%1e7,p=e/1e7|0;for(t=t.slice();l--;)r=p*(a=t[l]%1e7)+(s=t[l]/1e7|0)*h,o=((n=h*a+r%1e7*1e7+o)/i|0)+(r/1e7|0)+p*s,t[l]=n%i;return o&&(t=[o].concat(t)),t}function e(t,e,i,r){var n,a;if(i!=r)a=i>r?1:-1;else for(n=a=0;n<i;n++)if(t[n]!=e[n]){a=t[n]>e[n]?1:-1;break}return a}function i(t,e,i,r){for(var n=0;i--;)t[i]-=n,n=+(t[i]<e[i]),t[i]=n*r+t[i]-e[i];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(r,n,a,s,o){var l,h,p,u,c,d,g,f,_,m,y,b,k,M,v,x,C,P=r.s==n.s?1:-1,E=r.c,S=n.c;if(!E||!E[0]||!S||!S[0])return new w(r.s&&n.s&&(E?!S||E[0]!=S[0]:S)?E&&0==E[0]||!S?0*P:P/0:NaN);for(_=(f=new w(P)).c=[],P=a+(h=r.e-n.e)+1,o||(o=1e14,h=i_(r.e/14)-i_(n.e/14),P=P/14|0),p=0;S[p]==(E[p]||0);p++);if(S[p]>(E[p]||0)&&h--,P<0)_.push(1),u=!0;else{for(M=E.length,x=S.length,p=0,P+=2,(c=iu(o/(S[0]+1)))>1&&(S=t(S,c,o),E=t(E,c,o),x=S.length,M=E.length),k=x,y=(m=E.slice(0,x)).length;y<x;m[y++]=0);C=[0].concat(C=S.slice()),v=S[0],S[1]>=o/2&&v++;do{if(c=0,(l=e(S,m,x,y))<0){if(b=m[0],x!=y&&(b=b*o+(m[1]||0)),(c=iu(b/v))>1)for(c>=o&&(c=o-1),g=(d=t(S,c,o)).length,y=m.length;1==e(d,m,g,y);)c--,i(d,x<g?C:S,g,o),g=d.length,l=1;else 0==c&&(l=c=1),g=(d=S.slice()).length;if(g<y&&(d=[0].concat(d)),i(m,d,y,o),y=m.length,-1==l)for(;1>e(S,m,x,y);)c++,i(m,x<y?C:S,y,o),y=m.length}else 0===l&&(c++,m=[0]);_[p++]=c,m[0]?m[y++]=E[k]||0:(m=[E[k]],y=1)}while((k++<M||null!=m[0])&&P--);u=null!=m[0],_[0]||_.splice(0,1)}if(1e14==o){for(p=1,P=_[0];P>=10;P/=10,p++);B(f,a+(f.e=p+14*h-1)+1,s,u)}else f.e=h,f.r=+u;return f}}(),r=/^(-?)0([xbo])(?=\w[\w.]*$)/i,n=/^([^.]+)\.$/,a=/^\.([^.]+)$/,s=/^-?(Infinity|NaN)$/,o=/^\s*\+(?=[\w.])|^\s+|\s+$/g,p=function(t,e,i,l){var h,p=i?e:e.replace(o,"");if(s.test(p))t.s=isNaN(p)?null:p<0?-1:1;else{if(!i&&(p=p.replace(r,function(t,e,i){return h="x"==(i=i.toLowerCase())?16:"b"==i?2:8,l&&l!=h?t:e}),l&&(h=l,p=p.replace(n,"$1").replace(a,"0.$1")),e!=p))return new w(p,h);if(w.DEBUG)throw Error(ic+"Not a"+(l?" base "+l:"")+" number: "+e);t.s=null}t.c=t.e=null},u.absoluteValue=u.abs=function(){var t=new w(this);return t.s<0&&(t.s=1),t},u.comparedTo=function(t,e){return iy(this,new w(t,e))},u.decimalPlaces=u.dp=function(t,e){var i,r,n;if(null!=t)return iL(t,0,1e9),null==e?e=g:iL(e,0,8),B(new w(this),t+this.e+1,e);if(!(i=this.c))return null;if(r=((n=i.length-1)-i_(this.e/14))*14,n=i[n])for(;n%10==0;n/=10,r--);return r<0&&(r=0),r},u.dividedBy=u.div=function(t,e){return l(this,new w(t,e),d,g)},u.dividedToIntegerBy=u.idiv=function(t,e){return l(this,new w(t,e),0,1)},u.exponentiatedBy=u.pow=function(t,e){var i,r,n,a,s,o,l,h,p,u=this;if((t=new w(t)).c&&!t.isInteger())throw Error(ic+"Exponent not an integer: "+R(t));if(null!=e&&(e=new w(e)),o=t.e>14,!u.c||!u.c[0]||1==u.c[0]&&!u.e&&1==u.c.length||!t.c||!t.c[0])return p=new w(Math.pow(+R(u),o?t.s*(2-ib(t)):+R(t))),e?p.mod(e):p;if(l=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new w(NaN);(r=!l&&u.isInteger()&&e.isInteger())&&(u=u.mod(e))}else{if(t.e>9&&(u.e>0||u.e<-1||(0==u.e?u.c[0]>1||o&&u.c[1]>=24e7:u.c[0]<8e13||o&&u.c[0]<=9999975e7)))return a=u.s<0&&ib(t)?-0:0,u.e>-1&&(a=1/a),new w(l?1/a:a);M&&(a=ip(M/14+2))}for(o?(i=new w(.5),l&&(t.s=1),h=ib(t)):h=(n=Math.abs(+R(t)))%2,p=new w(c);;){if(h){if(!(p=p.times(u)).c)break;a?p.c.length>a&&(p.c.length=a):r&&(p=p.mod(e))}if(n){if(0===(n=iu(n/2)))break;h=n%2}else if(B(t=t.times(i),t.e+1,1),t.e>14)h=ib(t);else{if(0==(n=+R(t)))break;h=n%2}u=u.times(u),a?u.c&&u.c.length>a&&(u.c.length=a):r&&(u=u.mod(e))}return r?p:(l&&(p=c.div(p)),e?p.mod(e):a?B(p,M,g,s):p)},u.integerValue=function(t){var e=new w(this);return null==t?t=g:iL(t,0,8),B(e,e.e+1,t)},u.isEqualTo=u.eq=function(t,e){return 0===iy(this,new w(t,e))},u.isFinite=function(){return!!this.c},u.isGreaterThan=u.gt=function(t,e){return iy(this,new w(t,e))>0},u.isGreaterThanOrEqualTo=u.gte=function(t,e){return 1===(e=iy(this,new w(t,e)))||0===e},u.isInteger=function(){return!!this.c&&i_(this.e/14)>this.c.length-2},u.isLessThan=u.lt=function(t,e){return 0>iy(this,new w(t,e))},u.isLessThanOrEqualTo=u.lte=function(t,e){return -1===(e=iy(this,new w(t,e)))||0===e},u.isNaN=function(){return!this.s},u.isNegative=function(){return this.s<0},u.isPositive=function(){return this.s>0},u.isZero=function(){return!!this.c&&0==this.c[0]},u.minus=function(t,e){var i,r,n,a,s=this.s;if(e=(t=new w(t,e)).s,!s||!e)return new w(NaN);if(s!=e)return t.s=-e,this.plus(t);var o=this.e/14,l=t.e/14,h=this.c,p=t.c;if(!o||!l){if(!h||!p)return h?(t.s=-e,t):new w(p?this:NaN);if(!h[0]||!p[0])return p[0]?(t.s=-e,t):new w(h[0]?this:3==g?-0:0)}if(o=i_(o),l=i_(l),h=h.slice(),s=o-l){for((a=s<0)?(s=-s,n=h):(l=o,n=p),n.reverse(),e=s;e--;n.push(0));n.reverse()}else for(r=(a=(s=h.length)<(e=p.length))?s:e,s=e=0;e<r;e++)if(h[e]!=p[e]){a=h[e]<p[e];break}if(a&&(n=h,h=p,p=n,t.s=-t.s),(e=(r=p.length)-(i=h.length))>0)for(;e--;h[i++]=0);for(e=1e14-1;r>s;){if(h[--r]<p[r]){for(i=r;i&&!h[--i];h[i]=e);--h[i],h[r]+=1e14}h[r]-=p[r]}for(;0==h[0];h.splice(0,1),--l);return h[0]?S(t,h,l):(t.s=3==g?-1:1,t.c=[t.e=0],t)},u.modulo=u.mod=function(t,e){var i,r;return t=new w(t,e),this.c&&t.s&&(!t.c||t.c[0])?t.c&&(!this.c||this.c[0])?(9==k?(r=t.s,t.s=1,i=l(this,t,0,3),t.s=r,i.s*=r):i=l(this,t,0,k),(t=this.minus(i.times(t))).c[0]||1!=k||(t.s=this.s),t):new w(this):new w(NaN)},u.multipliedBy=u.times=function(t,e){var i,r,n,a,s,o,l,h,p,u,c,d,g,f=this.c,_=(t=new w(t,e)).c;if(!f||!_||!f[0]||!_[0])return this.s&&t.s&&(!f||f[0]||_)&&(!_||_[0]||f)?(t.s*=this.s,f&&_?(t.c=[0],t.e=0):t.c=t.e=null):t.c=t.e=t.s=null,t;for(r=i_(this.e/14)+i_(t.e/14),t.s*=this.s,(l=f.length)<(u=_.length)&&(g=f,f=_,_=g,n=l,l=u,u=n),n=l+u,g=[];n--;g.push(0));for(n=u;--n>=0;){for(i=0,c=_[n]%1e7,d=_[n]/1e7|0,a=n+(s=l);a>n;)o=d*(h=f[--s]%1e7)+(p=f[s]/1e7|0)*c,i=((h=c*h+o%1e7*1e7+g[a]+i)/1e14|0)+(o/1e7|0)+d*p,g[a--]=h%1e14;g[a]=i}return i?++r:g.splice(0,1),S(t,g,r)},u.negated=function(){var t=new w(this);return t.s=-t.s||null,t},u.plus=function(t,e){var i,r=this.s;if(e=(t=new w(t,e)).s,!r||!e)return new w(NaN);if(r!=e)return t.s=-e,this.minus(t);var n=this.e/14,a=t.e/14,s=this.c,o=t.c;if(!n||!a){if(!s||!o)return new w(r/0);if(!s[0]||!o[0])return o[0]?t:new w(s[0]?this:0*r)}if(n=i_(n),a=i_(a),s=s.slice(),r=n-a){for(r>0?(a=n,i=o):(r=-r,i=s),i.reverse();r--;i.push(0));i.reverse()}for((r=s.length)-(e=o.length)<0&&(i=o,o=s,s=i,e=r),r=0;e;)r=(s[--e]=s[e]+o[e]+r)/1e14|0,s[e]=1e14===s[e]?0:s[e]%1e14;return r&&(s=[r].concat(s),++a),S(t,s,a)},u.precision=u.sd=function(t,e){var i,r,n;if(null!=t&&!!t!==t)return iL(t,1,1e9),null==e?e=g:iL(e,0,8),B(new w(this),t,e);if(!(i=this.c))return null;if(r=14*(n=i.length-1)+1,n=i[n]){for(;n%10==0;n/=10,r--);for(n=i[0];n>=10;n/=10,r++);}return t&&this.e+1>r&&(r=this.e+1),r},u.shiftedBy=function(t){return iL(t,-0x1fffffffffffff,0x1fffffffffffff),this.times("1e"+t)},u.squareRoot=u.sqrt=function(){var t,e,i,r,n,a=this.c,s=this.s,o=this.e,h=d+4,p=new w("0.5");if(1!==s||!a||!a[0])return new w(!s||s<0&&(!a||a[0])?NaN:a?this:1/0);if(0==(s=Math.sqrt(+R(this)))||s==1/0?(((e=im(a)).length+o)%2==0&&(e+="0"),s=Math.sqrt(+e),o=i_((o+1)/2)-(o<0||o%2),i=new w(e=s==1/0?"5e"+o:(e=s.toExponential()).slice(0,e.indexOf("e")+1)+o)):i=new w(s+""),i.c[0]){for((s=(o=i.e)+h)<3&&(s=0);;)if(n=i,i=p.times(n.plus(l(this,n,h,1))),im(n.c).slice(0,s)===(e=im(i.c)).slice(0,s)){if(i.e<o&&--s,"9999"!=(e=e.slice(s-3,s+1))&&(r||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(B(i,i.e+d+2,1),t=!i.times(i).eq(this));break}if(!r&&(B(n,n.e+d+2,0),n.times(n).eq(this))){i=n;break}h+=4,s+=4,r=1}}return B(i,i.e+d+1,g,t)},u.toExponential=function(t,e){return null!=t&&(iL(t,0,1e9),t++),P(this,t,e,1)},u.toFixed=function(t,e){return null!=t&&(iL(t,0,1e9),t=t+this.e+1),P(this,t,e)},u.toFormat=function(t,e,i){var r;if(null==i)null!=t&&e&&"object"==typeof e?(i=e,e=null):t&&"object"==typeof t?(i=t,t=e=null):i=v;else if("object"!=typeof i)throw Error(ic+"Argument not an object: "+i);if(r=this.toFixed(t,e),this.c){var n,a=r.split("."),s=+i.groupSize,o=+i.secondaryGroupSize,l=i.groupSeparator||"",h=a[0],p=a[1],u=this.s<0,c=u?h.slice(1):h,d=c.length;if(o&&(n=s,s=o,o=n,d-=n),s>0&&d>0){for(n=d%s||s,h=c.substr(0,n);n<d;n+=s)h+=l+c.substr(n,s);o>0&&(h+=l+c.slice(n)),u&&(h="-"+h)}r=p?h+(i.decimalSeparator||"")+((o=+i.fractionGroupSize)?p.replace(RegExp("\\d{"+o+"}\\B","g"),"$&"+(i.fractionGroupSeparator||"")):p):h}return(i.prefix||"")+r+(i.suffix||"")},u.toFraction=function(t){var e,i,r,n,a,s,o,h,p,u,d,f,_=this.c;if(null!=t&&(!(o=new w(t)).isInteger()&&(o.c||1!==o.s)||o.lt(c)))throw Error(ic+"Argument "+(o.isInteger()?"out of range: ":"not an integer: ")+R(o));if(!_)return new w(this);for(e=new w(c),p=i=new w(c),r=h=new w(c),f=im(_),a=e.e=f.length-this.e-1,e.c[0]=ig[(s=a%14)<0?14+s:s],t=!t||o.comparedTo(e)>0?a>0?e:p:o,s=y,y=1/0,o=new w(f),h.c[0]=0;u=l(o,e,0,1),1!=(n=i.plus(u.times(r))).comparedTo(t);)i=r,r=n,p=h.plus(u.times(n=p)),h=n,e=o.minus(u.times(n=e)),o=n;return n=l(t.minus(i),r,0,1),h=h.plus(n.times(p)),i=i.plus(n.times(r)),h.s=p.s=this.s,a*=2,d=1>l(p,r,a,g).minus(this).abs().comparedTo(l(h,i,a,g).minus(this).abs())?[p,r]:[h,i],y=s,d},u.toNumber=function(){return+R(this)},u.toPrecision=function(t,e){return null!=t&&iL(t,1,1e9),P(this,t,e,2)},u.toString=function(t){var e,i=this,r=i.s,n=i.e;return null===n?r?(e="Infinity",r<0&&(e="-"+e)):e="NaN":(null==t?e=n<=f||n>=_?ik(im(i.c),n):iM(im(i.c),n,"0"):10===t&&C?e=iM(im((i=B(new w(i),d+n+1,g)).c),i.e,"0"):(iL(t,2,x.length,"Base"),e=h(iM(im(i.c),n,"0"),10,t,r,!0)),r<0&&i.c[0]&&(e="-"+e)),e},u.valueOf=u.toJSON=function(){return R(this)},u._isBigNumber=!0,u[Symbol.toStringTag]="BigNumber",u[Symbol.for("nodejs.util.inspect.custom")]=u.valueOf,null!=e&&w.set(e),w}(),ix=class{key;left=null;right=null;constructor(t){this.key=t}},iC=class extends ix{constructor(t){super(t)}},iw=class{size=0;modificationCount=0;splayCount=0;splay(t){let e=this.root;if(null==e)return this.compare(t,t),-1;let i=null,r=null,n=null,a=null,s=e,o=this.compare,l;for(;;)if((l=o(s.key,t))>0){let e=s.left;if(null==e||(l=o(e.key,t))>0&&(s.left=e.right,e.right=s,null==(e=(s=e).left)))break;null==i?r=s:i.left=s,i=s,s=e}else if(l<0){let e=s.right;if(null==e||(l=o(e.key,t))<0&&(s.right=e.left,e.left=s,null==(e=(s=e).right)))break;null==n?a=s:n.right=s,n=s,s=e}else break;return null!=n&&(n.right=s.left,s.left=a),null!=i&&(i.left=s.right,s.right=r),this.root!==s&&(this.root=s,this.splayCount++),l}splayMin(t){let e=t,i=e.left;for(;null!=i;){let t=i;e.left=t.right,t.right=e,i=(e=t).left}return e}splayMax(t){let e=t,i=e.right;for(;null!=i;){let t=i;e.right=t.left,t.left=e,i=(e=t).right}return e}_delete(t){if(null==this.root||0!=this.splay(t))return null;let e=this.root,i=e,r=e.left;if(this.size--,null==r)this.root=e.right;else{let t=e.right;(e=this.splayMax(r)).right=t,this.root=e}return this.modificationCount++,i}addNewRoot(t,e){this.size++,this.modificationCount++;let i=this.root;if(null==i){this.root=t;return}e<0?(t.left=i,t.right=i.right,i.right=null):(t.right=i,t.left=i.left,i.left=null),this.root=t}_first(){let t=this.root;return null==t?null:(this.root=this.splayMin(t),this.root)}_last(){let t=this.root;return null==t?null:(this.root=this.splayMax(t),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(t){return this.validKey(t)&&0==this.splay(t)}defaultCompare(){return(t,e)=>t<e?-1:+(t>e)}wrap(){return{getRoot:()=>this.root,setRoot:t=>{this.root=t},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:t=>{this.splayCount=t},splay:t=>this.splay(t),has:t=>this.has(t)}}},iP=class t extends iw{root=null;compare;validKey;constructor(t,e){super(),this.compare=t??this.defaultCompare(),this.validKey=e??(t=>null!=t&&null!=t)}delete(t){return!!this.validKey(t)&&null!=this._delete(t)}deleteAll(t){for(let e of t)this.delete(e)}forEach(t){let e=this[Symbol.iterator](),i;for(;!(i=e.next()).done;)t(i.value,i.value,this)}add(t){let e=this.splay(t);return 0!=e&&this.addNewRoot(new iC(t),e),this}addAndReturn(t){let e=this.splay(t);return 0!=e&&this.addNewRoot(new iC(t),e),this.root.key}addAll(t){for(let e of t)this.add(e)}isEmpty(){return null==this.root}isNotEmpty(){return null!=this.root}single(){if(0==this.size)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(0==this.size)throw"Bad state: No element";return this._first().key}last(){if(0==this.size)throw"Bad state: No element";return this._last().key}lastBefore(t){if(null==t)throw"Invalid arguments(s)";if(null==this.root)return null;if(0>this.splay(t))return this.root.key;let e=this.root.left;if(null==e)return null;let i=e.right;for(;null!=i;)i=(e=i).right;return e.key}firstAfter(t){if(null==t)throw"Invalid arguments(s)";if(null==this.root)return null;if(this.splay(t)>0)return this.root.key;let e=this.root.right;if(null==e)return null;let i=e.left;for(;null!=i;)i=(e=i).left;return e.key}retainAll(e){let i=new t(this.compare,this.validKey),r=this.modificationCount;for(let t of e){if(r!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(t)&&0==this.splay(t)&&i.add(this.root.key)}i.size!=this.size&&(this.root=i.root,this.size=i.size,this.modificationCount++)}lookup(t){return this.validKey(t)&&0==this.splay(t)?this.root.key:null}intersection(e){let i=new t(this.compare,this.validKey);for(let t of this)e.has(t)&&i.add(t);return i}difference(e){let i=new t(this.compare,this.validKey);for(let t of this)e.has(t)||i.add(t);return i}union(t){let e=this.clone();return e.addAll(t),e}clone(){let e=new t(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(t){if(null==t)return null;let e=new iC(t.key);return function t(e,i){let r,n;do{if(r=e.left,n=e.right,null!=r){let e=new iC(r.key);i.left=e,t(r,e)}if(null!=n){let t=new iC(n.key);i.right=t,e=n,i=t}}while(null!=n)}(t,e),e}toSet(){return this.clone()}entries(){return new iB(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new iS(this.wrap())}[Symbol.toStringTag]="[object Set]"},iE=class{tree;path=[];modificationCount=null;splayCount;constructor(t){this.tree=t,this.splayCount=t.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let t=this.path[this.path.length-1];return this.getValue(t)}rebuildPath(t){this.path.splice(0,this.path.length),this.tree.splay(t),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(t){for(;null!=t;)this.path.push(t),t=t.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(null==this.modificationCount){this.modificationCount=this.tree.getModificationCount();let t=this.tree.getRoot();for(;null!=t;)this.path.push(t),t=t.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let t=this.path[this.path.length-1],e=t.right;if(null!=e){for(;null!=e;)this.path.push(e),e=e.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===t;)t=this.path.pop();return this.path.length>0}},iS=class extends iE{getValue(t){return t.key}},iB=class extends iE{getValue(t){return[t.key,t.key]}},iR=t=>t,iT=t=>{if(t){let e=new iP(il(t)),i=new iP(il(t)),r=(t,e)=>e.addAndReturn(t),n=t=>({x:r(t.x,e),y:r(t.y,i)});return n({x:new iv(0),y:new iv(0)}),n}return iR},iD=t=>({set:t=>{iO=iD(t)},reset:()=>iD(t),compare:il(t),snap:iT(t),orient:function(t){let e=t?(e,i,r,n,a)=>e.exponentiatedBy(2).isLessThanOrEqualTo(n.minus(i).exponentiatedBy(2).plus(a.minus(r).exponentiatedBy(2)).times(t)):io(!1);return(t,i,r)=>{let n=t.x,a=t.y,s=r.x,o=r.y,l=a.minus(o).times(i.x.minus(s)).minus(n.minus(s).times(i.y.minus(o)));return e(l,n,a,s,o)?0:l.comparedTo(0)}}(t)}),iO=iD(),iI=(t,e)=>t.ll.x.isLessThanOrEqualTo(e.x)&&e.x.isLessThanOrEqualTo(t.ur.x)&&t.ll.y.isLessThanOrEqualTo(e.y)&&e.y.isLessThanOrEqualTo(t.ur.y),iA=(t,e)=>{if(e.ur.x.isLessThan(t.ll.x)||t.ur.x.isLessThan(e.ll.x)||e.ur.y.isLessThan(t.ll.y)||t.ur.y.isLessThan(e.ll.y))return null;let i=t.ll.x.isLessThan(e.ll.x)?e.ll.x:t.ll.x,r=t.ur.x.isLessThan(e.ur.x)?t.ur.x:e.ur.x;return{ll:{x:i,y:t.ll.y.isLessThan(e.ll.y)?e.ll.y:t.ll.y},ur:{x:r,y:t.ur.y.isLessThan(e.ur.y)?t.ur.y:e.ur.y}}},iG=(t,e)=>t.x.times(e.y).minus(t.y.times(e.x)),ij=(t,e)=>t.x.times(e.x).plus(t.y.times(e.y)),iN=t=>ij(t,t).sqrt(),iz=(t,e,i)=>{let r={x:e.x.minus(t.x),y:e.y.minus(t.y)},n={x:i.x.minus(t.x),y:i.y.minus(t.y)};return iG(n,r).div(iN(n)).div(iN(r))},iF=(t,e,i)=>{let r={x:e.x.minus(t.x),y:e.y.minus(t.y)},n={x:i.x.minus(t.x),y:i.y.minus(t.y)};return ij(n,r).div(iN(n)).div(iN(r))},iU=(t,e,i)=>e.y.isZero()?null:{x:t.x.plus(e.x.div(e.y).times(i.minus(t.y))),y:i},iV=(t,e,i)=>e.x.isZero()?null:{x:i,y:t.y.plus(e.y.div(e.x).times(i.minus(t.x)))},iK=(t,e,i,r)=>{if(e.x.isZero())return iV(i,r,t.x);if(r.x.isZero())return iV(t,e,i.x);if(e.y.isZero())return iU(i,r,t.y);if(r.y.isZero())return iU(t,e,i.y);let n=iG(e,r);if(n.isZero())return null;let a={x:i.x.minus(t.x),y:i.y.minus(t.y)},s=iG(a,e).div(n),o=iG(a,r).div(n),l=t.x.plus(o.times(e.x)),h=i.x.plus(s.times(r.x)),p=t.y.plus(o.times(e.y)),u=i.y.plus(s.times(r.y));return{x:l.plus(h).div(2),y:p.plus(u).div(2)}},iq=class t{point;isLeft;segment;otherSE;consumedBy;static compare(e,i){let r=t.comparePoints(e.point,i.point);return 0!==r?r:(e.point!==i.point&&e.link(i),e.isLeft!==i.isLeft?e.isLeft?1:-1:iY.compare(e.segment,i.segment))}static comparePoints(t,e){return t.x.isLessThan(e.x)?-1:t.x.isGreaterThan(e.x)?1:t.y.isLessThan(e.y)?-1:+!!t.y.isGreaterThan(e.y)}constructor(t,e){void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}link(t){if(t.point===this.point)throw Error("Tried to link already linked events");let e=t.point.events;for(let t=0,i=e.length;t<i;t++){let i=e[t];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}checkForConsuming(){let t=this.point.events.length;for(let e=0;e<t;e++){let i=this.point.events[e];if(void 0===i.segment.consumedBy)for(let r=e+1;r<t;r++){let t=this.point.events[r];void 0===t.consumedBy&&i.otherSE.point.events===t.otherSE.point.events&&i.segment.consume(t.segment)}}}getAvailableLinkedEvents(){let t=[];for(let e=0,i=this.point.events.length;e<i;e++){let i=this.point.events[e];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}getLeftmostComparator(t){let e=new Map,i=i=>{let r=i.otherSE;e.set(i,{sine:iz(this.point,t.point,r.point),cosine:iF(this.point,t.point,r.point)})};return(t,r)=>{e.has(t)||i(t),e.has(r)||i(r);let{sine:n,cosine:a}=e.get(t),{sine:s,cosine:o}=e.get(r);return n.isGreaterThanOrEqualTo(0)&&s.isGreaterThanOrEqualTo(0)?a.isLessThan(o)?1:a.isGreaterThan(o)?-1:0:n.isLessThan(0)&&s.isLessThan(0)?a.isLessThan(o)?-1:+!!a.isGreaterThan(o):s.isLessThan(n)?-1:+!!s.isGreaterThan(n)}}},iH=0,iY=class t{id;leftSE;rightSE;rings;windings;ringOut;consumedBy;prev;_prevInResult;_beforeState;_afterState;_isInResult;static compare(t,e){let i=t.leftSE.point.x,r=e.leftSE.point.x,n=t.rightSE.point.x,a=e.rightSE.point.x;if(a.isLessThan(i))return 1;if(n.isLessThan(r))return -1;let s=t.leftSE.point.y,o=e.leftSE.point.y,l=t.rightSE.point.y,h=e.rightSE.point.y;if(i.isLessThan(r)){if(o.isLessThan(s)&&o.isLessThan(l))return 1;if(o.isGreaterThan(s)&&o.isGreaterThan(l))return -1;let i=t.comparePoint(e.leftSE.point);if(i<0)return 1;if(i>0)return -1;let r=e.comparePoint(t.rightSE.point);return 0!==r?r:-1}if(i.isGreaterThan(r)){if(s.isLessThan(o)&&s.isLessThan(h))return -1;if(s.isGreaterThan(o)&&s.isGreaterThan(h))return 1;let i=e.comparePoint(t.leftSE.point);if(0!==i)return i;let r=t.comparePoint(e.rightSE.point);return r<0?1:r>0?-1:1}if(s.isLessThan(o))return -1;if(s.isGreaterThan(o))return 1;if(n.isLessThan(a)){let i=e.comparePoint(t.rightSE.point);if(0!==i)return i}if(n.isGreaterThan(a)){let i=t.comparePoint(e.rightSE.point);if(i<0)return 1;if(i>0)return -1}if(!n.eq(a)){let t=l.minus(s),e=n.minus(i),p=h.minus(o),u=a.minus(r);if(t.isGreaterThan(e)&&p.isLessThan(u))return 1;if(t.isLessThan(e)&&p.isGreaterThan(u))return -1}return n.isGreaterThan(a)?1:n.isLessThan(a)||l.isLessThan(h)?-1:l.isGreaterThan(h)?1:t.id<e.id?-1:+(t.id>e.id)}constructor(t,e,i,r){this.id=++iH,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=i,this.windings=r}static fromRing(e,i,r){let n,a,s,o=iq.comparePoints(e,i);if(o<0)n=e,a=i,s=1;else if(o>0)n=i,a=e,s=-1;else throw Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);return new t(new iq(n,!0),new iq(a,!1),[r],[s])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(e)?t:e},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(e)?t:e}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return iO.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){let e=this.bbox(),i=t.bbox(),r=iA(e,i);if(null===r)return null;let n=this.leftSE.point,a=this.rightSE.point,s=t.leftSE.point,o=t.rightSE.point,l=iI(e,s)&&0===this.comparePoint(s),h=iI(i,n)&&0===t.comparePoint(n),p=iI(e,o)&&0===this.comparePoint(o),u=iI(i,a)&&0===t.comparePoint(a);if(h&&l)return u&&!p?a:!u&&p?o:null;if(h)return p&&n.x.eq(o.x)&&n.y.eq(o.y)?null:n;if(l)return u&&a.x.eq(s.x)&&a.y.eq(s.y)?null:s;if(u&&p)return null;if(u)return a;if(p)return o;let c=iK(n,this.vector(),s,t.vector());return null!==c&&iI(r,c)?iO.snap(c):null}split(e){let i=[],r=void 0!==e.events,n=new iq(e,!0),a=new iq(e,!1),s=this.rightSE;this.replaceRightSE(a),i.push(a),i.push(n);let o=new t(n,s,this.rings.slice(),this.windings.slice());return iq.comparePoints(o.leftSE.point,o.rightSE.point)>0&&o.swapEvents(),iq.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(n.checkForConsuming(),a.checkForConsuming()),i}swapEvents(){let t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,e=this.windings.length;t<e;t++)this.windings[t]*=-1}consume(e){let i=this,r=e;for(;i.consumedBy;)i=i.consumedBy;for(;r.consumedBy;)r=r.consumedBy;let n=t.compare(i,r);if(0!==n){if(n>0){let t=i;i=r,r=t}if(i.prev===r){let t=i;i=r,r=t}for(let t=0,e=r.rings.length;t<e;t++){let e=r.rings[t],n=r.windings[t],a=i.rings.indexOf(e);-1===a?(i.rings.push(e),i.windings.push(n)):i.windings[a]+=n}r.rings=null,r.windings=null,r.consumedBy=i,r.leftSE.consumedBy=i.leftSE,r.rightSE.consumedBy=i.rightSE}}prevInResult(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}beforeState(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){let t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}afterState(){if(void 0!==this._afterState)return this._afterState;let t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};let e=this._afterState.rings,i=this._afterState.windings,r=this._afterState.multiPolys;for(let t=0,r=this.rings.length;t<r;t++){let r=this.rings[t],n=this.windings[t],a=e.indexOf(r);-1===a?(e.push(r),i.push(n)):i[a]+=n}let n=[],a=[];for(let t=0,r=e.length;t<r;t++){if(0===i[t])continue;let r=e[t],s=r.poly;if(-1===a.indexOf(s)){if(r.isExterior)n.push(s);else{-1===a.indexOf(s)&&a.push(s);let t=n.indexOf(r.poly);-1!==t&&n.splice(t,1)}}}for(let t=0,e=n.length;t<e;t++){let e=n[t].multiPoly;-1===r.indexOf(e)&&r.push(e)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;let t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(i2.type){case"union":{let i=0===t.length,r=0===e.length;this._isInResult=i!==r;break}case"intersection":{let i,r;t.length<e.length?(i=t.length,r=e.length):(i=e.length,r=t.length),this._isInResult=r===i2.numMultiPolys&&i<r;break}case"xor":{let i=Math.abs(t.length-e.length);this._isInResult=i%2==1;break}case"difference":{let i=t=>1===t.length&&t[0].isSubject;this._isInResult=i(t)!==i(e)}}return this._isInResult}},iX=class{poly;isExterior;segments;bbox;constructor(t,e,i){if(!Array.isArray(t)||0===t.length||(this.poly=e,this.isExterior=i,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1]))throw Error("Input geometry is not a valid Polygon or MultiPolygon");let r=iO.snap({x:new iv(t[0][0]),y:new iv(t[0][1])});this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};let n=r;for(let e=1,i=t.length;e<i;e++){if("number"!=typeof t[e][0]||"number"!=typeof t[e][1])throw Error("Input geometry is not a valid Polygon or MultiPolygon");let i=iO.snap({x:new iv(t[e][0]),y:new iv(t[e][1])});i.x.eq(n.x)&&i.y.eq(n.y)||(this.segments.push(iY.fromRing(n,i,this)),i.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.x),i.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.y),i.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.x),i.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.y),n=i)}r.x.eq(n.x)&&r.y.eq(n.y)||this.segments.push(iY.fromRing(n,r,this))}getSweepEvents(){let t=[];for(let e=0,i=this.segments.length;e<i;e++){let i=this.segments[e];t.push(i.leftSE),t.push(i.rightSE)}return t}},i$=class{multiPoly;exteriorRing;interiorRings;bbox;constructor(t,e){if(!Array.isArray(t))throw Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new iX(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let e=1,i=t.length;e<i;e++){let i=new iX(t[e],this,!1);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=e}getSweepEvents(){let t=this.exteriorRing.getSweepEvents();for(let e=0,i=this.interiorRings.length;e<i;e++){let i=this.interiorRings[e].getSweepEvents();for(let e=0,r=i.length;e<r;e++)t.push(i[e])}return t}},iJ=class{isSubject;polys;bbox;constructor(t,e){if(!Array.isArray(t))throw Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:new iv(Number.POSITIVE_INFINITY),y:new iv(Number.POSITIVE_INFINITY)},ur:{x:new iv(Number.NEGATIVE_INFINITY),y:new iv(Number.NEGATIVE_INFINITY)}};for(let e=0,i=t.length;e<i;e++){let i=new i$(t[e],this);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=e}getSweepEvents(){let t=[];for(let e=0,i=this.polys.length;e<i;e++){let i=this.polys[e].getSweepEvents();for(let e=0,r=i.length;e<r;e++)t.push(i[e])}return t}},iZ=class t{events;poly;_isExteriorRing;_enclosingRing;static factory(e){let i=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];if(!n.isInResult()||n.ringOut)continue;let a=null,s=n.leftSE,o=n.rightSE,l=[s],h=s.point,p=[];for(;a=s,s=o,l.push(s),s.point!==h;)for(;;){let e=s.getAvailableLinkedEvents();if(0===e.length){let t=l[0].point,e=l[l.length-1].point;throw Error(`Unable to complete output ring starting at [${t.x}, ${t.y}]. Last matching segment found ends at [${e.x}, ${e.y}].`)}if(1===e.length){o=e[0].otherSE;break}let r=null;for(let t=0,e=p.length;t<e;t++)if(p[t].point===s.point){r=t;break}if(null!==r){let e=p.splice(r)[0],n=l.splice(e.index);n.unshift(n[0].otherSE),i.push(new t(n.reverse()));continue}p.push({index:l.length,point:s.point});let n=s.getLeftmostComparator(a);o=e.sort(n)[0].otherSE;break}i.push(new t(l))}return i}constructor(t){this.events=t;for(let e=0,i=t.length;e<i;e++)t[e].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point,e=[t];for(let i=1,r=this.events.length-1;i<r;i++){let r=this.events[i].point,n=this.events[i+1].point;0!==iO.orient(r,t,n)&&(e.push(r),t=r)}if(1===e.length)return null;let i=e[0],r=e[1];0===iO.orient(i,t,r)&&e.shift(),e.push(e[0]);let n=this.isExteriorRing()?1:-1,a=this.isExteriorRing()?0:e.length-1,s=this.isExteriorRing()?e.length:-1,o=[];for(let t=a;t!=s;t+=n)o.push([e[t].x.toNumber(),e[t].y.toNumber()]);return o}isExteriorRing(){if(void 0===this._isExteriorRing){let t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}enclosingRing(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let e=1,i=this.events.length;e<i;e++){let i=this.events[e];iq.compare(t,i)>0&&(t=i)}let e=t.segment.prevInResult(),i=e?e.prevInResult():null;for(;;){if(!e)return null;if(!i)return e.ringOut;if(i.ringOut!==e.ringOut)return i.ringOut?.enclosingRing()!==e.ringOut?e.ringOut:e.ringOut?.enclosingRing();i=(e=i.prevInResult())?e.prevInResult():null}}},iW=class{exteriorRing;interiorRings;constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){let t=this.exteriorRing.getGeom();if(null===t)return null;let e=[t];for(let t=0,i=this.interiorRings.length;t<i;t++){let i=this.interiorRings[t].getGeom();null!==i&&e.push(i)}return e}},iQ=class{rings;polys;constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){let t=[];for(let e=0,i=this.polys.length;e<i;e++){let i=this.polys[e].getGeom();null!==i&&t.push(i)}return t}_composePolys(t){let e=[];for(let i=0,r=t.length;i<r;i++){let r=t[i];if(!r.poly){if(r.isExteriorRing())e.push(new iW(r));else{let t=r.enclosingRing();t?.poly||e.push(new iW(t)),t?.poly?.addInterior(r)}}}return e}},i0=class{queue;tree;segments;constructor(t,e=iY.compare){this.queue=t,this.tree=new iP(e),this.segments=[]}process(t){let e=t.segment,i=[];if(t.consumedBy)return t.isLeft?this.queue.delete(t.otherSE):this.tree.delete(e),i;t.isLeft&&this.tree.add(e);let r=e,n=e;do r=this.tree.lastBefore(r);while(null!=r&&null!=r.consumedBy);do n=this.tree.firstAfter(n);while(null!=n&&null!=n.consumedBy);if(t.isLeft){let a=null;if(r){let t=r.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(a=t),!r.isAnEndpoint(t))){let e=this._splitSafely(r,t);for(let t=0,r=e.length;t<r;t++)i.push(e[t])}}let s=null;if(n){let t=n.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(s=t),!n.isAnEndpoint(t))){let e=this._splitSafely(n,t);for(let t=0,r=e.length;t<r;t++)i.push(e[t])}}if(null!==a||null!==s){let t=null;t=null===a?s:null===s?a:0>=iq.comparePoints(a,s)?a:s,this.queue.delete(e.rightSE),i.push(e.rightSE);let r=e.split(t);for(let t=0,e=r.length;t<e;t++)i.push(r[t])}i.length>0?(this.tree.delete(e),i.push(t)):(this.segments.push(e),e.prev=r)}else{if(r&&n){let t=r.getIntersection(n);if(null!==t){if(!r.isAnEndpoint(t)){let e=this._splitSafely(r,t);for(let t=0,r=e.length;t<r;t++)i.push(e[t])}if(!n.isAnEndpoint(t)){let e=this._splitSafely(n,t);for(let t=0,r=e.length;t<r;t++)i.push(e[t])}}}this.tree.delete(e)}return i}_splitSafely(t,e){this.tree.delete(t);let i=t.rightSE;this.queue.delete(i);let r=t.split(e);return r.push(i),void 0===t.consumedBy&&this.tree.add(t),r}},i1=new class{type;numMultiPolys;run(t,e,i){i1.type=t;let r=[new iJ(e,!0)];for(let t=0,e=i.length;t<e;t++)r.push(new iJ(i[t],!1));if(i1.numMultiPolys=r.length,"difference"===i1.type){let t=r[0],e=1;for(;e<r.length;)null!==iA(r[e].bbox,t.bbox)?e++:r.splice(e,1)}if("intersection"===i1.type)for(let t=0,e=r.length;t<e;t++){let e=r[t];for(let i=t+1,n=r.length;i<n;i++)if(null===iA(e.bbox,r[i].bbox))return[]}let n=new iP(iq.compare);for(let t=0,e=r.length;t<e;t++){let e=r[t].getSweepEvents();for(let t=0,i=e.length;t<i;t++)n.add(e[t])}let a=new i0(n),s=null;for(0!=n.size&&(s=n.first(),n.delete(s));s;){let t=a.process(s);for(let e=0,i=t.length;e<i;e++){let i=t[e];void 0===i.consumedBy&&n.add(i)}0!=n.size?(s=n.first(),n.delete(s)):s=null}return iO.reset(),new iQ(iZ.factory(a.segments)).getGeom()}},i2=i1,i4=(t,...e)=>i2.run("intersection",t,e),i3=(t,...e)=>i2.run("difference",t,e);function i5(t){let e={type:"Feature"};return e.geometry=t,e}function i8(t){return"Feature"===t.type?t.geometry:t}function i6(t){return t&&t.geometry&&t.geometry.coordinates?t.geometry.coordinates:t}function i9(t){return i5({type:"Polygon",coordinates:t})}function i7(t){return i5({type:"MultiPolygon",coordinates:t})}iO.set,eR.Cut=eR.Polygon.extend({initialize(t){this._map=t,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let t=this._layer.getLatLngs();if(t.length<=2)return;let e=L.polygon(t,this.options.pathOptions);e._latlngInfos=this._layer._latlngInfo,this.cut(e),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:t,originalLayer:e})=>{this._fireCut(e,t,e),this._fireCut(this._map,t,e),e.pm._fireEdit()}),this._editedLayers=[];let i=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(i))},cut(t){let e=this._map._layers,i=t._latlngInfos||[];Object.keys(e).map(t=>e[t]).filter(t=>t.pm).filter(t=>!t._pmTempLayer).filter(t=>!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore).filter(t=>t instanceof L.Polyline).filter(e=>e!==t).filter(t=>t.pm.options.allowCutting).filter(t=>!(this.options.layersToCut&&L.Util.isArray(this.options.layersToCut))||!(this.options.layersToCut.length>0)||this.options.layersToCut.indexOf(t)>-1).filter(t=>!this._layerGroup.hasLayer(t)).filter(e=>{try{var i,r;let n,a,s,o=!!eZ(t.toGeoJSON(15),e.toGeoJSON(15)).features.length>0;return o||e instanceof L.Polyline&&!(e instanceof L.Polygon)?o:(i=t.toGeoJSON(15),r=e.toGeoJSON(15),n=i8(i),a=i8(r),s=i4(n.coordinates,a.coordinates),0!==s.length&&(1===s.length?!!i9(s[0]):!!i7(s)))}catch{return e instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(e=>{let r;if(e instanceof L.Polygon){let t=(r=L.polygon(e.getLatLngs())).getLatLngs();i.forEach(e=>{if(e&&e.snapInfo){let{latlng:i}=e,n=this._calcClosestLayer(i,[r]);if(n&&n.segment&&n.distance<this.options.snapDistance){let{segment:e}=n;if(e&&2===e.length){let{indexPath:r,parentPath:n,newIndex:a}=L.PM.Utils._getIndexFromSegment(t,e);(r.length>1?(0,is.default)(t,n):t).splice(a,0,i)}}}})}else r=e;let n=this._cutLayer(t,r),a=L.geoJSON(n,e.options);1===a.getLayers().length&&([a]=a.getLayers()),this._setPane(a,"layerPane");let s=a.addTo(this._map.pm._getContainingLayer());if(s.pm.enable(e.pm.options),s.pm.disable(),e._pmTempLayer=!0,t._pmTempLayer=!0,e.remove(),e.removeFrom(this._map.pm._getContainingLayer()),t.remove(),t.removeFrom(this._map.pm._getContainingLayer()),s.getLayers&&0===s.getLayers().length&&this._map.pm.removeLayer({target:s}),s instanceof L.LayerGroup&&s.eachLayer(t=>{this._addDrawnLayerProp(t)}),this._addDrawnLayerProp(s),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let t=this.options.layersToCut.indexOf(e);t>-1&&this.options.layersToCut.splice(t,1)}this._editedLayers.push({layer:s,originalLayer:e})})},_cutLayer(t,e){var i,r,n;let a=L.geoJSON(),s;if(e instanceof L.Polygon){let n,a,o;i=e.toGeoJSON(15),r=t.toGeoJSON(15),n=i8(i),a=i8(r),s=0===(o=i3(n.coordinates,a.coordinates)).length?null:1===o.length?i9(o[0]):i7(o)}else{let i,r,o,l;let h=((n=e)instanceof L.Polyline&&(n=n.toGeoJSON(15)),r=function t(e){return Array.isArray(e)?1+t(e[0]):-1}(i=i6(n)),o=[],r>1?i.forEach(t=>{o.push(i5({type:"LineString",coordinates:t}))}):o.push(n),o);h.forEach(e=>{let i=e7(e,t.toGeoJSON(15)),r;(i&&i.features.length>0?L.geoJSON(i):L.geoJSON(e)).getLayers().forEach(e=>{(function(t,e){var i=eV(t),r=eV(e),n=i.type,a=r.type,s=i.coordinates,o=r.coordinates;switch(n){case"Point":if("Point"===a)return ia(s,o);throw Error("feature2 "+a+" geometry not supported");case"MultiPoint":switch(a){case"Point":return function(t,e){var i,r=!1;for(i=0;i<t.coordinates.length;i++)if(ia(t.coordinates[i],e.coordinates)){r=!0;break}return r}(i,r);case"MultiPoint":return function(t,e){for(var i=0,r=e.coordinates;i<r.length;i++){for(var n=r[i],a=!1,s=0,o=t.coordinates;s<o.length;s++)if(ia(n,o[s])){a=!0;break}if(!a)return!1}return!0}(i,r);default:throw Error("feature2 "+a+" geometry not supported")}case"LineString":switch(a){case"Point":return ii(r,i,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var i=!1,r=0,n=e.coordinates;r<n.length;r++){var a=n[r];if(ii({type:"Point",coordinates:a},t,{ignoreEndVertices:!0})&&(i=!0),!ii({type:"Point",coordinates:a},t,{ignoreEndVertices:!1}))return!1}return i}(i,r);case"MultiPoint":return function(t,e){for(var i=!1,r=0,n=e.coordinates;r<n.length;r++){var a=n[r];if(ii(a,t,{ignoreEndVertices:!0})&&(i=!0),!ii(a,t))return!1}return!!i}(i,r);default:throw Error("feature2 "+a+" geometry not supported")}case"Polygon":switch(a){case"Point":return it(r,i,{ignoreBoundary:!0});case"LineString":return function(t,e){var i,r,n=!1,a=0;if(!ir(e1(t),e1(e)))return!1;for(;a<e.coordinates.length-1;a++){if(it({type:"Point",coordinates:(i=e.coordinates[a],r=e.coordinates[a+1],[(i[0]+r[0])/2,(i[1]+r[1])/2])},t,{ignoreBoundary:!0})){n=!0;break}}return n}(i,r);case"Polygon":return function(t,e){if("Feature"===t.type&&null===t.geometry||"Feature"===e.type&&null===e.geometry||!ir(e1(t),e1(e)))return!1;for(var i=eV(e).coordinates,r=0;r<i.length;r++)for(var n=i[r],a=0;a<n.length;a++)if(!it(n[a],t))return!1;return!0}(i,r);case"MultiPoint":return function(t,e){for(var i=0,r=e.coordinates;i<r.length;i++)if(!it(r[i],t,{ignoreBoundary:!0}))return!1;return!0}(i,r);default:throw Error("feature2 "+a+" geometry not supported")}default:throw Error("feature1 "+n+" geometry not supported")}})(t.toGeoJSON(15),e.toGeoJSON(15))||e.addTo(a)})}),s=h.length>1?(l=[],a.eachLayer(t=>{l.push(i6(t.toGeoJSON(15)))}),i5({type:"MultiLineString",coordinates:l})):a.toGeoJSON(15)}return s},_change:L.Util.falseFn}),eR.Text=eR.extend({initialize(t){this._map=t,this._shape="Text",this.toolbarButtonName="drawText"},enable(t){L.Util.setOptions(this,t),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(em("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),this._hintMarker?.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.off("mousemove",this._showHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_syncHintMarker(t){this._hintMarker.setLatLng(t.latlng),this.options.snappable&&(t.target=this._hintMarker,this._handleSnapping(t))},_createMarker(t){if(!t.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),this.options.textOptions?.className){let t=this.options.textOptions.className.split(" ");this.textArea.classList.add(...t)}let i=this._createTextIcon(this.textArea),r=new L.Marker(e,{textMarker:!0,_textMarkerOverPM:!0,icon:i});if(this._setPane(r,"markerPane"),this._finishLayer(r),r.pm||(r.options.draggable=!1),r.addTo(this._map.pm._getContainingLayer()),r.pm){r.pm.textArea=this.textArea,L.setOptions(r.pm,{removeIfEmpty:this.options.textOptions?.removeIfEmpty??!0});let t=this.options.textOptions?.focusAfterDraw??!0;r.pm._createTextMarker(t),this.options.textOptions?.text&&r.pm.setText(this.options.textOptions.text)}this._fireCreate(r),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this._map.once("mousemove",this._showHintMarkerAfterMoving,this)},_showHintMarkerAfterMoving(t){this.enable(),this._hintMarker.setLatLng(t.latlng)},_createTextArea(){let t=document.createElement("textarea");return t.readOnly=!0,t.classList.add("pm-textarea","pm-disabled"),t},_createTextIcon:t=>L.divIcon({className:"pm-text-marker",html:t})});var rt=d(en());function re(t,e){e instanceof L.Layer&&(e=e.getLatLng());let i=t.getMaxZoom();return i===1/0&&(i=t.getZoom()),t.project(e,i)}function ri(t,e){let i=t.getMaxZoom();return i===1/0&&(i=t.getZoom()),t.unproject(e,i)}var rr=L.Class.extend({includes:[{enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,eC(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let t=this._getDOMElem();t&&(eC(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(t)):L.DomEvent.on(t,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,eC(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let t=this._getDOMElem();t&&(eC(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(t)):L.DomEvent.off(t,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(t){let e=t.touches?t.touches[0]:t,i={originalEvent:e,target:this._layer};return i.containerPoint=this._map.mouseEventToContainerPoint(e),i.latlng=this._map.containerPointToLatLng(i.containerPoint),this._dragMixinOnMouseDown(i),!1},_simulateMouseMoveEvent(t){let e=t.touches?t.touches[0]:t,i={originalEvent:e,target:this._layer};return i.containerPoint=this._map.mouseEventToContainerPoint(e),i.latlng=this._map.containerPointToLatLng(i.containerPoint),this._dragMixinOnMouseMove(i),!1},_simulateMouseUpEvent(t){let e={originalEvent:t.touches?t.touches[0]:t,target:this._layer};return -1===t.type.indexOf("touch")&&(e.containerPoint=this._map.mouseEventToContainerPoint(t),e.latlng=this._map.containerPointToLatLng(e.containerPoint)),this._dragMixinOnMouseUp(e),!1},_dragMixinOnMouseDown(t){if(t.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(t);let e=t._fromLayerSync,i=this._syncLayers("_dragMixinOnMouseDown",t);if(this._layer instanceof L.Marker&&(!this.options.snappable||e||i?this._disableSnapping():this._initSnappableMarkers()),this._layer instanceof L.CircleMarker){let t="resizeableCircleMarker";this._layer instanceof L.Circle&&(t="resizeableCircle"),!this.options.snappable||e||i?this._layer.pm.options[t]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag():this._layer.pm.options[t]||this._initSnappableMarkersDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=t.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(t){this._overwriteEventIfItComesFromMarker(t);let e=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",t),this._dragging||(this._dragging=!0,L.DomUtil.addClass(e,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=t.latlng),this._onLayerDrag(t),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(t){let e=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",t),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),!!this._dragging&&(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,e&&L.DomUtil.removeClass(e,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0)},_onLayerDrag(t){let{latlng:e}=t,i={lat:e.lat-this._tempDragCoord.lat,lng:e.lng-this._tempDragCoord.lng},r=t=>t.map(t=>{if(Array.isArray(t))return r(t);let e={lat:t.lat+i.lat,lng:t.lng+i.lng};return(t.alt||0===t.alt)&&(e.alt=t.alt),e});if(this._layer instanceof L.Circle&&this._layer.options.resizeableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let t=r([this._layer.getLatLng()]);this._layer.setLatLng(t[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let t=this._layer.getLatLng();this._layer._snapped&&(t=this._layer._orgLatLng);let e=r([t]);this._layer.setLatLng(e[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let t=r([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(t),this._fireChange(this._layer.getBounds(),"Edit")}else{let t=r(this._layer.getLatLngs());this._layer.setLatLngs(t),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=e,t.layer=this._layer,this._fireDrag(t)},addDraggingClass(){let t=this._getDOMElem();t&&L.DomUtil.addClass(t,"leaflet-pm-draggable")},removeDraggingClass(){let t=this._getDOMElem();t&&L.DomUtil.removeClass(t,"leaflet-pm-draggable")},_getDOMElem(){let t=null;return this._layer._path?t=this._layer._path:this._layer._renderer&&this._layer._renderer._container?t=this._layer._renderer._container:this._layer._image?t=this._layer._image:this._layer._icon&&(t=this._layer._icon),t},_overwriteEventIfItComesFromMarker(t){t.target.getLatLng&&(!t.target._radius||t.target._radius<=10)&&(t.containerPoint=this._map.mouseEventToContainerPoint(t.originalEvent),t.latlng=this._map.containerPointToLatLng(t.containerPoint))},_syncLayers(t,e){if(this.enabled())return!1;if(!e._fromLayerSync&&this._layer===e.target&&this.options.syncLayersOnDrag){e._fromLayerSync=!0;let i=[];if(L.Util.isArray(this.options.syncLayersOnDrag))i=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(t=>{t instanceof L.LayerGroup&&(i=i.concat(t.pm.getLayers(!0)))});else if(!0===this.options.syncLayersOnDrag&&this._parentLayerGroup)for(let t in this._parentLayerGroup){let e=this._parentLayerGroup[t];e.pm&&(i=e.pm.getLayers(!0))}return L.Util.isArray(i)&&i.length>0&&(i=i.filter(t=>!!t.pm).filter(t=>!!t.pm.options.draggable)).forEach(i=>{i!==this._layer&&i.pm[t]&&(i._snapped=!1,i.pm[t](e))}),i.length>0}return!1},_stopDOMImageDrag:t=>(t.preventDefault(),!1)},eB,{_onRotateStart(t){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=re(this._map,this._rotationOriginLatLng),this._rotationStartPoint=re(this._map,t.target.getLatLng()),this._initialRotateLatLng=ev(this._layer),this._startAngle=this.getAngle();let e=ev(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,e),this._fireRotationStart(this._map,e)},_onRotate(t){let e=re(this._map,t.target.getLatLng()),i=this._rotationStartPoint,r=this._rotationOriginPoint,n=Math.atan2(e.y-r.y,e.x-r.x)-Math.atan2(i.y-r.y,i.x-r.x);this._layer.setLatLngs(this._rotateLayer(n,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let a=this;!function t(e,i=[],r=-1){if(r>-1&&i.push(r),L.Util.isArray(e[0]))e.forEach((e,r)=>t(e,i.slice(),r));else{let t=i.length>0?(0,rt.default)(a._markers,i):a._markers[0];e.forEach((e,i)=>{t[i].setLatLng(e)})}}(this._layer.getLatLngs());let s=ev(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(n,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let o=180*n/Math.PI,l=(o=o<0?o+360:o)+this._startAngle;this._setAngle(l),this._rotationLayer.pm._setAngle(l),this._fireRotation(this._rotationLayer,o,s),this._fireRotation(this._map,o,s),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let t=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let e=ev(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=ev(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,t,e),this._fireRotationEnd(this._map,t,e),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(t,e,i,r,n){let a=re(n,i);return this._matrix=r.clone().rotate(t,a).flip(),function t(e,i,r){var n;let a=r.getMaxZoom();if(a===1/0&&(a=r.getZoom()),L.Util.isArray(e)){let n=[];return e.forEach(e=>{n.push(t(e,i,r))}),n}return e instanceof L.LatLng?(n=a,r.unproject(i.transform(r.project(e,n)),n)):null}(e,this._matrix,n)},_setAngle(t){t=t<0?t+360:t,this._angle=t%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let t=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),e=t.getCenter();return t.removeFrom(this._layer._map),e},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&void 0===this._angle&&this.setInitAngle(ek(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0),this._rotatePoly=L.polygon(this._layer.getLatLngs(),{fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0}),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=ev(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(t){let e=this.getAngle(),i=this._layer.getLatLngs(),r=Math.PI/180*t;this._layer.setLatLngs(this._rotateLayer(r,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+t),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(r,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let n=this.getAngle()-e;n=n<0?n+360:n,this._startAngle=e,this._fireRotation(this._layer,n,i,this._layer),this._fireRotation(this._map||this._layer._map,n,i,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(t){let e=t-this.getAngle();this.rotateLayer(e)},getAngle(){return this._angle||0},setInitAngle(t){this._setAngle(t)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(t){this._rotationCenter=t,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(t)}},eg],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizeableCircle:!0,snapMiddle:!1,snapVertex:!0},setOptions(t){L.Util.setOptions(this,t)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(t,e){"layerPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":"vertexPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":"markerPane"===e&&(t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(t,e){let i=e.target,r={layer:this._layer,marker:i,event:e},n="";return"move"===t?n="moveVertexValidation":"add"===t?n="addVertexValidation":"remove"===t&&(n="removeVertexValidation"),this.options[n]&&"function"==typeof this.options[n]&&!this.options[n](r)?("move"===t&&(i._cancelDragEventChain=i.getLatLng()),!1):(i._cancelDragEventChain=null,!0)},_vertexValidationDrag:t=>!t._cancelDragEventChain||(t._latlng=t._cancelDragEventChain,t.update(),!1),_vertexValidationDragEnd:t=>!t._cancelDragEventChain||(t._cancelDragEventChain=null,!1)});rr.LayerGroup=L.Class.extend({initialize(t){this._layerGroup=t,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(t=>this._initLayer(t)),this._layerGroup.on("layeradd",L.Util.throttle(t=>{if(t.layer._pmTempLayer)return;this._layers=this.getLayers();let e=this._layers.filter(t=>!t.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in t.pm._parentLayerGroup));e.forEach(t=>{this._initLayer(t)}),e.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())},100,this),this),this._layerGroup.on("layerremove",t=>{this._removeLayerFromGroup(t.target)},this),this._layerGroup.on("layerremove",L.Util.throttle(t=>{t.target._pmTempLayer||(this._layers=this.getLayers())},100,this),this)},enable(t,e=[]){0===e.length&&(this._layers=this.getLayers()),this._options=t,this._layers.forEach(i=>{i instanceof L.LayerGroup?-1===e.indexOf(i._leaflet_id)&&(e.push(i._leaflet_id),i.pm.enable(t,e)):i.pm.enable(t)})},disable(t=[]){0===t.length&&(this._layers=this.getLayers()),this._layers.forEach(e=>{e instanceof L.LayerGroup?-1===t.indexOf(e._leaflet_id)&&(t.push(e._leaflet_id),e.pm.disable(t)):e.pm.disable()})},enabled(t=[]){return 0===t.length&&(this._layers=this.getLayers()),!!this._layers.find(e=>e instanceof L.LayerGroup?-1===t.indexOf(e._leaflet_id)&&(t.push(e._leaflet_id),e.pm.enabled(t)):e.pm.enabled())},toggleEdit(t,e=[]){0===e.length&&(this._layers=this.getLayers()),this._options=t,this._layers.forEach(i=>{i instanceof L.LayerGroup?-1===e.indexOf(i._leaflet_id)&&(e.push(i._leaflet_id),i.pm.toggleEdit(t,e)):i.pm.toggleEdit(t)})},_initLayer(t){let e=L.Util.stamp(this._layerGroup);t.pm._parentLayerGroup||(t.pm._parentLayerGroup={}),t.pm._parentLayerGroup[e]=this._layerGroup},_removeLayerFromGroup(t){if(t.pm&&t.pm._layerGroup){let e=L.Util.stamp(this._layerGroup);delete t.pm._layerGroup[e]}},dragging(){return this._layers=this.getLayers(),!!this._layers&&!!this._layers.find(t=>t.pm.dragging())},getOptions(){return this.options},_getMap(){return this._map||this._layers.find(t=>!!t._map)?._map||null},getLayers(t=!1,e=!0,i=!0,r=[]){let n=[];return t?this._layerGroup.getLayers().forEach(t=>{n.push(t),t instanceof L.LayerGroup&&-1===r.indexOf(t._leaflet_id)&&(r.push(t._leaflet_id),n=n.concat(t.pm.getLayers(!0,!0,!0,r)))}):n=this._layerGroup.getLayers(),i&&(n=n.filter(t=>!(t instanceof L.LayerGroup))),e&&(n=(n=(n=n.filter(t=>!!t.pm)).filter(t=>!t._pmTempLayer)).filter(t=>!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)),n},setOptions(t,e=[]){0===e.length&&(this._layers=this.getLayers()),this.options=t,this._layers.forEach(i=>{i.pm&&(i instanceof L.LayerGroup?-1===e.indexOf(i._leaflet_id)&&(e.push(i._leaflet_id),i.pm.setOptions(t,e)):i.pm.setOptions(t))})}}),rr.Marker=rr.extend({_shape:"Marker",initialize(t){this._layer=t,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(t={draggable:!0}){if(L.Util.setOptions(this,t),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(t){let e=t.target;e.remove(),this._fireRemove(e),this._fireRemove(this._map,e)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)}});var rn=d(en());rr.Line=rr.extend({includes:[{filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let t=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=t.filter((t,e,i)=>i.indexOf(t)===e)},_removeFromCache(t){let e=this.markerCache.indexOf(t);e>-1&&this.markerCache.splice(e,1)},renderLimits(t){this.markerCache.forEach(e=>{t.includes(e)?this._markerGroup.addLayer(e):this._markerGroup.removeLayer(e)})},applyLimitFilters({latlng:t={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let e=[...this._filterClosestMarkers(t)];this.renderLimits(e)},_filterClosestMarkers(t){let e=[...this.markerCache],i=this.options.limitMarkersToCount;return -1===i?e:(e.sort((e,i)=>e._latlng.distanceTo(t)-i._latlng.distanceTo(t)),e.filter((t,e)=>!(i>-1)||e<i))},_preventRenderMarkers:!1,_preventRenderingMarkers(t){this._preventRenderMarkers=!!t}}],_shape:"Line",initialize(t){this._layer=t,this._enabled=!1},enable(t){if(L.Util.setOptions(this,t),this._map=this._layer._map,this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:("#f00000ff"!==this._layer.options.color?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(t,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(t){return this.enabled()?this.disable():this.enable(t),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let t=this._map,e=this._layer.getLatLngs();this._markerGroup&&(this._markerGroup.removeFrom(t),this._markerGroup.clearLayers()),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let i=t=>{if(Array.isArray(t[0]))return t.map(i,this);let e=t.map(this._createMarker,this);return!0!==this.options.hideMiddleMarkers&&t.map((i,r)=>{let n=this.isPolygon()?(r+1)%t.length:r+1;return this._createMiddleMarker(e[r],e[n])}),e};this._markers=i(e),this.filterMarkerGroup(),t.addLayer(this._markerGroup)},_createMarker(t){let e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this.options.rotate?(e.on("dragstart",this._onRotateStart,this),e.on("drag",this._onRotate,this),e.on("dragend",this._onRotateEnd,this)):(e.on("click",this._onVertexClick,this),e.on("dragstart",this._onMarkerDragStart,this),e.on("move",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||e.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(e),e},_createMiddleMarker(t,e){if(!t||!e)return!1;let i=L.PM.Utils.calcMiddleLatLng(this._map,t.getLatLng(),e.getLatLng()),r=this._createMarker(i),n=L.divIcon({className:"marker-icon marker-icon-middle"});return r.setIcon(n),r.leftM=t,r.rightM=e,t._middleMarkerNext=r,e._middleMarkerPrev=r,r.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),r.on("movestart",this._onMiddleMarkerMoveStart,this),r},_onMiddleMarkerClick(t){let e=t.target;if(!this._vertexValidation("add",t))return;let i=L.divIcon({className:"marker-icon"});e.setIcon(i),this._addMarker(e,e.leftM,e.rightM)},_onMiddleMarkerMoveStart(t){let e=t.target;if(e.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",t)){e.on("move",this._onMiddleMarkerMovePrevent,this);return}e._dragging=!0,this._addMarker(e,e.leftM,e.rightM)},_onMiddleMarkerMovePrevent(t){let e=t.target;this._vertexValidationDrag(e)},_onMiddleMarkerMoveEnd(t){let e=t.target;if(e.off("move",this._onMiddleMarkerMovePrevent,this),e.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(e))return;let i=L.divIcon({className:"marker-icon"});e.setIcon(i),setTimeout(()=>{delete e._dragging},100)},_addMarker(t,e,i){t.off("movestart",this._onMiddleMarkerMoveStart,this),t.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let r=t.getLatLng(),n=this._layer._latlngs;delete t.leftM,delete t.rightM;let{indexPath:a,index:s,parentPath:o}=L.PM.Utils.findDeepMarkerIndex(this._markers,e),l=a.length>1?(0,rn.default)(n,o):n,h=a.length>1?(0,rn.default)(this._markers,o):this._markers;l.splice(s+1,0,r),h.splice(s+1,0,t),this._layer.setLatLngs(n),!0!==this.options.hideMiddleMarkers&&(this._createMiddleMarker(e,t),this._createMiddleMarker(t,i)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(t,L.PM.Utils.findDeepMarkerIndex(this._markers,t).indexPath,r),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return ez(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(t){let e=this._layer,i,r;if(i=!this.options.allowSelfIntersection&&(r=ez(this._layer.toGeoJSON(15))).features.length>0){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return i;t?this._flashLayer():(e.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(r)}else e.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return i},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(t,e){t.forEach(t=>{Array.isArray(t)?this._updateDisabledMarkerStyle(t,e):t._icon&&(e&&!this._checkMarkerAllowedToDrag(t)?L.DomUtil.addClass(t._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(t._icon,"vertexmarker-disabled"))})},_removeMarker(t){let e=t.target;if(!this._vertexValidation("remove",t))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=ev(this._layer,this._layer.getLatLngs()));let i=this._layer.getLatLngs(),{indexPath:r,index:n,parentPath:a}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);if(!r)return;let s=r.length>1?(0,rn.default)(i,a):i,o=r.length>1?(0,rn.default)(this._markers,a):this._markers,l=a[a.length-1]>0&&this._layer instanceof L.Polygon;if(!this.options.removeLayerBelowMinVertexCount&&!l&&(s.length<=2||this.isPolygon()&&s.length<=3)){this._flashLayer();return}s.splice(n,1),this._layer.setLatLngs(i),this.isPolygon()&&s.length<=2&&s.splice(0,s.length);let h=!1;if(s.length<=1&&(s.splice(0,s.length),a.length>1&&r.length>1&&(i=eL(i)),this._layer.setLatLngs(i),this._initMarkers(),h=!0),ey(i)||this._layer.remove(),i=eL(i),this._layer.setLatLngs(i),this._markers=eL(this._markers),!h&&(o=r.length>1?(0,rn.default)(this._markers,a):this._markers,e._middleMarkerPrev&&(this._markerGroup.removeLayer(e._middleMarkerPrev),this._removeFromCache(e._middleMarkerPrev)),e._middleMarkerNext&&(this._markerGroup.removeLayer(e._middleMarkerNext),this._removeFromCache(e._middleMarkerNext)),this._markerGroup.removeLayer(e),this._removeFromCache(e),o)){let t,e;if(this.isPolygon()?(t=(n+1)%o.length,e=(n+(o.length-1))%o.length):(e=n-1<0?void 0:n-1,t=n+1>=o.length?void 0:n+1),t!==e){let i=o[e],r=o[t];!0!==this.options.hideMiddleMarkers&&this._createMiddleMarker(i,r)}o.splice(n,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(e,r),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(t){let e=this._layer.getLatLngs(),i=t.getLatLng(),{indexPath:r,index:n,parentPath:a}=L.PM.Utils.findDeepMarkerIndex(this._markers,t);(r.length>1?(0,rn.default)(e,a):e).splice(n,1,i),this._layer.setLatLngs(e)},_getNeighborMarkers(t){let{indexPath:e,index:i,parentPath:r}=L.PM.Utils.findDeepMarkerIndex(this._markers,t),n=e.length>1?(0,rn.default)(this._markers,r):this._markers,a=(i+1)%n.length,s=(i+(n.length-1))%n.length;return{prevMarker:n[s],nextMarker:n[a]}},_checkMarkerAllowedToDrag(t){let{prevMarker:e,nextMarker:i}=this._getNeighborMarkers(t),r=L.polyline([e.getLatLng(),t.getLatLng()]),n=L.polyline([t.getLatLng(),i.getLatLng()]),a=eZ(this._layer.toGeoJSON(15),r.toGeoJSON(15)).features.length,s=eZ(this._layer.toGeoJSON(15),n.toGeoJSON(15)).features.length;return t.getLatLng()===this._markers[0][0].getLatLng()?s+=1:t.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(a+=1),!(a<=2&&s<=2)},_onMarkerDragStart(t){let e=t.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",t))return;let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireMarkerDragStart(t,i),this.options.allowSelfIntersection||(this._coordsBeforeEdit=ev(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(e):this._markerAllowedToDrag=null},_onMarkerDrag(t){let e=t.target;if(!this._vertexValidationDrag(e))return;let{indexPath:i,index:r,parentPath:n}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);if(!i)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&!1===this._markerAllowedToDrag){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(e);let a=i.length>1?(0,rn.default)(this._markers,n):this._markers,s=(r+1)%a.length,o=(r+(a.length-1))%a.length,l=e.getLatLng(),h=a[o].getLatLng(),p=a[s].getLatLng();if(e._middleMarkerNext){let t=L.PM.Utils.calcMiddleLatLng(this._map,l,p);e._middleMarkerNext.setLatLng(t)}if(e._middleMarkerPrev){let t=L.PM.Utils.calcMiddleLatLng(this._map,l,h);e._middleMarkerPrev.setLatLng(t)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(t,i),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(t){let e=t.target;if(!this._vertexValidationDragEnd(e))return;let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e),r=!this.options.allowSelfIntersection&&this.hasSelfIntersection();r&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(r=!1);let n=!this.options.allowSelfIntersection&&r;if(this._fireMarkerDragEnd(t,i,n),n){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(t,i);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(t){let e=t.target;if(e._dragging)return;let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireVertexClick(t,i)}}),rr.Polygon=rr.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(t){let{prevMarker:e,nextMarker:i}=this._getNeighborMarkers(t),r=L.polyline([e.getLatLng(),t.getLatLng()]),n=L.polyline([t.getLatLng(),i.getLatLng()]),a=eZ(this._layer.toGeoJSON(15),r.toGeoJSON(15)).features.length,s=eZ(this._layer.toGeoJSON(15),n.toGeoJSON(15)).features.length;return!(a<=2&&s<=2)}}),rr.Rectangle=rr.Polygon.extend({_shape:"Rectangle",_initMarkers(){let t=this._map,e=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,t.addLayer(this._markerGroup),this._markers=[],this._markers[0]=e.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((t,e)=>{let i=this._cornerMarkers.find(t=>t._index===e);i&&i.setLatLng(t)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(t,e){let i=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(i,"vertexPane"),i._origLatLng=t,i._index=e,i._pmTempLayer=!0,i.on("click",this._onVertexClick,this),this._markerGroup.addLayer(i),i},_addMarkerEvents(){this._markers[0].forEach(t=>{t.on("dragstart",this._onMarkerDragStart,this),t.on("drag",this._onMarkerDrag,this),t.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||t.on("contextmenu",this._removeMarker,this)})},_removeMarker:()=>null,_onMarkerDragStart(t){if(!this._vertexValidation("move",t))return;let e=t.target;e._oppositeCornerLatLng=this._cornerMarkers.find(t=>t._index===(e._index+2)%4).getLatLng(),e._snapped=!1;let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireMarkerDragStart(t,i)},_onMarkerDrag(t){let e=t.target;if(!this._vertexValidationDrag(e)||void 0===e._index)return;this._adjustRectangleForMarkerMove(e);let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireMarkerDrag(t,i),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(t){let e=t.target;if(!this._vertexValidationDragEnd(e))return;this._cornerMarkers.forEach(t=>{delete t._oppositeCornerLatLng});let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireMarkerDragEnd(t,i),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(t){L.extend(t._origLatLng,t._latlng);let e=L.PM.Utils._getRotatedRectangle(t.getLatLng(),t._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(e),this._adjustAllMarkers(t),this._layer.redraw()},_adjustAllMarkers(t){let e=this._layer.getLatLngs()[0];if(e&&4!==e.length&&e.length>0)e.forEach((t,e)=>{this._cornerMarkers[e].setLatLng(t)}),this._cornerMarkers.slice(e.length).forEach(t=>{t.setLatLng(e[0])});else if(e&&e.length){let i=e.findIndex(e=>t.getLatLng().equals(e));i>-1?(this._cornerMarkers[(t._index+1)%4].setLatLng(e[(i+1)%4]),this._cornerMarkers[(t._index+2)%4].setLatLng(e[(i+2)%4]),this._cornerMarkers[(t._index+3)%4].setLatLng(e[(i+3)%4])):this._cornerMarkers.forEach(t=>{t.setLatLng(e[t._index])})}else console.error("The layer has no LatLngs")},_findCorners(){void 0===this._angle&&this.setInitAngle(ek(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let t=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(t[0],t[2],this.getAngle(),this._map||this)}}),rr.CircleMarker=rr.extend({_shape:"CircleMarker",initialize(t){this._layer=t,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(t={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,t),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this._helperLayers&&(this._helperLayers.clearLayers(),this._helperLayers.removeFrom(this._map)),this.options[this._editableOption]?(this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let t=this._map;this._helperLayers&&(this._helperLayers.removeFrom(t),this._helperLayers.clearLayers()),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(t);let e=this._layer.getLatLng(),i=this._layer._radius,r=this._getLatLngOnCircle(e,i);this._centerMarker=this._createCenterMarker(e),this._outerMarker=this._createOuterMarker(r),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(t,e){let i=this._map.project(t),r=L.point(i.x+e,i.y);return this._map.unproject(r)},_createHintLine(t,e){let i=t.getLatLng(),r=e.getLatLng();this._hintline=L.polyline([i,r],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(t){let e=this._createMarker(t);return this.options.draggable?(L.DomUtil.addClass(e._icon,"leaflet-pm-draggable"),e.on("move",this._moveCircle,this)):e.dragging.disable(),e},_createOuterMarker(t){let e=this._createMarker(t);return e.on("drag",this._resizeCircle,this),e},_createMarker(t){let e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("drag",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),e.on("click",this._onVertexClick,this),this._helperLayers.addLayer(e),e},_moveCircle(t){if(t.target._cancelDragEventChain)return;let e=this._centerMarker.getLatLng();this._layer.setLatLng(e);let i=this._layer._radius,r=this._getLatLngOnCircle(e,i);this._outerMarker._latlng=r,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let t=this._layer.getLatLng(),e=this._layer._radius,i=this._getLatLngOnCircle(t,e);this._outerMarker.setLatLng(i),this._centerMarker.setLatLng(t),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),i=this._distanceCalculation(t,e);this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(i),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(t){this._vertexValidation("move",t)&&this._fireMarkerDragStart(t)},_onMarkerDrag(t){let e=t.target;e instanceof L.Marker&&!this._vertexValidationDrag(e)||this._fireMarkerDrag(t)},_onMarkerDragEnd(t){this._extedingMarkerDragEnd();let e=t.target;this._vertexValidationDragEnd(e)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(t))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let t=this._layer._map||this._map;if(t){let e=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),t,this._layer.getLatLng()),i=L.circle(this._layer.getLatLng(),this._layer.options);i.setRadius(e);let r=t&&t.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(i,200,!r).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(i,200,!r),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),i=this._distanceCalculation(t,e);return this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?e=eM(this._map,t,e,this._getMinDistanceInMeter(t)):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&(e=eM(this._map,t,e,this._getMaxDistanceInMeter(t))),e},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),i=this._distanceCalculation(t,e);this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(t,e){return this._map.project(t).distanceTo(this._map.project(e))},_getMinDistanceInMeter(t){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,t)},_getMaxDistanceInMeter(t){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,t)},_onVertexClick(t){t.target._dragging||this._fireVertexClick(t,void 0)}}),rr.Circle=rr.CircleMarker.extend({_shape:"Circle",initialize(t){this._layer=t,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._updateHiddenPolyCircle()},enable(t){L.PM.Edit.CircleMarker.prototype.enable.call(this,t||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(t,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let t=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!t).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!t),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(t,e){return this._map.distance(t,e)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(t){t.target._dragging||this._fireVertexClick(t,void 0)}}),rr.ImageOverlay=rr.extend({_shape:"ImageOverlay",initialize(t){this._layer=t,this._enabled=!1},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},enabled(){return this._enabled},enable(t={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,t),this._map=this._layer._map,this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}}),rr.Text=rr.extend({_shape:"Text",initialize(t){this._layer=t,this._enabled=!1},enable(t){if(L.Util.setOptions(this,t),this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let t=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),t.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let t=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,e=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${t}px`,this.textArea.style.width=`${e}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)},100)},_documentClick(t){t.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(t={}){let e=this._hasFocus;this._hasFocus="focus"===t.type,!e!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(t){t&&(this.textArea.value=t),this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let t=this.options.className.split(" ");this.textArea.classList.add(...t)}let t=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(t),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(t=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),!0===t&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(t){t.preventDefault()}});var ra=function(t,e,i,r,n,a){this._matrix=[t,e,i,r,n,a]};ra.init=()=>new L.PM.Matrix(1,0,0,1,0,0),ra.prototype={transform(t){return this._transform(t.clone())},_transform(t){let e=this._matrix,{x:i,y:r}=t;return t.x=e[0]*i+e[1]*r+e[4],t.y=e[2]*i+e[3]*r+e[5],t},untransform(t){let e=this._matrix;return new L.Point((t.x/e[0]-e[4])/e[0],(t.y/e[2]-e[5])/e[2])},clone(){let t=this._matrix;return new L.PM.Matrix(t[0],t[1],t[2],t[3],t[4],t[5])},translate(t){let e,i;return void 0===t?new L.Point(this._matrix[4],this._matrix[5]):("number"==typeof t?(e=t,i=t):(e=t.x,i=t.y),this._add(1,0,0,1,e,i))},scale(t,e){let i,r;return void 0===t?new L.Point(this._matrix[0],this._matrix[3]):(e=e||L.point(0,0),"number"==typeof t?(i=t,r=t):(i=t.x,r=t.y),this._add(i,0,0,r,e.x,e.y)._add(1,0,0,1,-e.x,-e.y))},rotate(t,e){let i=Math.cos(t),r=Math.sin(t);return e=e||new L.Point(0,0),this._add(i,r,-r,i,e.x,e.y)._add(1,0,0,1,-e.x,-e.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(t,e,i,r,n,a){let s=[[],[],[]],o=this._matrix,l=[[o[0],o[2],o[4]],[o[1],o[3],o[5]],[0,0,1]],h=[[t,i,n],[e,r,a],[0,0,1]],p;t&&t instanceof L.PM.Matrix&&(h=[[(o=t._matrix)[0],o[2],o[4]],[o[1],o[3],o[5]],[0,0,1]]);for(let t=0;t<3;t+=1)for(let e=0;e<3;e+=1){p=0;for(let i=0;i<3;i+=1)p+=l[t][i]*h[i][e];s[t][e]=p}return this._matrix=[s[0][0],s[1][0],s[0][1],s[1][1],s[0][2],s[1][2]],this}},L.PM=L.PM||{version:"2.18.3",Map:ew,Toolbar:eE,Draw:eR,Edit:rr,Utils:{calcMiddleLatLng(t,e,i){let r=t.project(e),n=t.project(i);return t.unproject(r._add(n)._divideBy(2))},findLayers(t){let e=[];return t.eachLayer(t=>{(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.Circle||t instanceof L.CircleMarker||t instanceof L.ImageOverlay)&&e.push(t)}),e=(e=(e=e.filter(t=>!!t.pm)).filter(t=>!t._pmTempLayer)).filter(t=>!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)},circleToPolygon(t,e=60,i=!0){let r=eb(t.getLatLng(),t.getRadius(),e,0,i),n=[];for(let t=0;t<r.length;t+=1){let e=[r[t].lat,r[t].lng];n.push(e)}return L.polygon(n,t.options)},disablePopup(t){t.getPopup()&&(t._tempPopupCopy=t.getPopup(),t.unbindPopup())},enablePopup(t){t._tempPopupCopy&&(t.bindPopup(t._tempPopupCopy),delete t._tempPopupCopy)},_fireEvent(t,e,i,r=!1){t.fire(e,i,r);let{groups:n}=this.getAllParentGroups(t);n.forEach(t=>{t.fire(e,i,r)})},getAllParentGroups(t){let e=[],i=[],r=t=>{for(let n in t._eventParents)if(-1===e.indexOf(n)){e.push(n);let a=t._eventParents[n];i.push(a),r(a)}};return!t._pmLastGroupFetch||!t._pmLastGroupFetch.time||new Date().getTime()-t._pmLastGroupFetch.time>1e3?(r(t),t._pmLastGroupFetch={time:new Date().getTime(),groups:i,groupIds:e},{groupIds:e,groups:i}):{groups:t._pmLastGroupFetch.groups,groupIds:t._pmLastGroupFetch.groupIds}},createGeodesicPolygon:eb,getTranslation:em,findDeepCoordIndex(t,e,i=!0){let r,n=t=>(a,s)=>{let o=t.concat(s);if(i){if(a.lat&&a.lat===e.lat&&a.lng===e.lng)return r=o,!0}else if(a.lat&&L.latLng(a).equals(e))return r=o,!0;return Array.isArray(a)&&a.some(n(o))};t.some(n([]));let a={};return r&&(a={indexPath:r,index:r[r.length-1],parentPath:r.slice(0,r.length-1)}),a},findDeepMarkerIndex(t,e){let i,r=t=>(n,a)=>{let s=t.concat(a);return n._leaflet_id===e._leaflet_id?(i=s,!0):Array.isArray(n)&&n.some(r(s))};t.some(r([]));let n={};return i&&(n={indexPath:i,index:i[i.length-1],parentPath:i.slice(0,i.length-1)}),n},_getIndexFromSegment(t,e){if(e&&2===e.length){let i=this.findDeepCoordIndex(t,e[0]),r=this.findDeepCoordIndex(t,e[1]),n=Math.max(i.index,r.index);return(0===i.index||0===r.index)&&1!==n&&(n+=1),{indexA:i,indexB:r,newIndex:n,indexPath:i.indexPath,parentPath:i.parentPath}}return null},_getRotatedRectangle(t,e,i,r){let n=re(r,t),a=re(r,e),s=i*Math.PI/180,o=Math.cos(s),l=Math.sin(s),h=(a.x-n.x)*o+(a.y-n.y)*l,p=(a.y-n.y)*o-(a.x-n.x)*l,u=h*o+n.x,c=h*l+n.y,d=-p*l+n.x,g=p*o+n.y;return[ri(r,n),ri(r,{x:u,y:c}),ri(r,a),ri(r,{x:d,y:g})]},pxRadiusToMeterRadius(t,e,i){let r=e.project(i),n=L.point(r.x+t,r.y);return e.distance(e.unproject(n),i)}},Matrix:ra,activeLang:"en",optIn:!1,initialize(t){this.addInitHooks(t)},setOptIn(t){this.optIn=!!t},addInitHooks(){L.Map.addInitHook(function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}),L.LayerGroup.addInitHook(function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}),L.Marker.addInitHook(function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}),L.CircleMarker.addInitHook(function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}),L.Polyline.addInitHook(function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}),L.Polygon.addInitHook(function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}),L.Rectangle.addInitHook(function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}),L.Circle.addInitHook(function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}),L.ImageOverlay.addInitHook(function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))})},reInitLayer(t){t instanceof L.LayerGroup&&t.eachLayer(t=>{this.reInitLayer(t)}),t.pm||L.PM.optIn&&!1!==t.options.pmIgnore||t.options.pmIgnore||(t instanceof L.Map?t.pm=new L.PM.Map(t):t instanceof L.Marker?t.options.textMarker?(t.pm=new L.PM.Edit.Text(t),t.pm._initTextMarker(),t.pm._createTextMarker(!1)):t.pm=new L.PM.Edit.Marker(t):t instanceof L.Circle?t.pm=new L.PM.Edit.Circle(t):t instanceof L.CircleMarker?t.pm=new L.PM.Edit.CircleMarker(t):t instanceof L.Rectangle?t.pm=new L.PM.Edit.Rectangle(t):t instanceof L.Polygon?t.pm=new L.PM.Edit.Polygon(t):t instanceof L.Polyline?t.pm=new L.PM.Edit.Line(t):t instanceof L.LayerGroup?t.pm=new L.PM.Edit.LayerGroup(t):t instanceof L.ImageOverlay&&(t.pm=new L.PM.Edit.ImageOverlay(t)))}},"1.7.1"===L.version&&L.Canvas.include({_onClick(t){let e=this._map.mouseEventToLayerPoint(t),i,r;for(let n=this._drawFirst;n;n=n.next)(i=n.layer).options.interactive&&i._containsPoint(e)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(i))&&(r=i);r&&(L.DomEvent.fakeStop(t),this._fireEvent([r],t))}}),L.PM.initialize()})()}}]);